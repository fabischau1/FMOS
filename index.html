<!DOCTYPE html>
<html lang="de">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>FM OS 13</title>
    <style>
        body, html {
            margin: 0;
            padding: 0;
            width: 100%;
            height: 100%;
            overflow: hidden;
            font-family: Arial, sans-serif;
        }
       .desktop {
            background: url('back.jpg') no-repeat;
            background-size: cover;
            position: relative;
            width: 100%;
            height: 100%;
			cursor: default;
        }
/* -------taskbar-------------------------------------------------------------------------------------------------------- */
.taskbar {
    background-color: #2e2e2e;
    color: #d1d1d1;
    height: 40px;
    position: fixed;
    bottom: 0;
    width: 100%;
    display: flex;
    align-items: center;
    padding: 0 15px;
    box-shadow: 0 -1px 4px rgba(0, 0, 0, 0.2);
    z-index: 1000;
    border-top: 1px solid #444;
}

.taskbar-button {
    background: transparent;
    color: #d1d1d1;
    height: 100%;
    padding: 0 10px;
    border: none;
    border-radius: 6px;  /* Runde Ecken */
    font-size: 14px;
    cursor: pointer;
    display: flex;
    align-items: center;
    gap: 8px;
    transition: color 0.3s, background-color 0.3s, transform 0.2s;
    position: relative;
    overflow: hidden;  /* Verhindert, dass Elemente außerhalb des Buttons sichtbar sind */
}

.taskbar-button::after {
    content: '';
    position: absolute;
    bottom: 0;
    left: 50%;
    width: 0;
    height: 2px;
    background: #d1d1d1;
    transition: width 0.3s, left 0.3s;
}

.taskbar-button:hover {
    color: #ff4d4d;
    background-color: rgba(255, 77, 77, 0.1);
    transform: scale(1.05); /* Leichte Vergrößerung des gesamten Buttons */
}

.taskbar-button:hover::after {
    width: 100%;
    left: 0;
}

.taskbar-button:active {
    transform: scale(0.95);
    color: #ff00ff;
}

.taskbar-button img.taskbar-icon {
    width: 24px;
    height: 24px;
    border-radius: 6px;
    display: inline-block;
    transition: transform 0.3s;
}

.taskbar-button:hover img.taskbar-icon {
    transform: scale(1.1);
}

/* -------context-menu------------------------------------------------------------------------------------------------------- */
.context-menu {
    position: absolute;
    background: rgba(30, 30, 30, 0.8); /* Highly transparent dark background */
    border: none; /* No border for a sleek look */
    border-radius: 10px; /* Rounded corners for a modern feel */
    box-shadow: 0 8px 16px rgba(0, 0, 0, 0.4); /* Softer shadow for subtle depth */
    display: none;
    z-index: 100;
    width: 100px; /* Narrow width */
    overflow: hidden; /* Hide overflow for a cleaner design */
    backdrop-filter: blur(10px); /* Blur effect for a glass-like appearance */
    animation: fadeIn 0.2s ease-out; /* Fade-in animation */
}

.context-menu ul {
    list-style: none;
    padding: 0;
    margin: 0;
}

.context-menu ul li {
    padding: 8px 12px; /* Adequate padding for a sleek look */
    cursor: pointer;
    color: #d0d0d0; /* Light gray text color */
    background: rgba(30, 30, 30, 0.6); /* Matching semi-transparent background */
    border-radius: 6px; /* Rounded corners for menu items */
    transition: background 0.3s ease, color 0.3s ease, text-shadow 0.3s ease; /* Smooth transitions */
}

.context-menu ul li:hover {
    background: rgba(30, 30, 30, 0.7); /* Slightly darker transparent background on hover */
    color: #fff; /* White text color on hover */
    text-shadow: 0 0 8px #00ff99, 0 0 16px #00ff99; /* Neon green glow effect */
}

.context-menu ul li:active {
    background: rgba(30, 30, 30, 0.8); /* Darker transparent background when clicked */
    color: #fff; /* White text color when active */
    text-shadow: 0 0 4px #00ff99, 0 0 8px #00ff99; /* Slightly dimmer glow effect on active */
}
/* -------neon-text-colors------------------------------------------------------------------------------------------------------- */
.redlightcolor {
    color: #ff0000;
	text-shadow: 0 0 5px #ff0000, 0 0 10px #ff0000, 0 0 15px #ff0000,
				0 0 20px #ff0000, 0 0 25px #ff0000, 0 0 30px #ff0000;
}

.greenlightcolor {
    color: #00ff00;
	text-shadow: 0 0 5px #00ff00, 0 0 10px #00ff00, 0 0 15px #00ff00,
				0 0 20px #00ff00, 0 0 25px #00ff00, 0 0 30px #00ff00;
}

.textcoloreditor {
    color: #ffffff;
	text-shadow: 0 0 1px #0000ff, 0 0 2.5px #0000ff, 0 0 5px #0000ff,
				0 0 5px #0000ff, 0 0 8px #0000ff, 0 0 10px #0000ff;
	background-color: rgba(20, 20, 20, 0.7);
}
/* -------animation-------------------------------------------------------------------------------------------------------- */
/* Animation for fading in */
@keyframes fadeIn {
    from {
        opacity: 0;
        transform: translateY(-10px);
    }
    to {
        opacity: 1;
        transform: translateY(0);
    }
}
/* -------file-labels------------------------------------------------------------------------------------------------------- */
.file-label {
    margin-top: 120px;
    font-size: 12px;
    color: #ff0000;
    text-align: center;
    font-weight: bold;
    text-shadow: 0 0 5px #ff0000, 0 0 10px #ff0000, 0 0 15px #ff0000,
                 0 0 20px #ff0000, 0 0 25px #ff0000, 0 0 30px #ff0000;
}
/* -------selection-with-mouse------------------------------------------------------------------------------------------------------ */
.selected {
    border: 2px solid #cc0000; /* Dunkleres Rot für die Auswahl */
    background-color: rgba(204, 0, 0, 0.2); /* Dunkleres Rot für den Hintergrund */
    border-radius: 3px; /* Etwas kleinere abgerundete Ecken */
}
/* -------iframe-config------------------------------------------------------------------------------------------------------- */
       .window {
            background-color: rgba(30, 30, 30, 0.7);
            border: 1px solid #000;
            position: absolute;
            top: 50px;
            left: 50px;
            width: 300px;
            height: 200px;
            display: none;
            flex-direction: column;
            z-index: 10;
        }
		.windowi {
            background-color: rgba(30, 30, 30, 0.7);
            border: 1px solid #000;
            position: absolute;
            top: 50px;
            left: 50px;
            width: 1200px;
            height: 600px;
            display: none;
            flex-direction: column;
            z-index: 10;
        }
		.windowstore {
            background-color: rgba(30, 30, 30, 0.7);
            border: 1px solid #000;
            position: absolute;
            top: 50px;
            left: 50px;
            width: 1200px;
			transform: scale(0.5);
			opacity: 0;
            height: 600px;
            display: none;
            flex-direction: column;
            z-index: 10;
        }
		.windowifram {
            background-color: rgba(30, 30, 30, 0.7);
            border: 1px solid #000;
            position: absolute;
            top: 50px;
            left: 50px;
            width: 1200px;
            height: 600px;
            display: none;
			transform: scale(0.5);
			opacity: 0;
            flex-direction: column;
            z-index: 10;
        }.windowifra {
            background-color: rgba(30, 30, 30, 0.7);
            border: 1px solid #000;
            position: absolute;
            top: 50px;
            left: 50px;
            width: 1200px;
            height: 600px;
            display: none;
			transform: scale(0.5);
			opacity: 0;
            flex-direction: column;
            z-index: 10;
        }.windowifr {
            background-color: rgba(30, 30, 30, 0.7);
            border: 1px solid #000;
            position: absolute;
            top: 50px;
            left: 50px;
            width: 1200px;
            height: 600px;
            display: none;
			transform: scale(0.5);
			opacity: 0;
            flex-direction: column;
            z-index: 10;
        }.windowif {
            background-color: rgba(30, 30, 30, 0.7);
            border: 1px solid #000;
            position: absolute;
            top: 50px;
            left: 50px;
            width: 1200px;
            height: 600px;
            display: none;
            flex-direction: column;
            z-index: 10;
			transform: scale(0.5);
			opacity: 0;
		}.windowifc {
            background-color: rgba(30, 30, 30, 0.7);
            border: 1px solid #000;
            position: absolute;
            top: 50px;
            left: 50px;
            width: 1200px;
            height: 600px;
			transform: scale(0.5);
			opacity: 0;
            display: none;
            flex-direction: column;
            z-index: 10;
		}.windowiframefiles {
            background-color: rgba(30, 30, 30, 0.7);
            border: 1px solid #000;
            position: absolute;
            top: 50px;
            left: 50px;
            width: 1200px;
			transform: scale(0.5);
			opacity: 0;
            height: 600px;
            display: none;
            flex-direction: column;
            z-index: 10;
        }
		.windowofchatbox {
            background-color: rgba(30, 30, 30, 0.7);
            border: 1px solid #000;
            position: absolute;
            top: 50px;
            left: 50px;
            width: 1200px;
			transform: scale(0.5);
			opacity: 0;
            height: 600px;
            display: none;
            flex-direction: column;
            z-index: 10;
        }
		.windowfoldermgr {
            background-color: rgba(30, 30, 30, 0.7);
            border: 1px solid #000;
            position: absolute;
            top: 50px;
            left: 50px;
            width: 1200px;
			transform: scale(0.5);
			opacity: 0;
            height: 600px;
            display: none;
            flex-direction: column;
            z-index: 10;
        }
.windowiframefiles.animate-in {
  animation: animate-in 0.5s forwards;
}

.windowfoldermgr.animate-in {
  animation: animate-in 0.5s forwards;
}

.windowifc.animate-in {
  animation: animate-in 0.5s forwards;
}

.windowstore.animate-in {
  animation: animate-in 0.5s forwards;
}

.windowifr.animate-in {
  animation: animate-in 0.5s forwards;
}

.windowifram.animate-in {
  animation: animate-in 0.5s forwards;
}

.windowifra.animate-in {
  animation: animate-in 0.5s forwards;
}

.windowofchatbox.animate-in {
  animation: animate-in 0.5s forwards;
}

@keyframes animate-in {
  0% {
    transform: scale(0.5);
    opacity: 0;
  }
  100% {
    transform: scale(1);
    opacity: 1;
  }
}

@keyframes animate-out {
  0% {
    transform: scale(1);
    opacity: 1;
  }
  100% {
    transform: scale(0.5);
    opacity: 0;
  }
}

/* -------terminal-one------------------------------------------------------------------------------------------------------- */
.terminal-window {
  background-color: #333;
  padding: 10px;
  border: 1px solid #444;
  border-radius: 10px;
  width: 800px;
  height: 600px;
  overflow: auto;
  display: none;
  position: absolute;
  top: 50%;
  left: 50%;
  transform: translate(-50%, -50%);
  transition: opacity 0.5s, transform 0.5s; /* add transition effect */
  z-index: 11;
}
.terminal-header {
  background-color: #444;
  padding: 10px;
  border-bottom: 1px solid #555;
  display: flex;
  justify-content: space-between;
  align-items: center;
}
.terminal-title {
  color: #fff;
  font-weight: bold;
}
.terminal-buttons {
  display: flex;
  align-items: center;
}
.terminal-button {
  background-color: #555;
  color: #fff;
  border: none;
  padding: 10px 20px;
  font-size: 16px;
  cursor: pointer;
}

.terminal-button:hover {
  background-color: #666;
}

.terminal-body {
  padding: 20px;
}

.terminal-output {
  padding: 10px;
  font-family: monospace;
  color: #fff;
}

.terminal-prompt {
  color: #6c5ce7; /* purple color */
}

.terminal-result {
  color: #0f0; /* green color */
}

.terminal-error {
  color: #f00; /* red color */
}

#terminal-input {
  background-color: #333;
  color: #fff;
  padding: 10px;
  font-family: monospace;
  border: none;
  resize: none;
  width: 100%;
}
/* -------rezise-handle------------------------------------------------------------------------------------------------------- */
.resize-handle {
  position: absolute;
  bottom: 0;
  right: 0;
  width: 20px;
  height: 20px;
  background-color: #333;
  border-radius: 5px;
  cursor: se-resize;
  transition: transform 0.2s ease, background-color 0.2s ease;
}

.resize-handle:hover {
  background-color: #555;
  transform: rotate(45deg);
}

.resize-handle::before {
  content: '';
  position: absolute;
  top: 4px;
  left: 4px;
  width: 12px;
  height: 12px;
  border: 2px solid #aaa;
  border-radius: 4px;
  box-sizing: border-box;
  transition: border-color 0.2s ease;
}

.resize-handle:hover::before {
  border-color: #888;
}

.resize-handle:active {
  background-color: #777;
  transform: scale(1.1);
}
/* -------setting-windows-and-app-choosing-windows--------------------------------------------------------------------------------------------------- */
#selection-window {
  position: absolute;
  bottom: 20px;
  left: 50%;
  background: rgba(30, 30, 30, 0.8);
  border: 1px solid rgba(255, 255, 255, 0.2);
  border-radius: 12px;
  box-shadow: 0 6px 12px rgba(0, 0, 0, 0.4), 0 0 16px rgba(0, 0, 0, 0.2);
  display: none;
  padding: 15px;
  box-sizing: border-box;
  width: 220px;
  backdrop-filter: blur(8px);
  transition: opacity 0.3s ease, transform 0.3s ease;
}

#selection-window.active {
  display: block;
  opacity: 1;
}

#selection-window button {
  background: linear-gradient(145deg, #333, #444); /* Verlaufseffekt für Knöpfe */
  border: none;
  color: #f0f0f0;
  padding: 8px 14px;
  margin-bottom: 8px;
  border-radius: 8px;
  cursor: pointer;
  font-size: 14px;
  transition: background 0.3s, transform 0.2s, box-shadow 0.2s;
  width: 100%;
}

#selection-window button:hover {
  background: linear-gradient(145deg, #444, #555); /* Verlauf für Hover-Effekt */
  transform: scale(1.05);
  box-shadow: 0 4px 10px rgba(0, 0, 0, 0.2); /* Sanfter Schatten beim Hover */
}

#selection-window button:focus {
  outline: none;
  box-shadow: 0 0 0 2px rgba(0, 170, 255, 0.6);
  background: linear-gradient(145deg, #333, #444);
}

@media (prefers-reduced-motion: no-preference) {
  #selection-window {
    animation: fadeInUp 0.5s ease-out;
  }
}

#selection-window button:hover {
  background-color: #eee;
}

#folsel-window {
  position: absolute;
  bottom: 20px;
  left: 60%;
  background: rgba(30, 30, 30, 0.8);
  border: 1px solid rgba(255, 255, 255, 0.2);
  border-radius: 12px;
  box-shadow: 0 6px 12px rgba(0, 0, 0, 0.4), 0 0 16px rgba(0, 0, 0, 0.2);
  display: none;
  padding: 15px;
  box-sizing: border-box;
  width: 220px;
  backdrop-filter: blur(8px);
  transition: opacity 0.3s ease, transform 0.3s ease;
}

#folsel-window.active {
  display: block;
  opacity: 1;
}

#folsel-window button {
  background: linear-gradient(145deg, #333, #444); /* Verlaufseffekt für Knöpfe */
  border: none;
  color: #f0f0f0;
  padding: 8px 14px;
  margin-bottom: 8px;
  border-radius: 8px;
  cursor: pointer;
  font-size: 14px;
  transition: background 0.3s, transform 0.2s, box-shadow 0.2s;
  width: 100%;
}

#folsel-window button:hover {
  background: linear-gradient(145deg, #444, #555); /* Verlauf für Hover-Effekt */
  transform: scale(1.05);
  box-shadow: 0 4px 10px rgba(0, 0, 0, 0.2); /* Sanfter Schatten beim Hover */
}

#folsel-window button:focus {
  outline: none;
  box-shadow: 0 0 0 2px rgba(0, 170, 255, 0.6);
  background: linear-gradient(145deg, #333, #444);
}

@media (prefers-reduced-motion: no-preference) {
  #folsel-window {
    animation: fadeInUp 0.5s ease-out;
  }
}

#folsel-window button:hover {
  background-color: #eee;
}

@keyframes fadeInUp {
  from {
    opacity: 0;
    transform: translateY(10px);
  }
  to {
    opacity: 1;
    transform: translateY(0);
  }
}
#sysset-window {
  position: absolute;
  bottom: 20px;
  left: 70%;
  background: rgba(30, 30, 30, 0.8);
  border: 1px solid rgba(255, 255, 255, 0.2);
  border-radius: 12px;
  box-shadow: 0 6px 12px rgba(0, 0, 0, 0.4), 0 0 16px rgba(0, 0, 0, 0.2);
  display: none;
  padding: 15px;
  box-sizing: border-box;
  width: 220px;
  backdrop-filter: blur(8px);
  transition: opacity 0.3s ease, transform 0.3s ease;
}

#sysset-window.active {
  display: block;
  opacity: 1;
}

#sysset-window button {
  background: linear-gradient(145deg, #333, #444); /* Verlaufseffekt für Knöpfe */
  border: none;
  color: #f0f0f0;
  padding: 8px 14px;
  margin-bottom: 8px;
  border-radius: 8px;
  cursor: pointer;
  font-size: 14px;
  transition: background 0.3s, transform 0.2s, box-shadow 0.2s;
  width: 100%;
}

#sysset-window button:hover {
  background: linear-gradient(145deg, #444, #555); /* Verlauf für Hover-Effekt */
  transform: scale(1.05);
  box-shadow: 0 4px 10px rgba(0, 0, 0, 0.2); /* Sanfter Schatten beim Hover */
}

#sysset-window button:focus {
  outline: none;
  box-shadow: 0 0 0 2px rgba(0, 170, 255, 0.6);
  background: linear-gradient(145deg, #333, #444);
}

@media (prefers-reduced-motion: no-preference) {
  #sysset-window {
    animation: fadeInUp 0.5s ease-out;
  }
}

#sysset-window button:hover {
  background-color: #eee;
}
#appsfinder-window {
  position: absolute;
  bottom: 70px;
  left: 7%;
  transform: translateX(-50%);
  background: rgba(30, 30, 30, 0.8);
  border: 1px solid rgba(255, 255, 255, 0.2);
  border-radius: 12px;
  box-shadow: 0 6px 12px rgba(0, 0, 0, 0.4), 0 0 16px rgba(0, 0, 0, 0.2);
  display: none;
  padding: 15px;
  box-sizing: border-box;
  width: 220px;
  backdrop-filter: blur(8px);
  transition: opacity 0.3s ease, transform 0.3s ease;
}

#appsfinder-window.active {
  display: block;
  opacity: 1;
}

#appsfinder-window button {
  display: flex;
  align-items: center;
  background: linear-gradient(145deg, #333, #444); /* Gradient for buttons */
  border: none;
  color: #f0f0f0;
  padding: 8px 14px;
  margin-bottom: 8px;
  border-radius: 8px;
  cursor: pointer;
  font-size: 14px;
  transition: background 0.3s, transform 0.2s, box-shadow 0.2s;
  width: 100%;
}

.button-icon {
  width: 20px;
  height: 20px;
  margin-right: 8px;
  border-radius: 4px;
  transition: transform 0.3s ease, box-shadow 0.3s ease;
}

#appsfinder-window button:hover .button-icon {
  transform: translateY(-2px);
  transform: scale(1.05);
  box-shadow: 0 4px 10px rgba(0, 0, 0, 0.2);
}

#appsfinder-window button:hover {
  background: linear-gradient(145deg, #444, #555); /* Gradient for hover effect */
  transform: scale(1.05);
  box-shadow: 0 4px 10px rgba(0, 0, 0, 0.2);
}

#appsfinder-window button:focus {
  outline: none;
  box-shadow: 0 0 0 2px rgba(0, 170, 255, 0.6);
  background: linear-gradient(145deg, #333, #444);
}

@media (prefers-reduced-motion: no-preference) {
  #appsfinder-window {
    animation: fadeInUp 0.5s ease-out;
  }
}

#appsfinder-window button:hover {
  background-color: #eee;
}
/* -------custom-error------------------------------------------------------------------------------------------------------- */
.error-message {
    position: fixed;
    top: 50%;
    left: 50%;
    transform: translate(-50%, -50%);
    background: #2c2c2c; /* Dunkleres, mattes Grau für modernen Look */
    color: #ff0000;
	text-shadow: 0 0 5px #ff0000, 0 0 10px #ff0000, 0 0 15px #ff0000,
				0 0 20px #ff0000, 0 0 25px #ff0000, 0 0 30px #ff0000;
    padding: 30px 50px;
    border-radius: 12px; /* Leicht abgerundete Ecken */
    box-shadow: 0 8px 20px rgba(0, 0, 0, 0.4); /* Weicher Schatten für Tiefe */
    text-align: center;
    z-index: 1000;
    animation: fadeIn 0.4s ease-in-out;
    max-width: 90%;
    width: 360px;
}

/* Styling für den Text innerhalb der Fehlermeldung */
.error-message span {
    display: block;
    margin-bottom: 20px; /* Abstand zwischen Text und Button */
    font-size: 18px; /* Größerer, gut lesbarer Text */
}

.error-message .ok-button {
    padding: 12px 30px;
    background: rgba(20, 20, 20, 0.7);
    border: none;
    color: #fff;
    border-radius: 6px; /* Leicht abgerundet für einen modernen Button */
    font-size: 16px;
    cursor: pointer;
    transition: background 0.3s, transform 0.2s ease-in-out;
}

.error-message .ok-button:hover {
    background: rgba(10, 10, 10, 0.7);
    transform: translateY(-2px); /* Leichter Hover-Effekt */
}
/* Einfache Fade-In Animation */
@keyframes fadeIn {
    from {
        opacity: 0;
        transform: translate(-50%, -60%);
    }
    to {
        opacity: 1;
        transform: translate(-50%, -50%);
    }
}
/* -------icons-------------------------------------------------------------------------------------------------------- */
.icon {
    display: inline-flex;
    align-items: center;
    justify-content: center;
    width: 100px;
    height: 100px;
    background-color: white;
    margin: 10px;
    font-size: 20px;
    cursor: pointer;
    user-select: none;
    transition: transform 0.3s ease, box-shadow 0.3s ease;
    background-size: cover;
    background-position: center;
    border-radius: 12px;
}

.icon:hover {
    transform: scale(1.05);
    box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2);
}
       .icon[data-file$=".js"] {
            background-image: url('js.jpg');
        }
       .icon[data-file$=".fexe"] {
            background-image: url('fexe.jpg');
        }
       .icon[data-file$=".css"] {
            background-image: url('css.jpg');
        }
       .icon[data-file$=".style"] {
            background-image: url('css.jpg');
        }
       .icon[data-file$=".fsys"] {
            background-image: url('fsys.jpg');
		}
		.icon[data-file$=".py"] {
            background-image: url('py.jpg');
		}
       .icon[data-file$=".zfp"] {
            background-image: url('folder.jpg');
		}
       .icon[data-file$=".html"] {
            background-image: url('html.jpg');
        }
		.icon[data-file$=".url"] {
            background-image: url('url.jpg');
        }
		.icon[data-file$=".png"] {
            background-image: url('png.jpg');
		}
		.icon[data-file$=".folder"] {
            background-image: url('fol.png');
		}
		.icon[data-file$=".fak"] {
            background-image: url('fak.jpg');
        }
       .icon:not([data-file$=".js"]):not([data-file$=".fexe"]):not([data-file$=".css"]):not([data-file$=".style"]):not([data-file$=".folder"]):not([data-file$=".fsys"]):not([data-file$=".fak"]):not([data-file$=".png"]):not([data-file$=".url"]):not([data-file$=".zfp"]):not([data-file$=".html"]):not([data-file$=".py"]) {
            background-image: url('ico.jpg');
        }
       .icon[data-folder] {
            background-image: url('folder.jpg');
        }
       .icon.dragging {
            position: absolute;
            z-index: 100;
        }
       .icon span {
            position: absolute;
            bottom: 0;
            left: 50%;
            transform: translateX(-50%);
            text-align: center;
            color: white; /* Weißer Text */
        }
/* -------text-editor-and-iframe-headers-and-footers-and-bodys----------------------------------------------------------------------------------------------- */
       .window-header {
            background-color: rgba(20, 20, 20, 0.7);
            color: #00ff00;
			text-shadow: 0 0 5px #00ff00, 0 0 10px #00ff00, 0 0 15px #00ff00,
						0 0 20px #00ff00, 0 0 25px #00ff00, 0 0 30px #00ff00;
            padding: 5px;
            cursor: move;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
       .window-body {
            flex: 1;
            padding: 10px;
        }
       .window-footer {
            padding: 5px;
            text-align: right;
        }
/* -------terminal-two------------------------------------------------------------------------------------------------------- */
.neon-terminal {
    background-color: rgba(30, 30, 30, 0.8);
    color: #0f0;
    border: 1px solid #0f0;
    position: absolute;
    top: 50px;
    left: 50px;
    width: 400px;
    height: 300px;
    display: none;
    flex-direction: column;
    z-index: 11;
    font-family: 'Courier New', Courier, monospace;
    box-shadow: 0 0 10px #0f0;
    border-radius: 10px;
    resize: both;
    overflow: hidden;
}

.neon-terminal-header {
    background-color: rgba(30, 30, 30, 0.8);
    color: #0f0;
    padding: 5px;
    cursor: move;
    display: flex;
    justify-content: space-between;
    align-items: center;
    border-bottom: 1px solid #0f0;
}

.neon-terminal-body {
    flex: 1;
    padding: 10px;
    overflow: auto;
    background-color: rgba(30, 30, 30, 0.8);
}

.neon-terminal-footer {
    padding: 5px;
    text-align: right;
    border-top: 1px solid #0f0;
    background-color: rgba(30, 30, 30, 0.8);
}

/* Button Styles */
.neon-terminal .btn {
    background: none;
    border: none;
    color: #0f0;
    cursor: pointer;
    margin-left: 5px;
    padding: 5px;
    font-size: 14px;
    border-radius: 5px;
    transition: background 0.3s, color 0.3s;
}

.neon-terminal .btn.fullscreen {
    background: #0f0;
    color: #000;
}

.neon-terminal .btn.close {
    background: red;
    color: #fff;
}

.neon-terminal .btn.run {
    background: #00f;
}

.neon-terminal .btn:hover {
    background: rgba(0, 255, 0, 0.5);
}

.neon-terminal .btn.fullscreen:hover {
    background: #0f0;
    color: #000;
}

.neon-terminal .btn.close:hover {
    background: darkred;
}

.neon-terminal .btn.run:hover {
    background: #00f;
}
/* -------login-------------------------------------------------------------------------------------------------------- */
.modal-overlay {
    position: fixed;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    background: rgba(0, 0, 0, 0.8);
    backdrop-filter: blur(10px);
    display: flex;
    align-items: center;
    justify-content: center;
    z-index: 9999;
}

.login-box {
    background: rgba(255, 255, 255, 0.1);
    border-radius: 12px;
    padding: 40px;
    box-shadow: 0 0 30px rgba(255, 255, 255, 0.3);
    text-align: center;
    width: 350px;
    backdrop-filter: blur(15px);
}

.title {
    color: #e0e0e0;
    margin-bottom: 20px;
    font-size: 24px;
}

.password-input {
    width: 100%;
    padding: 12px;
    margin: 10px 0;
    border: none;
    border-radius: 6px;
    background: rgba(255, 255, 255, 0.2);
    color: #fff;
    font-size: 16px;
    transition: background 0.3s, box-shadow 0.3s;
}

.password-input:focus {
    background: rgba(255, 255, 255, 0.3);
    box-shadow: 0 0 5px rgba(0, 123, 255, 0.5);
    outline: none;
}

.login-button {
    padding: 12px 20px;
    border: none;
    border-radius: 6px;
    background: linear-gradient(90deg, #007bff, #0056b3);
    color: #fff;
    cursor: pointer;
    font-size: 16px;
    transition: background 0.3s, transform 0.2s;
}

.login-button:hover {
    background: linear-gradient(90deg, #0056b3, #003d80);
    transform: translateY(-2px);
}
.login-error {
    color: #ff4d4d;
    margin-top: 10px;
}
/* -------settings-window------------------------------------------------------------------------------------------------------- */
.settingsmain-menu {
    position: absolute;
    top: 20%;
    left: 20%;
    width: 400px;
    height: auto;
	backdrop-filter: blur(8px);
    background: rgba(30, 30, 30, 0.8);
	border: 1px solid rgba(255, 255, 255, 0.2);
    box-shadow: 0 0 20px rgba(0, 0, 0, 0.5);
    padding: 20px;
    display: none;
    transition: all 0.3s ease;
}

.settingsmain-header {
    display: flex;
    justify-content: space-between;
    align-items: center;
    cursor: move; /* Erlaubt das Ziehen */
}

.settingsmain-controls button {
    background: transparent;
    border: none;
    color: #ffffff;
    font-size: 24px;
    cursor: pointer;
    transition: transform 0.2s;
}

.settingsmain-controls button:hover {
    transform: scale(1.2);
}

.settingsmain-content {
    margin-top: 20px;
}

.settingsmain-option {
    display: flex;
    justify-content: space-between;
    align-items: center;
    margin: 10px 0;
}

.settingsmain-option label {
    font-size: 18px;
}

.settingsmain-option input {
    transform: scale(1.5);
    cursor: pointer;
}

.settingsmain-resize {
    width: 15px;
    height: 15px;
    background: rgba(255, 255, 255, 0.5);
    border-radius: 50%;
    position: absolute;
    bottom: 10px;
    right: 10px;
    cursor: nwse-resize; /* Zeigt einen Resize-Cursor an */
}
.settingsmain-butten {
  background: linear-gradient(145deg, #333, #444); /* Verlaufseffekt für Knöpfe */
  border: none;
  color: #f0f0f0; /* Helles Grau für den Text */
  padding: 8px 14px; /* Leicht reduziertes Padding */
  margin-bottom: 8px; /* Etwas weniger Margin */
  border-radius: 8px;
  cursor: pointer;
  font-size: 14px; /* Etwas kleinere Schriftgröße */
  transition: background 0.3s, transform 0.2s, box-shadow 0.2s;
  width: 100%;
}
.settingsmain-butten:hover {
  background: linear-gradient(145deg, #444, #555); /* Verlauf für Hover-Effekt */
  transform: scale(1.05);
  box-shadow: 0 4px 10px rgba(0, 0, 0, 0.2); /* Sanfter Schatten beim Hover */
}
.settingsmain-butten:focus {
  outline: none;
  box-shadow: 0 0 0 2px rgba(0, 170, 255, 0.6); /* Blauer Schatten für den Fokus */
  background: linear-gradient(145deg, #333, #444);
}
/* -------Process-mgr-window------------------------------------------------------------------------------------------------------- */
#fmosProcessManager {
    position: absolute;
    top: 50px;
    left: 50px;
    width: 600px; /* Breite erhöhen für mehr Platz */
    height: 400px;
    border: 1px solid rgba(255, 255, 255, 0.2); /* Leicht transparenter Rahmen */
    background: linear-gradient(135deg, rgba(30, 30, 30, 0.8), rgba(50, 50, 50, 0.8)); /* Farbverlauf für Tiefe */
    box-shadow: 0px 0px 20px rgba(0, 0, 0, 0.5); /* Starker Schatten */
    display: flex;
    flex-direction: column;
    resize: both;
    overflow: hidden;
    border-radius: 10px; /* Abgerundete Ecken */
	z-index: 11;
}

#processManagerHeader {
    background-color: rgba(50, 50, 50, 0.8); /* Transparenter Header */
    color: #fff;
    padding: 10px;
    cursor: move;
    text-align: center;
    font-weight: bold;
    border-top-left-radius: 10px; /* Abrundung der oberen linken Ecke */
    border-top-right-radius: 10px; /* Abrundung der oberen rechten Ecke */
    position: relative; /* Für die Positionierung des Schließen-Buttons */
}

#processList {
    padding: 10px;
    overflow-y: auto;
    flex-grow: 1;
}

.process-row {
    display: flex;
    justify-content: space-between;
    padding: 10px;
    border-bottom: 1px solid rgba(255, 255, 255, 0.1); /* Hellerer Trennstrich */
}

.process-row.header {
    font-weight: bold;
    background-color: rgba(70, 70, 70, 0.5); /* Leicht transparenter Hintergrund */
}

.process-row div {
    flex: 1;
    text-align: center;
}

.process-mgr-close-button {
    background-color: #ff5c5c;
    color: #fff;
    border: none;
    padding: 5px 10px; /* Breiterer Button */
    cursor: pointer;
    transition: background-color 0.3s; /* Sanfter Übergang */
    border-radius: 5px; /* Abgerundete Ecken */
}

.process-mgr-close-button:hover {
    background-color: #ff7878; /* Heller bei Hover */
}

#pathInput {
    width: calc(100% - 20px);
    padding: 10px;
    margin-bottom: 20px;
    resize: none;
    background-color: rgba(50, 50, 50, 0.8);
    color: #ffffff;
    text-shadow: 0 0 1px #0000ff, 0 0 2.5px #0000ff, 0 0 5px #0000ff,
                0 0 5px #0000ff, 0 0 8px #0000ff, 0 0 10px #0000ff;
	border: none;
}

#iconsContainer {
    display: flex;
    flex-wrap: wrap;
    width: 100%;
    height: 100%;
    overflow-y: auto;
}

#folderMGR {
    position: absolute;
    top: 50px;
    left: 50px;
    width: 800px;
    height: 600px;
    background: linear-gradient(135deg, rgba(30, 30, 30, 0.8), rgba(50, 50, 50, 0.8));
    box-shadow: 0px 0px 20px rgba(0, 0, 0, 0.5);
    display: flex;
    flex-direction: column;
    resize: both;
    overflow: hidden;
    border-radius: 10px;
    display: none;
	z-index: 11;
}

.foldermgr-header {
    cursor: move;
    height: 50px;
    background-color: rgba(50, 50, 50, 0.8);
    padding: 10px;
    border-bottom: 1px solid #ccc;
    display: flex;
    justify-content: space-between;
    align-items: center;
	color: #ffffff;
}

.foldermgr-close-button {
    background-color: rgba(255, 0, 0, 0.8);
    color: white;
    border: none;
    padding: 5px 10px;
    border-radius: 5px;
    cursor: pointer;
    transition: background-color 0.3s ease, transform 0.3s ease;
}

.foldermgr-close-button:hover {
    background-color: rgba(255, 0, 0, 1);
    transform: scale(1.1);
}

.foldermgr-close-button:active {
    transform: scale(0.95);
}

.foldermgr-button {
	background: rgba(50, 50, 50, 0.8);
    color: #ff0000;
	text-shadow: 0 0 5px #ff0000, 0 0 10px #ff0000, 0 0 15px #ff0000,
				0 0 20px #ff0000, 0 0 25px #ff0000, 0 0 30px #ff0000;
	box-shadow: 0px 0px 20px rgba(0, 0, 0, 0.5);
    border: none;
    padding: 10px 10px;
    border-radius: 5px;
    cursor: pointer;
    transition: background-color 0.3s ease, transform 0.3s ease;
}
.foldermgr-button:hover {
	transform: scale(1.1);
}
.foldermgr-button:active {
	transform: scale(0.95);
}
    </style>
</head>
<body>
<!------desktop------------------------------------------------------------------------------------------------->
    <div class="desktop" id="desktop" oncontextmenu="showContextMenu(event); return false;">
    </div>
<!------login------------------------------------------------------------------------------------------------->
    <div class="modal-overlay" id="overlay" style="display: none;">
        <div class="login-box">
            <h1 class="title">Login!</h1>
            <input type="password" id="password" placeholder="Enter your password" required class="password-input">
            <button onclick="handleLogin()" class="login-button">Login</button>
            <p id="login-error" class="login-error"></p>
        </div>
    </div>
<!------taskbar------------------------------------------------------------------------------------------------->
    <div class="taskbar">
		<button class="taskbar-button" onclick="startmenu()">
			<img src="fsys.jpg" class="taskbar-icon">
			Start Menu
		</button>
		<button class="taskbar-button" onclick="showNeonTerminal()">
			<img src="termapp.png" class="taskbar-icon">
			Terminal
		</button>
		<button class="taskbar-button" onclick="secfil()">
			<img src="fol.png" class="taskbar-icon">
			Secure Folder
		</button>
		<button class="taskbar-button" onclick="showFolderMGR()">
			<img src="f.png" class="taskbar-icon">
			FolderMGR
		</button>
		<button class="taskbar-button" onclick="toggleProcessManager()">
			<img src="fexe.jpg" class="taskbar-icon">
			ProcesMGR
		</button>
		<button class="taskbar-button" onclick="openURLInIframe()">
			<img src="t.jpg" class="taskbar-icon">
			Browser
		</button>
		<button class="taskbar-button" onclick="vm()">
			<img src="vmapp.png" class="taskbar-icon">
			VM
		</button>
		<button class="taskbar-button" onclick="store()">
			<img src="storeapp.png" class="taskbar-icon">
			Store
		</button>
		<button class="taskbar-button" id="toggle-selection" onclick="appwindowfinder()">
			<img src="fsys.jpg" class="taskbar-icon">
			Apps
		</button>
		<button class="taskbar-button" id="toggle-selection" onclick="toggleSelectionWindow()">
			<img src="styleapp.png" class="taskbar-icon">
			Style
		</button>
		<button class="taskbar-button" id="toggle-selection" onclick="settingcheck()">
			<img src="settingsapp.png" class="taskbar-icon">
			Settings
		</button>
		<div id="selection-window" class="hidden" data-div-id="stlyes">
			<button id="option1" onclick="updateTextColorEditor()">Texteditor:White</button>
			<button id="option1" onclick="updateTextColorEditordef()">Texteditor:Default</button>
			<button id="option1" onclick="thememodern()">Theme:Modern</button>
			<button id="option1" onclick="theme_gaming()">Theme:Gaming</button>
			<button id="option1" onclick="theme_love()">Theme:Love</button>
			<button id="option1" onclick="theme_cyberpunk()">Theme:Cyberpunk</button>
			<button id="option1" onclick="theme_night()">Theme:Night</button>
			<button id="option6" onclick="changeTerminalBackground()">Terminal:Custom</button>
			<button id="option6" onclick="getAndSetTaskbarBackgroundColor()">Taskbar:Color</button>
			<button id="option1" onclick="theme_default()">Theme:Default</button>
			<button id="option1" onclick="animationsettings()">App Animation Settings</button>
			<button id="option1" onclick="wallpapersettings()">Wallpaper Settings</button>
			<button id="option7" onclick="toggleSelectionWindow()">Close</button>
		</div>
		<div id="selection-window" style="left: 40%;" class="hidden" data-div-id="animations">
			<button id="option1" onclick="set_animation_default()">default</button>
			<button id="option1" onclick="set_animation_Bounce_and_Rotate_Slide()">Bounce and Rotate Slide</button>
			<button id="option1" onclick="set_animation_Pop_and_Slide()">Pop and Slide</button>
			<button id="option1" onclick="set_animation_Smooth_Blur_Transition()">Smooth Blur Transition</button>
			<button id="option1" onclick="set_animation_Elegant_Fade_and_Slide_Animation()">Elegant Fade and Slide Animation</button>
			<button id="option1" onclick="set_animation_Dynamic_Bouncy_Entrance()">Dynamic Bouncy</button>
			<button id="option1" onclick="set_animation_Scale_and_Blur()">Scale and Blur</button>
			<button id="option1" onclick="set_animation_Elastic_Pop_Animation()">Elastic Pop Animation</button>
			<button id="option1" onclick="animationsettings()">Close</button>
		</div>
		<div id="selection-window" style="left: 30%;" class="hidden" data-div-id="wallpapers">
			<button id="option2" onclick="changeDesktopBackground2()">Wallpaper:Hacker</button>
			<button id="option2" onclick="changeDesktopBackgrounddarkfmos()">Wallpaper:FMOS</button>
			<button id="option1" onclick="changeDesktopBackground()">Wallpaper:Space</button>
			<button id="option2" onclick="wallpaper_Matrix()">Live Wallpaper:Matrix</button>
			<button id="option2" onclick="wallpaper_rain()">Live Wallpaper:Rain</button>
			<button id="option2" onclick="wallpaper_starryNight()">Live Wallpaper:Night</button>
			<button id="option3" onclick="changeDesktopBackground3()">Wallpaper:Flower</button>
			<button id="option3" onclick="changeDesktopBackground30()">Wallpaper:Color</button>
			<button id="option4" onclick="changeDesktopBackground6()">Wallpaper:Abstract</button>
			<button id="option4" onclick="changeDesktopBackgroundcu29294()">Wallpaper:Abstract 2.0</button>
			<button id="option5" onclick="changeDesktopBackground5()">Wallpaper:Custom</button>
			<button id="option2" onclick="wallpaper_off()">Live Wallpaper OFF</button>
			<button id="option2" onclick="wallpapersettings()">Close</button>
		</div>
		<div id="selection-window" style="bottom: 50px; left: 0%;" class="hidden" data-div-id="Startmenu">
			<button id="option2" onclick="settingcheck()">Settings</button>
			<button id="option2" onclick="toggleSelectionWindow()">Style</button>
			<button id="option2" onclick="appwindowfinder()">Apps</button>
			<button id="option2" onclick="askToRestartOS()">Restart</button>
			<button id="option2" onclick="startmenu()">Close</button>
		</div>
<!------folder-actions------------------------------------------------------------------------------------------------>
		<div id="folsel-window" class="hidden">
			<button id="option1" onclick="showFolderMGR()">Folder MGR</button>
			<br><br>
			<button id="option1" onclick="savedesktopWithCustomName()">Save Desktop</button>
			<button id="option1" onclick="loaddesktopContent()">Load Desktop</button>
			<button id="option1" onclick="showAllFMOSdesktopNames()">Show Desktops</button>
			<button id="option2" onclick="deleteSpecificdesktop()">Delete Desktop</button>
			<button id="option3" onclick="deleteAllFMOSdesktopItems()">Delete All Desktops</button>
			<br><br>
			<button id="option1" onclick="saveFolderWithNameOnly()">Save Folder</button>
			<button id="option1" onclick="saveFolderWithPath()">Save Folder as Path</button>
			<button id="option1" onclick="loadFolderWithNameOnly()">Load Folder</button>
			<button id="option1" onclick="loadFolderWithPath()">Load Folder as Path</button>
			<button id="option1" onclick="showAllFolders()">Show Folders</button>
			<button id="option1" onclick="showCurrentFolder()">Show Current Folder</button>
			<button id="option2" onclick="deleteFolderWithNameOnly()">Delete Folder</button>
			<button id="option2" onclick="deleteFolderWithPath()">Delete Folder as Path</button>
			<button id="option3" onclick="deleteAllFolders()">Delete All Folders</button>
			<button id="option1" onclick="migratefolderstodesktops()">Convert FMOS 11 Folders To Desktops</button>
			<button id="option4" onclick="folsell()">Close This Menu</button>
		</div>
<!------settings-selection-window----------------------------------------------------------------------------------------------->
		<div id="sysset-window" class="hidden">
			<button id="option7" onclick="setFullScreenIframeKeyTrue()">Enable Boot Terminal</button>
			<button id="option7" onclick="setFullScreenIframeKeyFalse()">Enable Boot Screen</button>
			<button id="option7" onclick="disablesettingwinold()">Disable Old Setting Menu</button>
			<button id="option7" onclick="enablelogin()">Enable Login Screen</button>
			<button id="option7" onclick="disablelogin()">Disable Login Screen</button>
			<button id="option7" onclick="enablebootsk()">Enable Auto Boot Skrips</button>
			<button id="option7" onclick="disablebootsk()">Disable Auto Boot Skrips</button>
			<button id="option7" onclick="passwordmgr()">Password</button>
			<button id="option7" onclick="sysfactoriereset()">Reset</button>
			<button id="option7" onclick="enableFileNames()">Enable File Names</button>
			<button id="option7" onclick="disableFileNames()">Disable File Names</button>
			<button id="option7" onclick="folsell()">Folder Options</button>
			<button id="option7" onclick="enableadminscripts()">Enable Admin Scripts</button>
			<button id="option7" onclick="disableadminscripts()">Disable Admin Scripts</button>
			<button class="option7" onclick="downloadAllFiles()">Download</button>
			<button id="option7" onclick="crdits()">Credits</button>
			<button id="option7" onclick="syssettings()">Close</button>
		</div>
<!------app-selection-window----------------------------------------------------------------------------------------------->
		<div id="appsfinder-window" class="hidden">
			<button id="option1" onclick="syssettings()">
			    <img onclick="syssettings()" src="settingsapp.png" alt="icon" class="button-icon"> Settings
			</button>
			<button id="option1" onclick="toggleSelectionWindow()">
			    <img onclick="toggleSelectionWindow()" src="styleapp.png" alt="icon" class="button-icon"> OS Style
			</button>
			<button id="option1" onclick="toggleProcessManager()">
			    <img onclick="toggleSelectionWindow()" src="f.png" alt="icon" class="button-icon"> Process MGR
			</button>
			<button id="option1" onclick="folsell()">
			    <img onclick="folsell()" src="f.png" alt="icon" class="button-icon"> Folder Options
			</button>
			<button id="option1" onclick="showFolderMGR()">
			    <img onclick="showFolderMGR()" src="f.png" alt="icon" class="button-icon"> Folder MGR
			</button>
			<button id="option1" onclick="executeJSInTerminal()">
			    <img onclick="executeJSInTerminal()" src="termapp.png" alt="icon" class="button-icon"> FM Shell
			</button>
			<button id="option1" onclick="showNeonTerminal()">
			    <img onclick="showNeonTerminal()" src="termapp.png" alt="icon" class="button-icon"> Pro Terminal
			</button>
			<button id="option1" onclick="musik()">
			    <img onclick="musik()" src="musikapp.png" alt="icon" class="button-icon"> Musik
			</button>
			<button id="option1" onclick="vm()">
			    <img onclick="vm()" src="vmapp.png" alt="icon" class="button-icon"> VM
			</button>
			<button id="option1" onclick="openURLInIframe()">
			    <img onclick="openURLInIframe()" src="t.jpg" alt="icon" class="button-icon"> Browser
			</button>
			<button id="option1" onclick="passwordmgr()">
			    <img onclick="passwordmgr()" src="passapp.png" alt="icon" class="button-icon"> Password MGR
			</button>
			<button id="option1" onclick="code()">
			    <img onclick="code()" src="py.jpg" alt="icon" class="button-icon"> CodeSpace
			</button>
			<button id="option1" onclick="store()">
			    <img onclick="store()" src="storeapp.png" alt="icon" class="button-icon"> Store
			</button>
			<button id="option4" onclick="appwindowfinder()" class="redlightcolor" >X</button>
		</div>
    </div>
<!------editor------------------------------------------------------------------------------------------------->
	<div class="window" id="editorWindow">
		<div class="window-header">
			<span id="editorTitle">Editor</span>
			<button onclick="closeWindow()" style="background:none; border:none;" class="redlightcolor">X</button>
		</div>
		<div class="window-body">
			<textarea id="fileContent" style="width: 100%; height: 100%; border: 1px solid rgba(255, 255, 255, 0.2); overflow: auto;" class="textcoloreditor" ></textarea>
		</div>
		<div class="window-footer">
			<button onclick="saveFile()" style="background:none; border:none; border: 1px solid rgba(255, 255, 255, 0.2); transition: transform 0.3s ease, box-shadow 0.3s ease; box-shadow: 0 0 10px rgba(0, 255, 0, 0.5); transform: perspective(1px) translateZ(0); outline:none;" class="greenlightcolor" onmouseover="this.style.transform='scale(1.1)'; this.style.boxShadow='0 0 20px rgba(0, 255, 0, 1)';" onmouseout="this.style.transform='scale(1)'; this.style.boxShadow='0 0 10px rgba(0, 255, 0, 0.5)';">Save</button>
			<button onclick="deleteFile()" style="background:none; border:none; border: 1px solid rgba(255, 255, 255, 0.2); transition: transform 0.3s ease, box-shadow 0.3s ease; box-shadow: 0 0 10px rgba(0, 255, 0, 0.5); transform: perspective(1px) translateZ(0); outline:none;" class="greenlightcolor" onmouseover="this.style.transform='scale(1.1)'; this.style.boxShadow='0 0 20px rgba(0, 255, 0, 1)';" onmouseout="this.style.transform='scale(1)'; this.style.boxShadow='0 0 10px rgba(0, 255, 0, 0.5)';">Delete</button>
			<button onclick="executeJS()" style="background:none; border:none; border: 1px solid rgba(255, 255, 255, 0.2); transition: transform 0.3s ease, box-shadow 0.3s ease; box-shadow: 0 0 10px rgba(0, 255, 0, 0.5); transform: perspective(1px) translateZ(0); outline:none;" class="greenlightcolor" onmouseover="this.style.transform='scale(1.1)'; this.style.boxShadow='0 0 20px rgba(0, 255, 0, 1)';" onmouseout="this.style.transform='scale(1)'; this.style.boxShadow='0 0 10px rgba(0, 255, 0, 0.5)';">Run</button>
			<button onclick="executeJSasadmin()" style="background:none; border:none; border: 1px solid rgba(255, 255, 255, 0.2); transition: transform 0.3s ease, box-shadow 0.3s ease; box-shadow: 0 0 10px rgba(0, 255, 0, 0.5); transform: perspective(1px) translateZ(0); outline:none;" class="greenlightcolor" onmouseover="this.style.transform='scale(1.1)'; this.style.boxShadow='0 0 20px rgba(0, 255, 0, 1)';" onmouseout="this.style.transform='scale(1)'; this.style.boxShadow='0 0 10px rgba(0, 255, 0, 0.5)';">Run As Admin</button>
			</div>
	</div>
<!------html-preview------------------------------------------------------------------------------------------------>
	<div class="windowi" id="htmlPreviewWindow" style="display: none;">
		<div class="window-header">
			<span id="htmlPreviewTitle">HTML Preview</span>
			<button onclick="closeHTMLPreviewWindow()" style="background:none; border:none; color: #ff5c5c; font-size: 16px;" class="redlightcolor">X</button>
		</div>
		<div class="window-body">
			<iframe id="htmlPreview" frameborder="0" width="100%" height="100%" sandbox="allow-top-navigation-by-user-activation allow-scripts allow-forms"></iframe>
		</div>
	</div>
<!------context-menu------------------------------------------------------------------------------------------------>
    <div class="context-menu" id="contextMenu">
        <ul>
			<li onclick="createFile()">New</li>
			<li onclick="folsell()">Folders</li>
			<li onclick="executeJS()">Run</li>
			<li onclick="executeJSasadmin()">Run As Admin</li>
            <li onclick="renameFile()">Rename</li>
            <li onclick="deleteFile()">Delete</li>
            <li onclick="toggleSelectionWindow()">Style Settings</li>
			<li onclick="hideContextMenu()">Close</li>
        </ul>
    </div>
<!------terminal-two------------------------------------------------------------------------------------------------>
    <div class="neon-terminal" id="neonTerminal">
        <div class="neon-terminal-header">
            <span>FMOS Pro Terminal</span>
            <div>
				<button onclick="runNeonTerminalJS()" style="background:none; border:none; color: #ff5c5c; font-size: 16px;" class="redlightcolor">Run</button>
                <button onclick="toggleTerminalFullscreen()" style="background:none; border:none; color: #ff5c5c; font-size: 16px;" class="redlightcolor">🗖</button>
                <button onclick="hideNeonTerminal()" style="background:none; border:none; color: #ff5c5c; font-size: 16px;" class="redlightcolor">X</button>
            </div>
        </div>
        <div class="neon-terminal-body">
            <textarea id="neonTerminalInput" style="width: 100%; height: 100%; background: transparent; border: none;" class="greenlightcolor" ></textarea>
        </div>
        <div class="neon-terminal-footer">
        </div>
    </div>
<!------settings------------------------------------------------------------------------------------------------->
    <div id="settingsMenu" class="settingsmain-menu">
        <div class="settingsmain-header" id="menuHeader">
            <h1>Settings</h1>
            <div class="settingsmain-controls">
                <button class="redlightcolor" id="closeBtn">X</button>
            </div>
        </div>
        <div class="settingsmain-content">
            <div class="settingsmain-option">
                <label class="greenlightcolor">BootScreen</label>
                <input type="checkbox" id="bootScreen" onclick="toggleBootScreen()">
            </div>
            <div class="settingsmain-option">
                <label class="greenlightcolor">Login Screen</label>
                <input type="checkbox" id="loginScreen" onclick="toggleLoginScreen()">
            </div>
            <div class="settingsmain-option">
                <label class="greenlightcolor">File Names</label>
                <input type="checkbox" id="fileNames" onclick="toggleFileNames()">
            </div>
            <div class="settingsmain-option">
                <label class="greenlightcolor">Admin Scripts</label>
                <input type="checkbox" id="adminScripts" onclick="toggleAdminScripts()">
            </div>
            <div class="settingsmain-option">
                <label class="greenlightcolor">Boot Scripts</label>
                <input type="checkbox" id="bootScripts" onclick="toggleBootScripts()">
            </div>
			<div class="settingsmain-option">
                <label class="greenlightcolor">Old Settings Menu</label>
                <input type="checkbox" id="oldsettings" onclick="togglesettingwinold()">
            </div>
            <button class="settingsmain-butten" onclick="sysfactoriereset()">Reset</button>
            <button class="settingsmain-butten" onclick="passwordmgr()">Password</button>
            <button class="settingsmain-butten" onclick="downloadAllFiles()">Download</button>
			<button class="settingsmain-butten" onclick="setFullScreenIframeKeyFalse()">Normal Boot Screen</button>
			<button class="settingsmain-butten" onclick="bootanimation2()">Special Boot Screen</button>
			<button class="settingsmain-butten" onclick="setFullScreenIframeKeyTrue()">Terminal Boot Screen</button>
			<button class="settingsmain-butten" onclick="syssettings()">Settings (Menu)</button>
			<button class="settingsmain-butten" onclick="crdits()">Credits</button>
        </div>
        <div class="settingsmain-resize" id="resizeHandle"></div>
    </div>
<!------ProcessMGR------------------------------------------------------------------------------------------------->
	<div id="fmosProcessManager" style="display: none;">
		<div id="processManagerHeader">FMOS Process Manager
			<button onclick="toggleProcessManager()" style="float: right; background-color: #ff5c5c; color: white; border: none; cursor: pointer;">X</button>
		</div>
		<div id="processList">
			<div class="process-row header">
				<div>ID</div>
				<div>Name</div>
				<div>URL</div>
				<div>Action</div>
			</div>
		</div>
	</div>

	<div id="folderMGR">
		<div class="foldermgr-header">
			<h2>Folder MGR</h2>
			<span class="foldermgr-button" onclick="folderMGRCreateFile()">New</span>
			<span class="foldermgr-button" onclick="folderMGRDeleteFile()">Delete</span>
			<span class="foldermgr-button" onclick="folderMGRRenameFile()">Rename</span>
			<span class="foldermgr-button" onclick="folderMGRCreateFolder()">New Folder</span>
			<span class="foldermgr-button" onclick="folderMGRDeleteFolder()">Delete Folder</span>
			<span class="foldermgr-button" onclick="folderMGRRenameFolder()">Rename Folder</span>
			<span class="foldermgr-close-button" onclick="closeFolderMGR()">X</span>
		</div>
		<input type="text" id="pathInput" placeholder="Type in path..." />
		<div id="iconsContainer"></div>
	</div>

    <script>
//------------------------------------------------------------------------------------------------------//
//------------------------------------------------------------------------------------------------------//
//                                     ---Varriables---                                                 //
//------------------------------------------------------------------------------------------------------//
//------------------------------------------------------------------------------------------------------//

//-------files---------------------------------------------------------------------------------------------

        let files = {
          "TOS.html": `<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Terms of Service</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            line-height: 1.6;
            margin: 20px;
            padding: 20px;
            background-color: #f4f4f4;
        }
        h1 {
            text-align: center;
        }
        h2 {
            color: #333;
        }
        p {
            margin: 10px 0;
        }
    </style>
</head>
<body>
    <h1>Terms of Service</h1>

    <h2>1. Storage of Files in LocalStorage</h2>
    <p>We reserve the right to store files and data in the LocalStorage of your browser. This may include, but is not limited to, configuration data, user preferences, and other related information.</p>

    <h2>2. Responsibility and Risk</h2>
    <p>You acknowledge and agree that all data and information processed, stored, or otherwise handled through this service may be lost, corrupted, or otherwise compromised. You are 100% responsible for any and all consequences, damages, or losses that may arise from using this service, including but not limited to data loss, hardware damage, or any other issues.</p>

    <h2>3. No Warranty</h2>
    <p>The service is provided "as-is" with no warranty, express or implied. We do not guarantee that the service will be error-free, secure, or uninterrupted. You use the service entirely at your own risk, and we are not liable for any damages, losses, or issues that may occur as a result of using the service.</p>

    <h2>4. Modification of Terms</h2>
    <p>We reserve the right to modify these Terms of Service at any time. Any changes will be effective immediately upon posting. It is your responsibility to review these terms periodically to stay informed of any updates.</p>

</body>
</html>

		  `,

          "Folder MGR.fsys": `foldermgr()`,
		
		  "Caculator.fsys": `caculator()`,
		
		  "Browser.fexe": `openURLInIframe()`,

          "game.js": `let minNumber = 1;
        let maxNumber = 100;
        let targetNumber = Math.floor(Math.random() * (maxNumber - minNumber + 1)) + minNumber;
        let userGuess;

        function playGame() {
          userGuess = prompt("Guess the number between " + minNumber + " and " + maxNumber);

          if (userGuess === null) {
            return;
          }

          userGuess = parseInt(userGuess);

          if (isNaN(userGuess)) {
            alert("This is not a number.");
            playGame();
          } else if (userGuess < minNumber || userGuess > maxNumber) {
            alert("This is not a number between " + minNumber + " and " + maxNumber + ".");
            playGame();
          } else if (userGuess < targetNumber) {
            alert("Too low!");
            playGame();
          } else if (userGuess > targetNumber) {
            alert("Too high!");
            playGame();
          } else {
            alert("Right! The number was " + targetNumber + ".");
          }
        }

        playGame();`,

          "FA_AntiVira.py": `let passwordGenerator = {
          generatePassword: function(length) {
            let password = "";
            for (let i = 0; i < length; i++) {
              password += Math.random().toString(36).substr(2, 1);
           }
            return password;
          }
        };

        alert(passwordGenerator.generatePassword(12));`,

          "terminal.fexe": `executeJSInTerminal()`
        };

        let folders = {};
		let foldermgrfiles = {};
        let selectedFile = null;
        let currentDraggedFile = null;
		let exedircontent = null;
		let content = null;
		let jsonFiles = null;
		let dircontent = null;
		let windowCount = 0;
		const openedWindows = [];
		let processManagerVisible = false;
		let desktoppathdirfull = 'FMOSfolder/desktop';
		let desktoppathdir = '/desktop';


//------------------------------------------------------------------------------------------------------//
//------------------------------------------------------------------------------------------------------//
//                                     ---Render---                                                     //
//------------------------------------------------------------------------------------------------------//
//------------------------------------------------------------------------------------------------------//

//------render-files---------------------------------------------------------------------------------------------

function renderFiles() {
  const desktop = document.getElementById('desktop');
  desktop.innerHTML = '';
	const showFileNames = localStorage.getItem('fmosfilenamessetting') === 'true';

	for (const fileName in files) {
		const fileIcon = document.createElement('div');
		fileIcon.className = 'icon';

		// Only create and append the file label if showFileNames is true
		if (showFileNames) {
			const fileLabel = document.createElement('div');
			fileLabel.className = 'file-label';
			fileLabel.innerText = fileName;
			fileIcon.appendChild(fileLabel);
		}

		fileIcon.dataset.file = fileName;
		fileIcon.onclick = () => openFile(fileName);
		fileIcon.oncontextmenu = (e) => {
			selectedFile = fileName;
			showContextMenu(e);
			return false;
		};

		desktop.appendChild(fileIcon);
	}
	positionIcons();
}

function connectdesktops(number) {
	if (number === '1') {
		files = JSON.parse(filesystem[desktoppathdirfull]);
		renderFiles();
	} else if (number === '2') {
		const FMfolderMGRvar = window.getComputedStyle(document.getElementById("folderMGR"));
		filesetData(desktoppathdirfull, JSON.stringify(files));
		if (FMfolderMGRvar.display !== "none" && FMfolderMGRvar.visibility !== "hidden") {
			loadFiles(PathToreloadFolderMGR)
		} else {
			// nothing
		}
	} else {
		console.error(number, 'is not an option')
	}
}

//------------------------------------------------------------------------------------------------------//
//------------------------------------------------------------------------------------------------------//
//                                     ---File Operations---                                            //
//------------------------------------------------------------------------------------------------------//
//------------------------------------------------------------------------------------------------------//

//-------create-files---------------------------------------------------------------------------------------------

        function createFile() {
            const fileName = prompt("Filename:");
            if (fileName && !fileName.endsWith('.folder')) {
                if (!files[fileName]) {
                    files[fileName] = "";
					connectdesktops('2');
                    renderFiles();
                } else {
                    showError("File alredy exsists.");
                }
            } else {
				showError('No Name Was Given Or You Tried to Create A Folder (please use the Folder MGR to create folders)')
			}
        }

//-------open-files-in-editor-------------------------------------------------------------------------------------------

        function openFile(fileName) {
		  new Audio('click.mp3').play();
          selectedFile = fileName;
          document.getElementById('editorTitle').innerText = `Editor - ${fileName}`;
          document.getElementById('fileContent').value = files[fileName];
          openWindow();
		  if (fileName.endsWith('.png') || fileName.endsWith('.jpg') || fileName.endsWith('.jpeg')) {
			openImageInIframe(fileName)
		  }
          if (fileName === "12345.js") {
            eval("alert(\"You found an easter egg! 🎉\");");
          }
		  if (selectedFile && selectedFile.endsWith('.folder')) {
		    openfmosfolderfile(selectedFile)
		  }
		  if (fileName === "BIOS") {
		    eval("alert(\"You found an easter egg! 🎉\");");
            window.location.href = "https://fabischau1.github.io/BIOS/";
          }
		  if (fileName === "old.fsys") {
		    eval("alert(\"You found an easter egg! 🎉\");");
            window.location.href = "https://fabischau1.github.io/FMOSold/";
          }
		  if (fileName === "oops") {
		    eval("alert(\"You found an easter egg! 🎉\");");
            window.location.href = "https://fabischau1.github.io/oops/";
          }
		  if (fileName === "BSOD") {
		    eval("alert(\"You found an easter egg! 🎉\");");
            window.location.href = "https://fabischau1.github.io/BSOD/";
          }
        }

//-------save-files---------------------------------------------------------------------------------------------

        function saveFile() {
			new Audio('click.mp3').play();
            if (selectedFile) {
                files[selectedFile] = document.getElementById('fileContent').value;
                alert('File saved.');
            }
			connectdesktops('2');
        }

//-------delete-files---------------------------------------------------------------------------------------------

function deleteFile() {
  new Audio('click.mp3').play();
  if (selectedFile) {
    if (selectedFile.endsWith('.fsys')) {
      if (confirm('Are you sure you want to delete this system file?')) {
        if (confirm('This will delete the entire file: ' + selectedFile)) {
          delete files[selectedFile];
          closeWindow();
		  connectdesktops('2');
          renderFiles();
          selectedFile = null;
        }
      }
    } else {
      if (confirm('Are you sure you want to delete this file?')) {
        if (confirm('This will delete the entire file: ' + selectedFile)) {
          delete files[selectedFile];
          closeWindow();
		  connectdesktops('2');
          renderFiles();
          selectedFile = null;
        }
      }
    }
  }
}

//-------rename-files---------------------------------------------------------------------------------------------

        function renameFile() {
            if (selectedFile&&!selectedFile.endsWith('.folder')) {
                const newFileName = prompt("New Filename:", selectedFile);
                if (newFileName &&!files[newFileName]&&!newFileName.endsWith('.folder')) {
                    files[newFileName] = files[selectedFile];
                    delete files[selectedFile];
                    selectedFile = newFileName;
					connectdesktops('2');
                    renderFiles();
                } else {
                    showError('An error has occurred. The file already exists or you tried to rename it into a folder');
                }
            } else {
				showError('No File Was Selected or you tryed to rename a folder')
			}
        }

//------------------------------------------------------------------------------------------------------//
//------------------------------------------------------------------------------------------------------//
//                                     ---File Editor---                                                //
//------------------------------------------------------------------------------------------------------//
//------------------------------------------------------------------------------------------------------//

        function openWindow() {
            document.getElementById('editorWindow').style.display = 'flex';
            document.getElementById('fileContent').focus();
            window.scrollTo(0, 0);
        }

        function closeWindow() {
            document.getElementById('editorWindow').style.display = 'none';
            document.getElementById('fileContent').blur();
        }

//------------------------------------------------------------------------------------------------------//
//------------------------------------------------------------------------------------------------------//
//                                     ---Contex Menu---                                                //
//------------------------------------------------------------------------------------------------------//
//------------------------------------------------------------------------------------------------------//

//-------Show-Contex-Menu---------------------------------------------------------------------------------------------

        function showContextMenu(event) {
            const contextMenu = document.getElementById('contextMenu');
            contextMenu.style.top = `${event.clientY}px`;
            contextMenu.style.left = `${event.clientX}px`;
            contextMenu.style.display = 'block';
            document.addEventListener('click', hideContextMenu);
        }

//-------Hide-Contex-Menu---------------------------------------------------------------------------------------------

        function hideContextMenu() {
            document.getElementById('contextMenu').style.display = 'none';
            document.removeEventListener('click', hideContextMenu);
        }

//------------------------------------------------------------------------------------------------------//
//------------------------------------------------------------------------------------------------------//
//                                     ---Execute Files---                                              //
//------------------------------------------------------------------------------------------------------//
//------------------------------------------------------------------------------------------------------//

//-------show-pictures--------------------------------------------------------------------------------------------

		
function openImageInIframe(fileName) {

    const imageWindow = document.createElement('div');
    imageWindow.className = 'windowifram'; 
    imageWindow.innerHTML = `
        <div class="window-header" style="display: flex; justify-content: space-between; align-items: center;">
            <span>${fileName}</span>
            <div style="display: flex; gap: 5px;">
                <button onclick="toggleFullscreenImage()" style="background:none; border:none; color: #ff5c5c; font-size: 16px;" class="redlightcolor">🗖</button>
                <button onclick="closeImageWindow()" style="background:none; border:none; color: #ff5c5c; font-size: 16px;" class="redlightcolor">X</button>
            </div>
        </div>
        <div class="window-body">
            <img id="image" src="${files[fileName]}" alt="${fileName}" style="width: 100%; height: auto;">
            <div class="resize-handle"></div>
        </div>
    `;
    document.body.appendChild(imageWindow);
    imageWindow.style.top = '50px';
    imageWindow.style.left = '50px';
    imageWindow.style.display = 'block'; // Fenster anzeigen

    // Animation beim Öffnen des Fensters
    imageWindow.classList.add('animate-in');

    // Drag-Funktionalität hinzufügen
    let isDragging = false;
    let offsetX, offsetY;

    imageWindow.querySelector('.window-header').addEventListener('mousedown', (e) => {
        isDragging = true;
        offsetX = e.clientX - imageWindow.offsetLeft;
        offsetY = e.clientY - imageWindow.offsetTop;

        document.addEventListener('mousemove', handleMouseMove);
        document.addEventListener('mouseup', handleMouseUp);
    });

    function handleMouseMove(e) {
        if (isDragging) {
            const newX = e.clientX - offsetX;
            const newY = e.clientY - offsetY;

            imageWindow.style.top = `${newY}px`;
            imageWindow.style.left = `${newX}px`;
        }
    }

    function handleMouseUp() {
        isDragging = false;
        document.removeEventListener('mousemove', handleMouseMove);
        document.removeEventListener('mouseup', handleMouseUp);
    }

    // Resize-Funktionalität hinzufügen
    let isResizing = false;
    let startX, startY, startWidth, startHeight;

    imageWindow.querySelector('.resize-handle').addEventListener('mousedown', (e) => {
        isResizing = true;
        startX = e.clientX;
        startY = e.clientY;
        startWidth = imageWindow.offsetWidth;
        startHeight = imageWindow.offsetHeight;

        document.addEventListener('mousemove', handleResizeMove);
        document.addEventListener('mouseup', handleResizeUp);
    });

    function handleResizeMove(e) {
        if (isResizing) {
            const newWidth = startWidth + (e.clientX - startX);
            const newHeight = startHeight + (e.clientY - startY);

            imageWindow.style.width = `${newWidth}px`;
            imageWindow.style.height = `${newHeight}px`;

            // Bildbreite und -höhe aktualisieren
            const img = imageWindow.querySelector('#image');
            img.style.width = `${newWidth}px`;
            img.style.height = 'auto'; // Höhe automatisch anpassen
        }
    }

    function handleResizeUp() {
        isResizing = false;
        document.removeEventListener('mousemove', handleResizeMove);
        document.removeEventListener('mouseup', handleResizeUp);
    }
}

function closeImageWindow() {
    document.querySelector('.windowifram').remove();
}

function toggleFullscreenImage() {
    const imageWindow = document.querySelector('.windowifram');
    const img = document.querySelector('#image');

    if (imageWindow.classList.contains('fullscreen')) {
        imageWindow.classList.remove('fullscreen');
        imageWindow.style.top = '50px';
        imageWindow.style.left = '50px';
        imageWindow.style.width = '600px';
        imageWindow.style.height = '600px';
        img.style.width = '100%';
    } else {
        imageWindow.classList.add('fullscreen');
        imageWindow.style.top = '0';
        imageWindow.style.left = '0';
        imageWindow.style.width = '100vw';
        imageWindow.style.height = '100vh';
        img.style.width = '100%';
        img.style.height = 'calc(100vh - 20px)'; // 20px ist die Höhe des Fenster-Headers
    }
}

//-------execute-html--------------------------------------------------------------------------------------------

function executeHTML() {
    alert("be Carefull while running html");
    if (selectedFile && (selectedFile.endsWith('.html') || selectedFile.endsWith('.fak') || selectedFile.endsWith('.url'))) {
        const htmlContent = files[selectedFile];
        const iframe = document.getElementById('htmlPreview');
        iframe.srcdoc = htmlContent;
        iframe.width = '100%';
        iframe.height = '550px'; // Set height to 550px
        document.getElementById('htmlPreviewWindow').style.display = 'block';
        
        makeDraggable(document.getElementById('htmlPreviewWindow'));
        makeResizable(document.getElementById('htmlPreviewWindow'));
    } else {
        alert('ERROR: This Filetype cannot run HTML.');
    }
}

//-------make-html-draggable-------------------------------------------------------------------------------------------

function makeDraggable(element) {
    let isDragging = false;
    let offsetX, offsetY;

    element.querySelector('.window-header').addEventListener('mousedown', (e) => {
        isDragging = true;
        offsetX = e.clientX - element.offsetLeft;
        offsetY = e.clientY - element.offsetTop;

        document.addEventListener('mousemove', handleMouseMove);
        document.addEventListener('mouseup', handleMouseUp);
    });

    function handleMouseMove(e) {
        if (isDragging) {
            const newX = e.clientX - offsetX;
            const newY = e.clientY - offsetY;

            element.style.top = `${newY}px`;
            element.style.left = `${newX}px`;
        }
    }

    function handleMouseUp() {
        isDragging = false;
        document.removeEventListener('mousemove', handleMouseMove);
        document.removeEventListener('mouseup', handleMouseUp);
    }
}

//-------make-html-Resizable-------------------------------------------------------------------------------------------

function makeResizable(element) {
    let isResizing = false;
    let startX, startY, startWidth, startHeight;

    const resizeHandle = document.createElement('div');
    resizeHandle.className = 'resize-handle';
    resizeHandle.style.width = '10px';
    resizeHandle.style.height = '10px';
    resizeHandle.style.cursor = 'se-resize';
    resizeHandle.style.position = 'absolute';
    resizeHandle.style.bottom = '0';
    resizeHandle.style.right = '0';
    element.appendChild(resizeHandle);

    resizeHandle.addEventListener('mousedown', (e) => {
        isResizing = true;
        startX = e.clientX;
        startY = e.clientY;
        startWidth = element.offsetWidth;
        startHeight = element.offsetHeight;

        document.addEventListener('mousemove', handleResizeMove);
        document.addEventListener('mouseup', handleResizeUp);
    });

    function handleResizeMove(e) {
        if (isResizing) {
            const newWidth = startWidth + (e.clientX - startX);
            const newHeight = startHeight + (e.clientY - startY);

            element.style.width = `${newWidth}px`;
            element.style.height = `${newHeight}px`;

            const iframe = element.querySelector('#htmlPreview');
            iframe.style.width = '100%';
            iframe.style.height = `${newHeight - 20}px`; // Adjust height based on header
        }
    }

    function handleResizeUp() {
        isResizing = false;
        document.removeEventListener('mousemove', handleResizeMove);
        document.removeEventListener('mouseup', handleResizeUp);
    }
}

//-------close-html-window-------------------------------------------------------------------------------------------


function closeHTMLPreviewWindow() {
    document.getElementById('htmlPreviewWindow').style.display = 'none';
}

//-------execute-js--------------------------------------------------------------------------------------------

function executeJS() {
	if (selectedFile && (selectedFile.endsWith('.fexe') || selectedFile.endsWith('.js') || selectedFile.endsWith('.py') || selectedFile.endsWith('.zfp') || selectedFile.endsWith('.fsys'))) {
		let userConfirmed = confirm("please only run js out of trusted sources it COULD POSSIBLY infect your actual pc with malware if u run it out of untrusted sources. YOU RUN THIS ON UR OWN RISK. Do you trust this program and its creator?");
		
		if (userConfirmed) {
		
			const code = files[selectedFile];
			const isAdmin = localStorage.getItem('settingadmin') === 'True';

			if (isAdmin) {
				const analyzeCode = (code) => {
					const localStoragePatterns = [
						/localStorage\.removeItem/i,
						/localStorage\.getItem/i,
						/localStorage\.clear/i,
						/localStorage\.setItem/i,
						/setboot/i,
						/filesetData/i,
						/folderdeleteData/i,
						/filedeleteData/i,
						/objectStore/i,
						/FMOSboot/i
					];

					// Check for key creation patterns starting with FMOSboot, settingadmin, files, or password
					const restrictedKeyPatterns = [
						/localStorage\.setItem\(\s*['"]FMOSboot\w*['"]/i,
						/localStorage\.setItem\(\s*['"]settingadmin\w*['"]/i,
						/localStorage\.setItem\(\s*['"]files\w*['"]/i,
						/localStorage\.setItem\(\s*['"]password\w*['"]/i,
						/localStorage\.setItem\(\s*['"]settingadmin['"]/i,
						/localStorage\.setItem\(\s*['"]files['"]/i,
						/localStorage\.setItem\(\s*['"]password['"]/i
					];

					for (const pattern of localStoragePatterns) {
						if (pattern.test(code)) {
							return { localStorageUsed: true };
						}
					}
					
					for (const pattern of restrictedKeyPatterns) {
						if (pattern.test(code)) {
							return { restrictedKeyUsed: true };
						}
					}
					
					return { localStorageUsed: false, restrictedKeyUsed: false };
				};

				const analysisResult = analyzeCode(code);
				
				if (analysisResult.localStorageUsed || analysisResult.restrictedKeyUsed) {
					showError("File Needs To Be Run As Administrator");
					return;
				}
			}
			try {
				eval(code);
			} catch (error) {
				alert(`ERROR: ${error.message}`);
			}
		} else {
			showError("Execution cancelled. You chose not to trust the program.");
		}
    } else if (selectedFile && (selectedFile.endsWith('.html') || selectedFile.endsWith('.fak') || selectedFile.endsWith('.url'))) {
        executeHTML();
    } else if (selectedFile && (selectedFile.endsWith('.css') || selectedFile.endsWith('.style'))) {
        executeCSS();
    } else {
        showError("ERROR: This file type cannot run JavaScript.");
    }
}

//-------execute-js-as-admin------------------------------------------------------------------------------------------

function executeJSasadmin() {
	const enteredPassword = prompt("Password:");

    const storedPassword = localStorage.getItem('password');

    if (enteredPassword === storedPassword) {
		alert('if u run a script as admin you give it the perms to make any changes to your FMOS system')
		alert('please only run js out of trusted sources it could infect your actual pc with malware if u run it out of untrusted sources')
		let userConfirmed = confirm("Do you trust this program and its creator?");
    
		if (userConfirmed) {
			alert("Be careful with running commands or code.");
        
			if (selectedFile && (selectedFile.endsWith('.fexe') || selectedFile.endsWith('.js') || selectedFile.endsWith('.py') || selectedFile.endsWith('.zfp') || selectedFile.endsWith('.fsys'))) {
				try {
					eval(files[selectedFile]);
				} catch (error) {
					alert(`ERROR: ${error.message}`);
				}
			} else if (selectedFile && (selectedFile.endsWith('.html') || selectedFile.endsWith('.png') || selectedFile.endsWith('.fak') || selectedFile.endsWith('.url'))) {
				executeHTML();
			} else if (selectedFile && (selectedFile.endsWith('.css') || selectedFile.endsWith('.style'))) {
				executeCSS();
			} else {
				showError("ERROR: This filetype cannot run JavaScript.");
			}
		} else {
			showError("Execution cancelled. You chose not to trust the program.");
		}
	} else {
		showError('Settings Have Not Changed. Password incorrect. Please Set A Password over Settings or Reset The System over Settings.');
	}
}

//-------execute-css--------------------------------------------------------------------------------------------

function executeCSS() {
    if (selectedFile && (selectedFile.endsWith('.css') || selectedFile.endsWith('.style'))) {
        try {
            const style = document.createElement('style');
            style.type = 'text/css';
            style.innerHTML = files[selectedFile];
            document.head.appendChild(style);
        } catch (error) {
            alert(`ERROR: ${error.message}`);
        }
    } else {
        showError("ERROR: This file type cannot run css.");
    }
}

//------------------------------------------------------------------------------------------------------//
//------------------------------------------------------------------------------------------------------//
//                                     ---Terminals---                                                  //
//------------------------------------------------------------------------------------------------------//
//------------------------------------------------------------------------------------------------------//

//-------terminal-one-------------------------------------------------------------------------------------------

let terminalWindows = [];

function executeJSInTerminal() {
  alert("Be Carefull with running commands or code")
  const terminalWindow = document.createElement('div');
  terminalWindow.className = 'terminal-window';
  terminalWindow.innerHTML = `
    <div class="terminal-header">
      <div class="terminal-title">FM Shell</div>
      <div class="terminal-buttons">
        <button class="terminal-button" id="close-button">×</button>
      </div>
    </div>
    <div class="terminal-body">
      <div class="terminal-output" id="terminal-output">
        <span class="terminal-prompt">~$</span>
        <textarea id="terminal-input" placeholder="Enter JavaScript code..." style="width: 100%; padding: 10px; font-family: monospace; border: none; resize: none;"></textarea>
      </div>
    </div>
  `;
  document.body.appendChild(terminalWindow);

  terminalWindow.style.display = 'block';
  terminalWindow.style.opacity = 0;
  terminalWindow.style.transform = 'cale(0.5)';

  setTimeout(() => {
    terminalWindow.style.transition = 'opacity 0.5s, transform 0.5s';
    terminalWindow.style.opacity = 1;
    terminalWindow.style.transform = 'cale(1)';
  }, 10);

  const closeButton = terminalWindow.querySelector('#close-button');
  const terminalInput = terminalWindow.querySelector('#terminal-input');
  const terminalOutput = terminalWindow.querySelector('#terminal-output');

  closeButton.addEventListener('click', () => {
    terminalWindow.style.transition = 'opacity 0.5s, transform 0.5s';
    terminalWindow.style.opacity = 0;
    terminalWindow.style.transform = 'cale(0.5)';
    setTimeout(() => {
      terminalWindow.style.display = 'none';
    }, 500);
  });

  terminalInput.addEventListener('keydown', (e) => {
    if (e.key === 'Enter') {
      const code = terminalInput.value;
      try {
        const result = eval(code);
        terminalOutput.innerHTML += `<span class="terminal-prompt">~$</span> ${code}<br>`;
        terminalOutput.innerHTML += `<span class="terminal-result">${result}</span><br>`;
      } catch (error) {
        terminalOutput.innerHTML += `<span class="terminal-prompt">~$</span> ${code}<br>`;
        terminalOutput.innerHTML += `<span class="terminal-error">${error.message}</span><br>`;
      }
      terminalInput.value = '';
    }
  });

  terminalWindows.push(terminalWindow);
}

//-------terminal-two-------------------------------------------------------------------------------------------

        function showNeonTerminal() {
			showError("WARNING DONT EXECUTE CODE FROM STRANGERS")
            document.getElementById('neonTerminal').style.display = 'flex';
            document.getElementById('neonTerminalInput').focus();
            window.scrollTo(0, 0);
        }

        function hideNeonTerminal() {
            document.getElementById('neonTerminal').style.display = 'none';
        }

        function toggleTerminalFullscreen() {
            const terminal = document.getElementById('neonTerminal');
            if (terminal.style.width === '100vw' && terminal.style.height === '100vh') {
                terminal.style.width = '400px';
                terminal.style.height = '300px';
                terminal.style.top = '50px';
                terminal.style.left = '50px';
            } else {
                terminal.style.width = '100vw';
                terminal.style.height = '100vh';
                terminal.style.top = '0';
                terminal.style.left = '0';
            }
        }

        function runNeonTerminalJS() {
            const code = document.getElementById('neonTerminalInput').value;
            try {
                eval(code);
            } catch (error) {
                alert(`ERROR: ${error.message}`);
            }
        }

        // Drag functionality for the terminal
        let isDraggingTerminal = false;
        let terminalOffsetX, terminalOffsetY;

        document.querySelector('.neon-terminal-header').addEventListener('mousedown', (e) => {
            isDraggingTerminal = true;
            terminalOffsetX = e.clientX - document.getElementById('neonTerminal').offsetLeft;
            terminalOffsetY = e.clientY - document.getElementById('neonTerminal').offsetTop;

            document.addEventListener('mousemove', handleTerminalMouseMove);
            document.addEventListener('mouseup', handleTerminalMouseUp);
        });

        function handleTerminalMouseMove(e) {
            if (isDraggingTerminal) {
                const newX = e.clientX - terminalOffsetX;
                const newY = e.clientY - terminalOffsetY;

                const maxX = window.innerWidth - document.getElementById('neonTerminal').offsetWidth;
                const maxY = window.innerHeight - document.getElementById('neonTerminal').offsetHeight;

                if (newX < 0) {
                    document.getElementById('neonTerminal').style.left = '0';
                } else if (newX > maxX) {
                    document.getElementById('neonTerminal').style.left = `${maxX}px`;
                } else {
                    document.getElementById('neonTerminal').style.left = `${newX}px`;
                }

                if (newY < 0) {
                    document.getElementById('neonTerminal').style.top = '0';
                } else if (newY > maxY) {
                    document.getElementById('neonTerminal').style.top = `${maxY}px`;
                } else {
                    document.getElementById('neonTerminal').style.top = `${newY}px`;
                }
            }
        }

        function handleTerminalMouseUp() {
            isDraggingTerminal = false;
            document.removeEventListener('mousemove', handleTerminalMouseMove);
            document.removeEventListener('mouseup', handleTerminalMouseUp);
        }

//------------------------------------------------------------------------------------------------------//
//------------------------------------------------------------------------------------------------------//
//                                     ---Apps---                                                       //
//------------------------------------------------------------------------------------------------------//
//------------------------------------------------------------------------------------------------------//

//-------ID-------------------------------------------------------------------------------------------

function generateUniqueId() {
  return `window-${++windowCount}`;
}

//-------musik-------------------------------------------------------------------------------------------

function musik() {
  const uniqueId = generateUniqueId();
  const iframeWindow = document.createElement('div');
  iframeWindow.id = uniqueId;
  iframeWindow.className = 'windowifra';
  
  iframeWindow.innerHTML = `
    <div class="window-header" style="display: flex; justify-content: space-between; align-items: center;">
      <span>Musik</span>
      <div style="display: flex; gap: 5px;">
        <button onclick="toggleFullscreenIframe('${uniqueId}')" style="background:none; border:none; color: #ff5c5c; font-size: 16px;" class="redlightcolor">🗖</button>
        <button onclick="closeiframe('${uniqueId}')" style="background:none; border:none; color: #ff5c5c; font-size: 16px;" class="redlightcolor">X</button>
      </div>
    </div>
    <div class="window-body">
      <iframe id="iframe" frameborder="0" width="100%" height="550px" src="https://fabischau1.github.io/Musik/"></iframe>
      <div class="resize-handle"></div>
    </div>
  `;
  
  document.body.appendChild(iframeWindow);
  iframeWindow.style.top = '50px';
  iframeWindow.style.left = '50px';
  iframeWindow.style.display = 'block';

  // Add animation when opening the window
  iframeWindow.classList.add('animate-in');

  // Add drag functionality
  let isDragging = false;
  let offsetX, offsetY;

  iframeWindow.querySelector('.window-header').addEventListener('mousedown', (e) => {
    isDragging = true;
    offsetX = e.clientX - iframeWindow.offsetLeft;
    offsetY = e.clientY - iframeWindow.offsetTop;

    document.addEventListener('mousemove', handleMouseMove);
    document.addEventListener('mouseup', handleMouseUp);
  });

  function handleMouseMove(e) {
    if (isDragging) {
      const newX = e.clientX - offsetX;
      const newY = e.clientY - offsetY;

      iframeWindow.style.top = `${newY}px`;
      iframeWindow.style.left = `${newX}px`;
    }
  }

  function handleMouseUp() {
    isDragging = false;
    document.removeEventListener('mousemove', handleMouseMove);
    document.removeEventListener('mouseup', handleMouseUp);
  }

  // Add resize functionality
  let isResizing = false;
  let startX, startY, startWidth, startHeight;

  iframeWindow.querySelector('.resize-handle').addEventListener('mousedown', (e) => {
    isResizing = true;
    startX = e.clientX;
    startY = e.clientY;
    startWidth = iframeWindow.offsetWidth;
    startHeight = iframeWindow.offsetHeight;

    document.addEventListener('mousemove', handleResizeMove);
    document.addEventListener('mouseup', handleResizeUp);
  });

  function handleResizeMove(e) {
    if (isResizing) {
      const newWidth = startWidth + (e.clientX - startX);
      const newHeight = startHeight + (e.clientY - startY);

      iframeWindow.style.width = `${newWidth}px`;
      iframeWindow.style.height = `${newHeight}px`;

      const iframe = iframeWindow.querySelector('#iframe');
      iframe.style.width = `${newWidth -20}px`;
      iframe.style.height = `${newHeight -50}px`;
    }
  }

  function handleResizeUp() {
    isResizing = false;
    document.removeEventListener('mousemove', handleResizeMove);
    document.removeEventListener('mouseup', handleResizeUp);
  }	

  openedWindows.push({
    type: 'musik',
    id: uniqueId
  });
}

//-------store-------------------------------------------------------------------------------------------

function store() {
  const uniqueId = generateUniqueId();
  const iframeWindow = document.createElement('div');
  iframeWindow.id = uniqueId;
  iframeWindow.className = 'windowifra';
  
  iframeWindow.innerHTML = `
    <div class="window-header" style="display: flex; justify-content: space-between; align-items: center;">
      <span>FMOS Store</span>
      <div style="display: flex; gap: 5px;">
        <button onclick="toggleFullscreenIframe('${uniqueId}')" style="background:none; border:none; color: #ff5c5c; font-size: 16px;" class="redlightcolor">🗖</button>
        <button onclick="closeiframe('${uniqueId}')" style="background:none; border:none; color: #ff5c5c; font-size: 16px;" class="redlightcolor">X</button>
      </div>
    </div>
    <div class="window-body">
      <iframe id="iframe" frameborder="0" width="100%" height="550px" src="https://fabischau1.github.io/FMOS/store.html" sandbox="allow-same-origin allow-scripts allow-forms"></iframe>
      <div class="resize-handle"></div>
    </div>
  `;
  
  document.body.appendChild(iframeWindow);
  iframeWindow.style.top = '50px';
  iframeWindow.style.left = '50px';
  iframeWindow.style.display = 'block';

  // Add animation when opening the window
  iframeWindow.classList.add('animate-in');

  // Add drag functionality
  let isDragging = false;
  let offsetX, offsetY;

  iframeWindow.querySelector('.window-header').addEventListener('mousedown', (e) => {
    isDragging = true;
    offsetX = e.clientX - iframeWindow.offsetLeft;
    offsetY = e.clientY - iframeWindow.offsetTop;

    document.addEventListener('mousemove', handleMouseMove);
    document.addEventListener('mouseup', handleMouseUp);
  });

  function handleMouseMove(e) {
    if (isDragging) {
      const newX = e.clientX - offsetX;
      const newY = e.clientY - offsetY;

      iframeWindow.style.top = `${newY}px`;
      iframeWindow.style.left = `${newX}px`;
    }
  }

  function handleMouseUp() {
    isDragging = false;
    document.removeEventListener('mousemove', handleMouseMove);
    document.removeEventListener('mouseup', handleMouseUp);
  }

  // Add resize functionality
  let isResizing = false;
  let startX, startY, startWidth, startHeight;

  iframeWindow.querySelector('.resize-handle').addEventListener('mousedown', (e) => {
    isResizing = true;
    startX = e.clientX;
    startY = e.clientY;
    startWidth = iframeWindow.offsetWidth;
    startHeight = iframeWindow.offsetHeight;

    document.addEventListener('mousemove', handleResizeMove);
    document.addEventListener('mouseup', handleResizeUp);
  });

  function handleResizeMove(e) {
    if (isResizing) {
      const newWidth = startWidth + (e.clientX - startX);
      const newHeight = startHeight + (e.clientY - startY);

      iframeWindow.style.width = `${newWidth}px`;
      iframeWindow.style.height = `${newHeight}px`;

      const iframe = iframeWindow.querySelector('#iframe');
      iframe.style.width = `${newWidth -20}px`;
      iframe.style.height = `${newHeight -50}px`;
    }
  }

  function handleResizeUp() {
    isResizing = false;
    document.removeEventListener('mousemove', handleResizeMove);
    document.removeEventListener('mouseup', handleResizeUp);
  }	

  openedWindows.push({
    type: 'store',
    id: uniqueId
  });
}

//-------caculator-------------------------------------------------------------------------------------------

function caculator() {
  const uniqueId = generateUniqueId();
  const iframeWindow = document.createElement('div');
  iframeWindow.id = uniqueId;
  iframeWindow.className = 'windowifra';
  
  iframeWindow.innerHTML = `
    <div class="window-header" style="display: flex; justify-content: space-between; align-items: center;">
      <span>Caculator</span>
      <div style="display: flex; gap: 5px;">
        <button onclick="toggleFullscreenIframe('${uniqueId}')" style="background:none; border:none; color: #ff5c5c; font-size: 16px;" class="redlightcolor">🗖</button>
        <button onclick="closeiframe('${uniqueId}')" style="background:none; border:none; color: #ff5c5c; font-size: 16px;" class="redlightcolor">X</button>
      </div>
    </div>
    <div class="window-body">
      <iframe id="iframe" frameborder="0" width="100%" height="550px" src="https://fabischau1.github.io/caculator/"></iframe>
      <div class="resize-handle"></div>
    </div>
  `;
  
  document.body.appendChild(iframeWindow);
  iframeWindow.style.top = '50px';
  iframeWindow.style.left = '50px';
  iframeWindow.style.display = 'block';

  // Add animation when opening the window
  iframeWindow.classList.add('animate-in');

  // Add drag functionality
  let isDragging = false;
  let offsetX, offsetY;

  iframeWindow.querySelector('.window-header').addEventListener('mousedown', (e) => {
    isDragging = true;
    offsetX = e.clientX - iframeWindow.offsetLeft;
    offsetY = e.clientY - iframeWindow.offsetTop;

    document.addEventListener('mousemove', handleMouseMove);
    document.addEventListener('mouseup', handleMouseUp);
  });

  function handleMouseMove(e) {
    if (isDragging) {
      const newX = e.clientX - offsetX;
      const newY = e.clientY - offsetY;

      iframeWindow.style.top = `${newY}px`;
      iframeWindow.style.left = `${newX}px`;
    }
  }

  function handleMouseUp() {
    isDragging = false;
    document.removeEventListener('mousemove', handleMouseMove);
    document.removeEventListener('mouseup', handleMouseUp);
  }

  // Add resize functionality
  let isResizing = false;
  let startX, startY, startWidth, startHeight;

  iframeWindow.querySelector('.resize-handle').addEventListener('mousedown', (e) => {
    isResizing = true;
    startX = e.clientX;
    startY = e.clientY;
    startWidth = iframeWindow.offsetWidth;
    startHeight = iframeWindow.offsetHeight;

    document.addEventListener('mousemove', handleResizeMove);
    document.addEventListener('mouseup', handleResizeUp);
  });

  function handleResizeMove(e) {
    if (isResizing) {
      const newWidth = startWidth + (e.clientX - startX);
      const newHeight = startHeight + (e.clientY - startY);

      iframeWindow.style.width = `${newWidth}px`;
      iframeWindow.style.height = `${newHeight}px`;

      const iframe = iframeWindow.querySelector('#iframe');
      iframe.style.width = `${newWidth -20}px`;
      iframe.style.height = `${newHeight -50}px`;
    }
  }

  function handleResizeUp() {
    isResizing = false;
    document.removeEventListener('mousemove', handleResizeMove);
    document.removeEventListener('mouseup', handleResizeUp);
  }	

  openedWindows.push({
    type: 'Caculator',
    id: uniqueId
  });
}

function closecaculator() {
  document.querySelector('.windowifc').remove();
}

function toggleFullscreencaculator() {
  const iframeWindow = document.querySelector('.windowifc');
  const iframe = document.querySelector('#iframe');
  
  // Toggle between fullscreen and normal mode
  if (iframeWindow.classList.contains('fullscreen')) {
    iframeWindow.classList.remove('fullscreen');
    iframeWindow.style.top = '50px';
    iframeWindow.style.left = '50px';
    iframeWindow.style.width = '600px'; // Default width
    iframeWindow.style.height = '600px'; // Default height
    iframe.style.width = '100%';
    iframe.style.height = '550px'; // Adjust height
  } else {
    iframeWindow.classList.add('fullscreen');
    iframeWindow.style.top = '0';
    iframeWindow.style.left = '0';
    iframeWindow.style.width = '100vw';
    iframeWindow.style.height = '100vh';
    iframe.style.width = '100%';
    iframe.style.height = 'calc(100vh - 20px)'; // 20px for the header
  }
}

//-------password-manager------------------------------------------------------------------------------------------

function passwordmgr() {
  const uniqueId = generateUniqueId();
  const iframeWindow = document.createElement('div');
  iframeWindow.id = uniqueId;
  iframeWindow.className = 'windowifra';
  
  iframeWindow.innerHTML = `
    <div class="window-header" style="display: flex; justify-content: space-between; align-items: center;">
      <span>Password MGR</span>
      <div style="display: flex; gap: 5px;">
        <button onclick="toggleFullscreenIframe('${uniqueId}')" style="background:none; border:none; color: #ff5c5c; font-size: 16px;" class="redlightcolor">🗖</button>
        <button onclick="closeiframe('${uniqueId}')" style="background:none; border:none; color: #ff5c5c; font-size: 16px;" class="redlightcolor">X</button>
      </div>
    </div>
    <div class="window-body">
      <iframe id="iframe" frameborder="0" width="100%" height="550px" src="https://fabischau1.github.io/FMOSfiles/pass"></iframe>
      <div class="resize-handle"></div>
    </div>
  `;
  
  document.body.appendChild(iframeWindow);
  iframeWindow.style.top = '50px';
  iframeWindow.style.left = '50px';
  iframeWindow.style.display = 'block';

  // Add animation when opening the window
  iframeWindow.classList.add('animate-in');

  // Add drag functionality
  let isDragging = false;
  let offsetX, offsetY;

  iframeWindow.querySelector('.window-header').addEventListener('mousedown', (e) => {
    isDragging = true;
    offsetX = e.clientX - iframeWindow.offsetLeft;
    offsetY = e.clientY - iframeWindow.offsetTop;

    document.addEventListener('mousemove', handleMouseMove);
    document.addEventListener('mouseup', handleMouseUp);
  });

  function handleMouseMove(e) {
    if (isDragging) {
      const newX = e.clientX - offsetX;
      const newY = e.clientY - offsetY;

      iframeWindow.style.top = `${newY}px`;
      iframeWindow.style.left = `${newX}px`;
    }
  }

  function handleMouseUp() {
    isDragging = false;
    document.removeEventListener('mousemove', handleMouseMove);
    document.removeEventListener('mouseup', handleMouseUp);
  }

  // Add resize functionality
  let isResizing = false;
  let startX, startY, startWidth, startHeight;

  iframeWindow.querySelector('.resize-handle').addEventListener('mousedown', (e) => {
    isResizing = true;
    startX = e.clientX;
    startY = e.clientY;
    startWidth = iframeWindow.offsetWidth;
    startHeight = iframeWindow.offsetHeight;

    document.addEventListener('mousemove', handleResizeMove);
    document.addEventListener('mouseup', handleResizeUp);
  });

  function handleResizeMove(e) {
    if (isResizing) {
      const newWidth = startWidth + (e.clientX - startX);
      const newHeight = startHeight + (e.clientY - startY);

      iframeWindow.style.width = `${newWidth}px`;
      iframeWindow.style.height = `${newHeight}px`;

      const iframe = iframeWindow.querySelector('#iframe');
      iframe.style.width = `${newWidth -20}px`;
      iframe.style.height = `${newHeight -50}px`;
    }
  }

  function handleResizeUp() {
    isResizing = false;
    document.removeEventListener('mousemove', handleResizeMove);
    document.removeEventListener('mouseup', handleResizeUp);
  }	

  openedWindows.push({
    type: 'Password MGR',
    id: uniqueId
  });
}

//-------credits-------------------------------------------------------------------------------------------

function crdits() {
  const uniqueId = generateUniqueId();
  const iframeWindow = document.createElement('div');
  iframeWindow.id = uniqueId;
  iframeWindow.className = 'windowifra';
  
  iframeWindow.innerHTML = `
    <div class="window-header" style="display: flex; justify-content: space-between; align-items: center;">
      <span>Credits</span>
      <div style="display: flex; gap: 5px;">
        <button onclick="toggleFullscreenIframe('${uniqueId}')" style="background:none; border:none; color: #ff5c5c; font-size: 16px;" class="redlightcolor">🗖</button>
        <button onclick="closeiframe('${uniqueId}')" style="background:none; border:none; color: #ff5c5c; font-size: 16px;" class="redlightcolor">X</button>
      </div>
    </div>
    <div class="window-body">
      <iframe id="iframe" frameborder="0" width="100%" height="550px" src="https://fabischau1.github.io/FMOSfiles/Credits"></iframe>
      <div class="resize-handle"></div>
    </div>
  `;
  
  document.body.appendChild(iframeWindow);
  iframeWindow.style.top = '50px';
  iframeWindow.style.left = '50px';
  iframeWindow.style.display = 'block';

  // Add animation when opening the window
  iframeWindow.classList.add('animate-in');

  // Add drag functionality
  let isDragging = false;
  let offsetX, offsetY;

  iframeWindow.querySelector('.window-header').addEventListener('mousedown', (e) => {
    isDragging = true;
    offsetX = e.clientX - iframeWindow.offsetLeft;
    offsetY = e.clientY - iframeWindow.offsetTop;

    document.addEventListener('mousemove', handleMouseMove);
    document.addEventListener('mouseup', handleMouseUp);
  });

  function handleMouseMove(e) {
    if (isDragging) {
      const newX = e.clientX - offsetX;
      const newY = e.clientY - offsetY;

      iframeWindow.style.top = `${newY}px`;
      iframeWindow.style.left = `${newX}px`;
    }
  }

  function handleMouseUp() {
    isDragging = false;
    document.removeEventListener('mousemove', handleMouseMove);
    document.removeEventListener('mouseup', handleMouseUp);
  }

  // Add resize functionality
  let isResizing = false;
  let startX, startY, startWidth, startHeight;

  iframeWindow.querySelector('.resize-handle').addEventListener('mousedown', (e) => {
    isResizing = true;
    startX = e.clientX;
    startY = e.clientY;
    startWidth = iframeWindow.offsetWidth;
    startHeight = iframeWindow.offsetHeight;

    document.addEventListener('mousemove', handleResizeMove);
    document.addEventListener('mouseup', handleResizeUp);
  });

  function handleResizeMove(e) {
    if (isResizing) {
      const newWidth = startWidth + (e.clientX - startX);
      const newHeight = startHeight + (e.clientY - startY);

      iframeWindow.style.width = `${newWidth}px`;
      iframeWindow.style.height = `${newHeight}px`;

      const iframe = iframeWindow.querySelector('#iframe');
      iframe.style.width = `${newWidth -20}px`;
      iframe.style.height = `${newHeight -50}px`;
    }
  }

  function handleResizeUp() {
    isResizing = false;
    document.removeEventListener('mousemove', handleResizeMove);
    document.removeEventListener('mouseup', handleResizeUp);
  }	

  openedWindows.push({
    type: 'Credits',
    id: uniqueId
  });
}

//-------codespace-------------------------------------------------------------------------------------------

function code() {
  const uniqueId = generateUniqueId();
  const iframeWindow = document.createElement('div');
  iframeWindow.id = uniqueId;
  iframeWindow.className = 'windowifra';
  
  iframeWindow.innerHTML = `
    <div class="window-header" style="display: flex; justify-content: space-between; align-items: center;">
      <span>FMcode</span>
      <div style="display: flex; gap: 5px;">
        <button onclick="toggleFullscreenIframe('${uniqueId}')" style="background:none; border:none; color: #ff5c5c; font-size: 16px;" class="redlightcolor">🗖</button>
        <button onclick="closeiframe('${uniqueId}')" style="background:none; border:none; color: #ff5c5c; font-size: 16px;" class="redlightcolor">X</button>
      </div>
    </div>
    <div class="window-body">
      <iframe id="iframe" frameborder="0" width="100%" height="550px" src="https://fabischau1.github.io/FMcode/"></iframe>
      <div class="resize-handle"></div>
    </div>
  `;
  
  document.body.appendChild(iframeWindow);
  iframeWindow.style.top = '50px';
  iframeWindow.style.left = '50px';
  iframeWindow.style.display = 'block';

  // Add animation when opening the window
  iframeWindow.classList.add('animate-in');

  // Add drag functionality
  let isDragging = false;
  let offsetX, offsetY;

  iframeWindow.querySelector('.window-header').addEventListener('mousedown', (e) => {
    isDragging = true;
    offsetX = e.clientX - iframeWindow.offsetLeft;
    offsetY = e.clientY - iframeWindow.offsetTop;

    document.addEventListener('mousemove', handleMouseMove);
    document.addEventListener('mouseup', handleMouseUp);
  });

  function handleMouseMove(e) {
    if (isDragging) {
      const newX = e.clientX - offsetX;
      const newY = e.clientY - offsetY;

      iframeWindow.style.top = `${newY}px`;
      iframeWindow.style.left = `${newX}px`;
    }
  }

  function handleMouseUp() {
    isDragging = false;
    document.removeEventListener('mousemove', handleMouseMove);
    document.removeEventListener('mouseup', handleMouseUp);
  }

  // Add resize functionality
  let isResizing = false;
  let startX, startY, startWidth, startHeight;

  iframeWindow.querySelector('.resize-handle').addEventListener('mousedown', (e) => {
    isResizing = true;
    startX = e.clientX;
    startY = e.clientY;
    startWidth = iframeWindow.offsetWidth;
    startHeight = iframeWindow.offsetHeight;

    document.addEventListener('mousemove', handleResizeMove);
    document.addEventListener('mouseup', handleResizeUp);
  });

  function handleResizeMove(e) {
    if (isResizing) {
      const newWidth = startWidth + (e.clientX - startX);
      const newHeight = startHeight + (e.clientY - startY);

      iframeWindow.style.width = `${newWidth}px`;
      iframeWindow.style.height = `${newHeight}px`;

      const iframe = iframeWindow.querySelector('#iframe');
      iframe.style.width = `${newWidth -20}px`;
      iframe.style.height = `${newHeight -50}px`;
    }
  }

  function handleResizeUp() {
    isResizing = false;
    document.removeEventListener('mousemove', handleResizeMove);
    document.removeEventListener('mouseup', handleResizeUp);
  }	

  openedWindows.push({
    type: 'FMcode',
    id: uniqueId
  });
}

//-------files-------------------------------------------------------------------------------------------

function secfil() {
  alert("Here you can permanently save files");
  alert("Be Carefull with running commands or code");
  alert("Tip: You Can Set A Password By Clicking On Settings Then Password");
  const uniqueId = generateUniqueId();
  const iframeWindow = document.createElement('div');
  iframeWindow.id = uniqueId;
  iframeWindow.className = 'windowifra';
  
  iframeWindow.innerHTML = `
    <div class="window-header" style="display: flex; justify-content: space-between; align-items: center;">
      <span>Files</span>
      <div style="display: flex; gap: 5px;">
        <button onclick="toggleFullscreenIframe('${uniqueId}')" style="background:none; border:none; color: #ff5c5c; font-size: 16px;" class="redlightcolor">🗖</button>
        <button onclick="closeiframe('${uniqueId}')" style="background:none; border:none; color: #ff5c5c; font-size: 16px;" class="redlightcolor">X</button>
      </div>
    </div>
    <div class="window-body">
      <iframe id="iframe" frameborder="0" width="100%" height="550px" src="https://fabischau1.github.io/FMOSfiles/"></iframe>
      <div class="resize-handle"></div>
    </div>
  `;
  
  document.body.appendChild(iframeWindow);
  iframeWindow.style.top = '50px';
  iframeWindow.style.left = '50px';
  iframeWindow.style.display = 'block';

  // Add animation when opening the window
  iframeWindow.classList.add('animate-in');

  // Add drag functionality
  let isDragging = false;
  let offsetX, offsetY;

  iframeWindow.querySelector('.window-header').addEventListener('mousedown', (e) => {
    isDragging = true;
    offsetX = e.clientX - iframeWindow.offsetLeft;
    offsetY = e.clientY - iframeWindow.offsetTop;

    document.addEventListener('mousemove', handleMouseMove);
    document.addEventListener('mouseup', handleMouseUp);
  });

  function handleMouseMove(e) {
    if (isDragging) {
      const newX = e.clientX - offsetX;
      const newY = e.clientY - offsetY;

      iframeWindow.style.top = `${newY}px`;
      iframeWindow.style.left = `${newX}px`;
    }
  }

  function handleMouseUp() {
    isDragging = false;
    document.removeEventListener('mousemove', handleMouseMove);
    document.removeEventListener('mouseup', handleMouseUp);
  }

  // Add resize functionality
  let isResizing = false;
  let startX, startY, startWidth, startHeight;

  iframeWindow.querySelector('.resize-handle').addEventListener('mousedown', (e) => {
    isResizing = true;
    startX = e.clientX;
    startY = e.clientY;
    startWidth = iframeWindow.offsetWidth;
    startHeight = iframeWindow.offsetHeight;

    document.addEventListener('mousemove', handleResizeMove);
    document.addEventListener('mouseup', handleResizeUp);
  });

  function handleResizeMove(e) {
    if (isResizing) {
      const newWidth = startWidth + (e.clientX - startX);
      const newHeight = startHeight + (e.clientY - startY);

      iframeWindow.style.width = `${newWidth}px`;
      iframeWindow.style.height = `${newHeight}px`;

      const iframe = iframeWindow.querySelector('#iframe');
      iframe.style.width = `${newWidth -20}px`;
      iframe.style.height = `${newHeight -50}px`;
    }
  }

  function handleResizeUp() {
    isResizing = false;
    document.removeEventListener('mousemove', handleResizeMove);
    document.removeEventListener('mouseup', handleResizeUp);
  }	

  openedWindows.push({
    type: 'secfil',
    id: uniqueId
  });
}

//-------browser-------------------------------------------------------------------------------------------

function openURLInIframe() {
  showError('Warning: Please only go to trusted websites, as they may contain malware that could affect your actual PC.')
  const uniqueId = generateUniqueId();
  const iframeWindow = document.createElement('div');
  iframeWindow.id = uniqueId;
  iframeWindow.className = 'windowifra';
  
  iframeWindow.innerHTML = `
    <div class="window-header" style="display: flex; justify-content: space-between; align-items: center;">
      <span>FM Browser</span>
      <div style="display: flex; gap: 5px;">
        <button onclick="toggleFullscreenIframe('${uniqueId}')" style="background:none; border:none; color: #ff5c5c; font-size: 16px;" class="redlightcolor">🗖</button>
        <button onclick="closeiframe('${uniqueId}')" style="background:none; border:none; color: #ff5c5c; font-size: 16px;" class="redlightcolor">X</button>
      </div>
    </div>
    <div class="window-body">
      <iframe id="iframe" frameborder="0" width="100%" height="550px" src="https://fabischau1.github.io/FMSearch/" sandbox="allow-same-origin allow-scripts allow-forms"></iframe>
      <div class="resize-handle"></div>
    </div>
  `;
  
  document.body.appendChild(iframeWindow);
  iframeWindow.style.top = '50px';
  iframeWindow.style.left = '50px';
  iframeWindow.style.display = 'block';

  // Add animation when opening the window
  iframeWindow.classList.add('animate-in');

  // Add drag functionality
  let isDragging = false;
  let offsetX, offsetY;

  iframeWindow.querySelector('.window-header').addEventListener('mousedown', (e) => {
    isDragging = true;
    offsetX = e.clientX - iframeWindow.offsetLeft;
    offsetY = e.clientY - iframeWindow.offsetTop;

    document.addEventListener('mousemove', handleMouseMove);
    document.addEventListener('mouseup', handleMouseUp);
  });

  function handleMouseMove(e) {
    if (isDragging) {
      const newX = e.clientX - offsetX;
      const newY = e.clientY - offsetY;

      iframeWindow.style.top = `${newY}px`;
      iframeWindow.style.left = `${newX}px`;
    }
  }

  function handleMouseUp() {
    isDragging = false;
    document.removeEventListener('mousemove', handleMouseMove);
    document.removeEventListener('mouseup', handleMouseUp);
  }

  // Add resize functionality
  let isResizing = false;
  let startX, startY, startWidth, startHeight;

  iframeWindow.querySelector('.resize-handle').addEventListener('mousedown', (e) => {
    isResizing = true;
    startX = e.clientX;
    startY = e.clientY;
    startWidth = iframeWindow.offsetWidth;
    startHeight = iframeWindow.offsetHeight;

    document.addEventListener('mousemove', handleResizeMove);
    document.addEventListener('mouseup', handleResizeUp);
  });

  function handleResizeMove(e) {
    if (isResizing) {
      const newWidth = startWidth + (e.clientX - startX);
      const newHeight = startHeight + (e.clientY - startY);

      iframeWindow.style.width = `${newWidth}px`;
      iframeWindow.style.height = `${newHeight}px`;

      const iframe = iframeWindow.querySelector('#iframe');
      iframe.style.width = `${newWidth -20}px`;
      iframe.style.height = `${newHeight -50}px`;
    }
  }

  function handleResizeUp() {
    isResizing = false;
    document.removeEventListener('mousemove', handleResizeMove);
    document.removeEventListener('mouseup', handleResizeUp);
  }	

  openedWindows.push({
    type: 'FM Browser',
    id: uniqueId
  });
}

//-------vm-------------------------------------------------------------------------------------------

function vm() {
  const uniqueId = generateUniqueId();
  const iframeWindow = document.createElement('div');
  iframeWindow.id = uniqueId;
  iframeWindow.className = 'windowifra';
  
  iframeWindow.innerHTML = `
    <div class="window-header" style="display: flex; justify-content: space-between; align-items: center;">
      <span>VM</span>
      <div style="display: flex; gap: 5px;">
        <button onclick="toggleFullscreenIframe('${uniqueId}')" style="background:none; border:none; color: #ff5c5c; font-size: 16px;" class="redlightcolor">🗖</button>
        <button onclick="closeiframe('${uniqueId}')" style="background:none; border:none; color: #ff5c5c; font-size: 16px;" class="redlightcolor">X</button>
      </div>
    </div>
    <div class="window-body">
      <iframe id="iframe" frameborder="0" width="100%" height="550px" src="https://fabischau1.github.io/BIOS/"></iframe>
      <div class="resize-handle"></div>
    </div>
  `;
  
  document.body.appendChild(iframeWindow);
  iframeWindow.style.top = '50px';
  iframeWindow.style.left = '50px';
  iframeWindow.style.display = 'block';

  // Add animation when opening the window
  iframeWindow.classList.add('animate-in');

  // Add drag functionality
  let isDragging = false;
  let offsetX, offsetY;

  iframeWindow.querySelector('.window-header').addEventListener('mousedown', (e) => {
    isDragging = true;
    offsetX = e.clientX - iframeWindow.offsetLeft;
    offsetY = e.clientY - iframeWindow.offsetTop;

    document.addEventListener('mousemove', handleMouseMove);
    document.addEventListener('mouseup', handleMouseUp);
  });

  function handleMouseMove(e) {
    if (isDragging) {
      const newX = e.clientX - offsetX;
      const newY = e.clientY - offsetY;

      iframeWindow.style.top = `${newY}px`;
      iframeWindow.style.left = `${newX}px`;
    }
  }

  function handleMouseUp() {
    isDragging = false;
    document.removeEventListener('mousemove', handleMouseMove);
    document.removeEventListener('mouseup', handleMouseUp);
  }

  // Add resize functionality
  let isResizing = false;
  let startX, startY, startWidth, startHeight;

  iframeWindow.querySelector('.resize-handle').addEventListener('mousedown', (e) => {
    isResizing = true;
    startX = e.clientX;
    startY = e.clientY;
    startWidth = iframeWindow.offsetWidth;
    startHeight = iframeWindow.offsetHeight;

    document.addEventListener('mousemove', handleResizeMove);
    document.addEventListener('mouseup', handleResizeUp);
  });

  function handleResizeMove(e) {
    if (isResizing) {
      const newWidth = startWidth + (e.clientX - startX);
      const newHeight = startHeight + (e.clientY - startY);

      iframeWindow.style.width = `${newWidth}px`;
      iframeWindow.style.height = `${newHeight}px`;

      const iframe = iframeWindow.querySelector('#iframe');
      iframe.style.width = `${newWidth -20}px`;
      iframe.style.height = `${newHeight -50}px`;
    }
  }

  function handleResizeUp() {
    isResizing = false;
    document.removeEventListener('mousemove', handleResizeMove);
    document.removeEventListener('mouseup', handleResizeUp);
  }	

  openedWindows.push({
    type: 'vm',
    id: uniqueId
  });
}

//-------folder-mgr------------------------------------------------------------------------------------------

function foldermgr() {
  const uniqueId = generateUniqueId();
  const iframeWindow = document.createElement('div');
  iframeWindow.id = uniqueId;
  iframeWindow.className = 'windowifra';
  
  iframeWindow.innerHTML = `
    <div class="window-header" style="display: flex; justify-content: space-between; align-items: center;">
      <span>FolderMGR</span>
      <div style="display: flex; gap: 5px;">
        <button onclick="toggleFullscreenIframe('${uniqueId}')" style="background:none; border:none; color: #ff5c5c; font-size: 16px;" class="redlightcolor">🗖</button>
        <button onclick="closeiframe('${uniqueId}')" style="background:none; border:none; color: #ff5c5c; font-size: 16px;" class="redlightcolor">X</button>
      </div>
    </div>
    <div class="window-body">
      <iframe id="iframe" frameborder="0" width="100%" height="550px" src="https://fabischau1.github.io/FMOS/Folder/main"></iframe>
      <div class="resize-handle"></div>
    </div>
  `;
  
  document.body.appendChild(iframeWindow);
  iframeWindow.style.top = '50px';
  iframeWindow.style.left = '50px';
  iframeWindow.style.display = 'block';

  // Add animation when opening the window
  iframeWindow.classList.add('animate-in');

  // Add drag functionality
  let isDragging = false;
  let offsetX, offsetY;

  iframeWindow.querySelector('.window-header').addEventListener('mousedown', (e) => {
    isDragging = true;
    offsetX = e.clientX - iframeWindow.offsetLeft;
    offsetY = e.clientY - iframeWindow.offsetTop;

    document.addEventListener('mousemove', handleMouseMove);
    document.addEventListener('mouseup', handleMouseUp);
  });

  function handleMouseMove(e) {
    if (isDragging) {
      const newX = e.clientX - offsetX;
      const newY = e.clientY - offsetY;

      iframeWindow.style.top = `${newY}px`;
      iframeWindow.style.left = `${newX}px`;
    }
  }

  function handleMouseUp() {
    isDragging = false;
    document.removeEventListener('mousemove', handleMouseMove);
    document.removeEventListener('mouseup', handleMouseUp);
  }

  // Add resize functionality
  let isResizing = false;
  let startX, startY, startWidth, startHeight;

  iframeWindow.querySelector('.resize-handle').addEventListener('mousedown', (e) => {
    isResizing = true;
    startX = e.clientX;
    startY = e.clientY;
    startWidth = iframeWindow.offsetWidth;
    startHeight = iframeWindow.offsetHeight;

    document.addEventListener('mousemove', handleResizeMove);
    document.addEventListener('mouseup', handleResizeUp);
  });

  function handleResizeMove(e) {
    if (isResizing) {
      const newWidth = startWidth + (e.clientX - startX);
      const newHeight = startHeight + (e.clientY - startY);

      iframeWindow.style.width = `${newWidth}px`;
      iframeWindow.style.height = `${newHeight}px`;

      const iframe = iframeWindow.querySelector('#iframe');
      iframe.style.width = `${newWidth -20}px`;
      iframe.style.height = `${newHeight -50}px`;
    }
  }

  function handleResizeUp() {
    isResizing = false;
    document.removeEventListener('mousemove', handleResizeMove);
    document.removeEventListener('mouseup', handleResizeUp);
  }	

  openedWindows.push({
    type: 'FolderMGR',
    id: uniqueId
  });
}

//-------welcome-message------------------------------------------------------------------------------------------

function welcomemsg() {
  const iframeWindow = document.createElement('div');
  iframeWindow.className = 'windowifc'; // same class as the HTML preview iframe
  iframeWindow.innerHTML = `
    <div class="window-header" style="display: flex; justify-content: space-between; align-items: center;">
      <span>WELCOME TO FMOS</span>
      <div style="display: flex; gap: 5px;">
        <button onclick="toggleFullscreencaculator()" style="background:none; border:none; color: #ff5c5c; font-size: 16px;" class="redlightcolor">🗖</button>
        <button onclick="checkTOS()" style="background:none; border:none; color: #ff5c5c; font-size: 16px;" class="redlightcolor">X</button>
      </div>
    </div>
    <div class="window-body">
      <iframe id="iframe" frameborder="0" width="100%" height="550px" src="https://fabischau1.github.io/FMOS/Bootscreen/Welcome"></iframe>
      <div class="resize-handle"></div>
    </div>
  `;
  document.body.appendChild(iframeWindow);
  iframeWindow.style.top = '50px';
  iframeWindow.style.left = '50px';
  iframeWindow.style.display = 'block'; // show the window

  // Add animation when opening the window
  iframeWindow.classList.add('animate-in');

  // Add drag functionality
  let isDragging = false;
  let offsetX, offsetY;

  iframeWindow.querySelector('.window-header').addEventListener('mousedown', (e) => {
    isDragging = true;
    offsetX = e.clientX - iframeWindow.offsetLeft;
    offsetY = e.clientY - iframeWindow.offsetTop;

    document.addEventListener('mousemove', handleMouseMove);
    document.addEventListener('mouseup', handleMouseUp);
  });

  function handleMouseMove(e) {
    if (isDragging) {
      const newX = e.clientX - offsetX;
      const newY = e.clientY - offsetY;

      iframeWindow.style.top = `${newY}px`;
      iframeWindow.style.left = `${newX}px`;
    }
  }

  function handleMouseUp() {
    isDragging = false;
    document.removeEventListener('mousemove', handleMouseMove);
    document.removeEventListener('mouseup', handleMouseUp);
  }

  // Add resize functionality
  let isResizing = false;
  let startX, startY, startWidth, startHeight;

  iframeWindow.querySelector('.resize-handle').addEventListener('mousedown', (e) => {
    isResizing = true;
    startX = e.clientX;
    startY = e.clientY;
    startWidth = iframeWindow.offsetWidth;
    startHeight = iframeWindow.offsetHeight;

    document.addEventListener('mousemove', handleResizeMove);
    document.addEventListener('mouseup', handleResizeUp);
  });

  function handleResizeMove(e) {
    if (isResizing) {
      const newWidth = startWidth + (e.clientX - startX);
      const newHeight = startHeight + (e.clientY - startY);

      iframeWindow.style.width = `${newWidth}px`;
      iframeWindow.style.height = `${newHeight}px`;
    }
  }

  function handleResizeUp() {
    isResizing = false;
    document.removeEventListener('mousemove', handleResizeMove);
    document.removeEventListener('mouseup', handleResizeUp);
  }
}

function checkTOS() {
    if (confirm("Do you accept the Terms of Service?")) {
        document.querySelector('.windowifc').remove();
        localStorage.setItem('TOS', 'true');
    } else {
        location.reload();
    }
}

//-------chat-box-1-----------------------------------------------------------------------------------------

function Chatbox1() {
  const uniqueId = generateUniqueId();
  const iframeWindow = document.createElement('div');
  iframeWindow.id = uniqueId;
  iframeWindow.className = 'windowifra';
  
  iframeWindow.innerHTML = `
    <div class="window-header" style="display: flex; justify-content: space-between; align-items: center;">
      <span>FolderMGR</span>
      <div style="display: flex; gap: 5px;">
        <button onclick="toggleFullscreenIframe('${uniqueId}')" style="background:none; border:none; color: #ff5c5c; font-size: 16px;" class="redlightcolor">🗖</button>
        <button onclick="closeiframe('${uniqueId}')" style="background:none; border:none; color: #ff5c5c; font-size: 16px;" class="redlightcolor">X</button>
      </div>
    </div>
    <div class="window-body">
      <iframe id="iframe" frameborder="0" width="100%" height="550px" src="https://fabischau1.github.io/FMOS/error003"></iframe>
      <div class="resize-handle"></div>
    </div>
  `;
  
  document.body.appendChild(iframeWindow);
  iframeWindow.style.top = '50px';
  iframeWindow.style.left = '50px';
  iframeWindow.style.display = 'block';

  // Add animation when opening the window
  iframeWindow.classList.add('animate-in');

  // Add drag functionality
  let isDragging = false;
  let offsetX, offsetY;

  iframeWindow.querySelector('.window-header').addEventListener('mousedown', (e) => {
    isDragging = true;
    offsetX = e.clientX - iframeWindow.offsetLeft;
    offsetY = e.clientY - iframeWindow.offsetTop;

    document.addEventListener('mousemove', handleMouseMove);
    document.addEventListener('mouseup', handleMouseUp);
  });

  function handleMouseMove(e) {
    if (isDragging) {
      const newX = e.clientX - offsetX;
      const newY = e.clientY - offsetY;

      iframeWindow.style.top = `${newY}px`;
      iframeWindow.style.left = `${newX}px`;
    }
  }

  function handleMouseUp() {
    isDragging = false;
    document.removeEventListener('mousemove', handleMouseMove);
    document.removeEventListener('mouseup', handleMouseUp);
  }

  // Add resize functionality
  let isResizing = false;
  let startX, startY, startWidth, startHeight;

  iframeWindow.querySelector('.resize-handle').addEventListener('mousedown', (e) => {
    isResizing = true;
    startX = e.clientX;
    startY = e.clientY;
    startWidth = iframeWindow.offsetWidth;
    startHeight = iframeWindow.offsetHeight;

    document.addEventListener('mousemove', handleResizeMove);
    document.addEventListener('mouseup', handleResizeUp);
  });

  function handleResizeMove(e) {
    if (isResizing) {
      const newWidth = startWidth + (e.clientX - startX);
      const newHeight = startHeight + (e.clientY - startY);

      iframeWindow.style.width = `${newWidth}px`;
      iframeWindow.style.height = `${newHeight}px`;

      const iframe = iframeWindow.querySelector('#iframe');
      iframe.style.width = `${newWidth -20}px`;
      iframe.style.height = `${newHeight -50}px`;
    }
  }

  function handleResizeUp() {
    isResizing = false;
    document.removeEventListener('mousemove', handleResizeMove);
    document.removeEventListener('mouseup', handleResizeUp);
  }	

  openedWindows.push({
    type: 'Chat Box',
    id: uniqueId
  });
}

//-------fullscreen-close-functions-----------------------------------------------------------------------------------------


function closeiframe(windowId) {
  const vmWindow = document.getElementById(windowId);
  if (!vmWindow) return;

  vmWindow.style.animation = 'animate-out 0.3s forwards';

  setTimeout(() => {
    vmWindow.remove();

    const index = openedWindows.findIndex(win => win.id === windowId);
    if (index !== -1) {
      openedWindows.splice(index, 1);
    }
  }, 250);
}



function toggleFullscreenIframe(windowId) {
  const iframeWindow = document.getElementById(windowId);
  const iframe = iframeWindow.querySelector('#iframe');
  
  if (iframeWindow.classList.contains('fullscreen')) {
    iframeWindow.classList.remove('fullscreen');
    iframeWindow.style.top = '50px';
    iframeWindow.style.left = '50px';
    iframeWindow.style.width = '600px';
    iframeWindow.style.height = '600px';
    iframe.style.width = '100%';
    iframe.style.height = '550px';
  } else {
    iframeWindow.classList.add('fullscreen');
    iframeWindow.style.top = '0';
    iframeWindow.style.left = '0';
    iframeWindow.style.width = '100vw';
    iframeWindow.style.height = '100vh';
    iframe.style.width = '100%';
    iframe.style.height = 'calc(100vh - 20px)';
  }
}

//------------------------------------------------------------------------------------------------------//
//------------------------------------------------------------------------------------------------------//
//                                     ---Setting Menus---                                              //
//------------------------------------------------------------------------------------------------------//
//------------------------------------------------------------------------------------------------------//

//-------new-setting-menu-----------------------------------------------------------------------------------------

let isResizing = false;

function openMenu() {
    const menu = document.getElementById("settingsMenu");
    menu.style.display = "block";
    loadSettings();
}


document.getElementById("closeBtn").addEventListener("click", function() {
    document.getElementById("settingsMenu").style.display = "none";
});

const menuHeader = document.getElementById("menuHeader");
menuHeader.addEventListener("mousedown", (e) => {
    isDragging = true;
    offsetX = e.clientX - settingsMenu.offsetLeft;
    offsetY = e.clientY - settingsMenu.offsetTop;
});

document.addEventListener("mousemove", (e) => {
    if (isDragging) {
        const menu = document.getElementById("settingsMenu");
        menu.style.left = `${e.clientX - offsetX}px`;
        menu.style.top = `${e.clientY - offsetY}px`;
    }
});

document.addEventListener("mouseup", () => {
    isDragging = false;
});

const resizeHandle = document.getElementById("resizeHandle");
resizeHandle.addEventListener("mousedown", (e) => {
    isResizing = true;
});

document.addEventListener("mousemove", (e) => {
    if (isResizing) {
        const menu = document.getElementById("settingsMenu");
        const newWidth = e.clientX - menu.getBoundingClientRect().left;
        const newHeight = e.clientY - menu.getBoundingClientRect().top;

        // Min-Max-Größen festlegen
        if (newWidth > 200 && newHeight > 100) {
            menu.style.width = newWidth + "px";
            menu.style.height = newHeight + "px";
        }
    }
});

// Mouseup-Event für Resize
document.addEventListener("mouseup", () => {
    isResizing = false;
});

function loadSettings() {
    const settings = {
        bootScreen: localStorage.getItem('showFullScreenIframe') === 'false',
        loginScreen: localStorage.getItem('settinglogin') === 'True',
        fileNames: localStorage.getItem('fmosfilenamessetting') === 'true',
        adminScripts: localStorage.getItem('settingadmin') === 'True',
        bootScripts: localStorage.getItem('settingbootsk') === 'True',
    };

    document.getElementById("bootScreen").checked = settings.bootScreen;
    document.getElementById("loginScreen").checked = settings.loginScreen;
    document.getElementById("fileNames").checked = settings.fileNames;
    document.getElementById("adminScripts").checked = settings.adminScripts;
    document.getElementById("bootScripts").checked = settings.bootScripts;
}

function toggleBootScreen() {
    const isChecked = document.getElementById("bootScreen").checked;
    localStorage.setItem('showFullScreenIframe', isChecked);
    isChecked ? setFullScreenIframeKeyFalse() : setFullScreenIframeKeyTrue();
}

function toggleLoginScreen() {
    const isChecked = document.getElementById("loginScreen").checked;
    localStorage.setItem('settinglogin', isChecked);
    isChecked ? enablelogin() : disablelogin();
}

function toggleFileNames() {
    const isChecked = document.getElementById("fileNames").checked;
    localStorage.setItem('fmosfilenamessetting', isChecked);
    isChecked ? enableFileNames() : disableFileNames();
}

function toggleAdminScripts() {
    const isChecked = document.getElementById("adminScripts").checked;
    localStorage.setItem('settingadmin', isChecked);
    isChecked ? enableadminscripts() : disableadminscripts();
}

function toggleBootScripts() {
    const isChecked = document.getElementById("bootScripts").checked;
    localStorage.setItem('settingbootsk', isChecked);
    isChecked ? enablebootsk() : disablebootsk();
}

function togglesettingwinold() {
    const isChecked = document.getElementById("oldsettings").checked;
    localStorage.setItem('settingsettingwinold', isChecked);
    isChecked ? enablesettingwinold() : disablesettingwinold();
}

//-------style-settings---------------------------------------------------------------------------------------

function toggleSelectionWindow() {
  const selectionWindow = document.querySelector('[data-div-id="stlyes"]');
  selectionWindow.classList.toggle('active');
}

function animationsettings() {
  const selectionWindow = document.querySelector('[data-div-id="animations"]');
  selectionWindow.classList.toggle('active');
}

function wallpapersettings() {
  const selectionWindow = document.querySelector('[data-div-id="wallpapers"]');
  selectionWindow.classList.toggle('active');
}

function startmenu() {
  const selectionWindow = document.querySelector('[data-div-id="Startmenu"]');
  selectionWindow.classList.toggle('active');
}

//-------apps------------------------------------------------------------------------------------------

function appwindowfinder() {
  const selectionWindow = document.getElementById('appsfinder-window');
  selectionWindow.classList.toggle('active');
}

//-------folder-options----------------------------------------------------------------------------------------

function folsell() {
  const selectionWindow = document.getElementById('folsel-window');
  selectionWindow.classList.toggle('active');
}

//-------old-system-settings---------------------------------------------------------------------------------------

function syssettings() {
  const selectionWindow = document.getElementById('sysset-window');
  selectionWindow.classList.toggle('active');
}

//------------------------------------------------------------------------------------------------------//
//------------------------------------------------------------------------------------------------------//
//                                     ---File And Desktop System---                                    //
//------------------------------------------------------------------------------------------------------//
//------------------------------------------------------------------------------------------------------//

//-------function-names-are-self-explainotory---------------------------------------------------------------------------------------

function openfmosfolder() {
    if (selectedFile && selectedFile.endsWith('.folder')) {
        const folderName = selectedFile.slice(0, -'.folder'.length);

        const fullPath = getFullPath(currentPath, folderName);
        const storageKey = `FMOSfolder${fullPath}`;
        const folderContent = filesystem[storageKey];

        if (folderContent) {
            files = JSON.parse(folderContent);
            folders = {};

            currentPath = fullPath;

            renderFiles();
            alert(`Connected to folder at: ${currentPath}`);
        } else {
            showError('Folder not found.');
        }
    } else {
        showError('Selected file is not a valid folder.');
    }
}

function openfmosfolderfile(name) {
	const pfadname = desktoppathdirfull + '/' + name.slice(0, -'.folder'.length);
	console.log(pfadname)
    if (filesystem.hasOwnProperty(pfadname) && selectedFile && selectedFile.endsWith('.folder')) {
        const folderName = name.slice(0, -'.folder'.length);
		const folderMGR = document.getElementById('folderMGR');
		const nameforvalue = desktoppathdir + '/' + folderName
		const nameforvaluefull = desktoppathdirfull + '/' + folderName
		if (folderMGR.style.display === 'block') {
			document.getElementById('pathInput').value = nameforvalue;
			loadFiles(nameforvaluefull);
		} else {
			showFolderMGR();
			document.getElementById('pathInput').value = nameforvalue;
			loadFiles(nameforvaluefull);
		}
    } else {
        showError('Selected file is not a valid folder.');
    }
}

function openfmosfolderinfolmgr(name) {
	const varfinalofvalue = PathToreloadFolderMGR + (PathToreloadFolderMGR === '/' ? '' : '/') + name
	const varfinalofvaluefull = 'FMOSfolder' + varfinalofvalue
	if (filesystem.hasOwnProperty(varfinalofvaluefull)) {
		document.getElementById('pathInput').value = varfinalofvalue;
		loadFiles(varfinalofvalue);
    } else {
        showError('This folder is not a valid folder.');
    }
}

const ROOT_PATH = '/';

function getFullPath(folderPath, folderName) {
    return `${folderPath}/${folderName}`.replace('//', '/');
}

let currentPath = ROOT_PATH;

function showCurrentFolder() {
    const folderName = currentPath.split('/').pop() || '/';
    alert(`Current folder: ${folderName}\nPath: ${currentPath}`);
}

function checkIfPathExists(path) {
    const allKeys = Object.keys(localStorage);
    return allKeys.includes(`FMOSfolder${path}`);
}

function saveFolderWithPath() {
    const folderPath = prompt("Enter folder path (e.g., /path/to/folder):", ROOT_PATH);
    const folderName = prompt("Enter folder name:");

    if (folderPath && folderName) {
        const pathSegments = folderPath.split('/').filter(Boolean);
        let currentFullPath = ROOT_PATH;

        for (const segment of pathSegments) {
            currentFullPath = getFullPath(currentFullPath, segment);
            if (!checkIfPathExists(currentFullPath)) {
                showError(`The path "${currentFullPath}" does not exist.`);
                return;
            }
        }

        // Save the folder if all paths exist
        const fullPath = getFullPath(folderPath, folderName);
        const storageKey = `FMOSfolder${fullPath}`;
        filesetData(storageKey, JSON.stringify(files));
		const folderfilename = folderName + '.folder'
		const fullfoldername = folderPath.slice(1);
		CreateFile(fullfoldername, folderfilename, '')
        alert(`Folder saved at ${fullPath}`);
    } else {
        showError("Folder path or name is invalid.");
    }
}


function saveFolderWithNameOnly() {
    const folderName = prompt("Enter folder name:");
    if (folderName) {
        const fullPath = getFullPath(currentPath, folderName);
        const storageKey = `FMOSfolder${fullPath}`;
        filesetData(storageKey, JSON.stringify(files));
		const folderfilename = folderName + '.folder'
		const fullfoldername = currentPath.slice(1);
		CreateFile(fullfoldername, folderfilename, '')
        alert(`Folder saved at ${fullPath}`);
    } else {
        showError("Folder name is invalid.");
    }
}

function loadFolderWithPath() {
    const folderPath = prompt("Enter folder path (e.g., /path/to/folder):", ROOT_PATH);
    if (folderPath) {
        const storageKey = `FMOSfolder${folderPath}`;
        const folderContent = filesystem[storageKey];
        if (folderContent) {
            files = JSON.parse(folderContent);
			currentPath = folderPath;
            folders = {};
            renderFiles();
        } else {
            showError('Folder not found at the specified path.');
        }
    } else {
        showError('Folder path is invalid.');
    }
}

function loadFolderWithNameOnly() {
    const folderName = prompt("Enter folder name:");

    if (folderName) {
        const fullPath = getFullPath(currentPath, folderName);
        const storageKey = `FMOSfolder${fullPath}`;
        const folderContent = filesystem[storageKey];

        if (folderContent) {
            files = JSON.parse(folderContent);
            folders = {};
            
            currentPath = fullPath;

            renderFiles();
            alert(`Connected to folder at: ${currentPath}`);
        } else {
            showError('Folder not found.');
        }
    } else {
        showError('Folder name is invalid.');
    }
}

function deleteFolderWithPath() {
    const folderPath = prompt("Enter folder path to delete (e.g., /path/to/folder):", ROOT_PATH);
    if (folderPath) {
        const storageKey = `FMOSfolder${folderPath}`;
        if (filesystem.hasOwnProperty(storageKey)) {
            folderdeleteData(storageKey);
            alert(`Folder at ${folderPath} has been deleted.`);
        } else {
            showError('Folder not found at the specified path.');
        }
    } else {
        showError('Folder path is invalid.');
    }
}

function deleteFolderWithNameOnly() {
    const folderName = prompt("Enter folder name to delete:");
    if (folderName) {
        const fullPath = getFullPath(ROOT_PATH, folderName);
        const storageKey = `FMOSfolder${fullPath}`;
        if (filesystem.hasOwnProperty(storageKey)) {
            folderdeleteData(storageKey);
            alert(`Folder '${folderName}' has been deleted.`);
        } else {
            showError('Folder not found.');
        }
    } else {
        showError('Folder name is invalid.');
    }
}

function deleteAllFolders() {
    if (confirm('Are you sure you want to delete all folders?')) {
		filesclearAllData();
    }
}

function showAllFolders() {
	const fmosFolderKeys = Object.keys(filesystem).filter(key => key.startsWith('FMOSfolder'));
    if (fmosFolderKeys.length === 0) {
        showError('No folders found.');
        return;
    }
    const folderNames = fmosFolderKeys.map(key => key.replace('FMOSfolder', ''));
    
    alert(`Folders:\n${folderNames.join('\n')}`);
}


function savedesktopWithCustomName() {
    const customName = prompt("Desktop Name:");
    if (customName) {
        const storageKey = `FMOSdesktop${customName}`;
        localStorage.setItem(storageKey, JSON.stringify(files));
        alert(`Files Saved In ${storageKey}`);
    }
}

function loaddesktopContent() {
    const desktopname = prompt("Desktop Name:");
    if (desktopname) {
        const storageKey = `FMOSdesktop${desktopname}`;
        const folderContent = localStorage.getItem(storageKey);

        if (folderContent) {
            files = JSON.parse(folderContent);
            // Reset the existing folders
            folders = {};

            // Render files and folders
            renderFiles();
        } else {
            showError('No Folder Found With That Name.');
        }
    }
}

function showAllFMOSdesktopNames() {
    const allKeys = Object.keys(localStorage);
    const fmosFolderKeys = allKeys.filter(key => key.startsWith('FMOSdesktop'));

    if (fmosFolderKeys.length === 0) {
        showError('Nothing Found.');
        console.log('No FMOSdesktop entries found.');
        return;
    }

    const folderNames = fmosFolderKeys.map(key => key.replace('FMOSdesktop', ''));
    const message = folderNames.join('\n');

    alert(`FMOSdesktop entries:\n${message}`);
    console.log('FMOSdesktop entries:');
    console.log(message);
}
function deleteAllFMOSdesktopItems() {
    const allKeys = Object.keys(localStorage);
    const fmosFolderKeys = allKeys.filter(key => key.startsWith('FMOSdesktop'));

    if (fmosFolderKeys.length === 0) {
        showError('No Folders To Delete.');
        console.log('No FMOSdesktop entries found to delete.');
        return;
    }

    const confirmation = confirm('Are you sure you want to delete all FMOSdesktop entries? This action cannot be undone.');

    if (!confirmation) {
        alert('Operation cancelled.');
        console.log('Operation cancelled.');
        return;
    }

    fmosFolderKeys.forEach(key => localStorage.removeItem(key));

    alert('All FMOSdesktop entries have been deleted.');
    console.log('The following FMOSdesktop entries have been deleted:');
    console.log(fmosFolderKeys.join('\n'));
}

function deleteSpecificdesktop() {
    const desktopname = prompt('Enter the name of the folder to delete:');

    if (!desktopname) {
        showError('An error has occurred.');
        return;
    }

    const folderKey = `FMOSdesktop${desktopname}`;

    if (!localStorage.getItem(folderKey)) {
        showError('Folder Does Not exist');
        return;
    }

    deletedesktopContents(folderKey);
    localStorage.removeItem(folderKey);

    alert(`Folder '${desktopname}' has been deleted.`);
    console.log(`Folder '${desktopname}' and its contents have been deleted.`);
}

function deletedesktopContents(folderKey) {
    const allKeys = Object.keys(localStorage);
    const folderKeys = allKeys.filter(key => key.startsWith(folderKey));

    folderKeys.forEach(key => localStorage.removeItem(key));
}

function migratefolderstodesktops() {
    for (let i = 0; i < localStorage.length; i++) {
        let key = localStorage.key(i);
        
        if (key.startsWith('FMOSfolder')) {
            let newKey = key.replace('FMOSfolder', 'FMOSdesktop');
            
            localStorage.setItem(newKey, localStorage.getItem(key));
            
            localStorage.removeItem(key);
        }
    }
}

//-------loads-files-out-of-secure-folder-------------------------------------------------------------------------------------

function loads() {
	alert("Tip: You Can Set A Password By Clicking On Settings Then Password");
    const enteredPassword = prompt("Password:");

    const storedPassword = localStorage.getItem('password');

    if (enteredPassword === storedPassword) {
        if (localStorage.getItem('files')) {
			files = JSON.parse(localStorage.getItem('files'));
		}
		renderFiles();
    } else {
		alert("Password incorrect")
        setTimeout(askForPassword, 3000);
    }
}

//------------------------------------------------------------------------------------------------------//
//------------------------------------------------------------------------------------------------------//
//                                     ---Functions for devs---                                         //
//------------------------------------------------------------------------------------------------------//
//------------------------------------------------------------------------------------------------------//

//-------execute-files------------------------------------------------------------------------------------------

function exedir(FolderPathExecution, fileName) {
    const FolderPathPrefixExecution = 'FMOSfolder';
    const FolderPathFinalExe = FolderPathPrefixExecution + FolderPathExecution;

    exedircontent = filesystem[FolderPathFinalExe];
    
    if (exedircontent) {
        try {
            const fileObject = JSON.parse(exedircontent);

            if (fileObject && fileObject[fileName]) {
                exedircontent = fileObject[fileName];
				
					const jspatternsforexecution = [
						/localStorage\.removeItem/i,
						/localStorage\.getItem/i,
						/localStorage\.clear/i,
						/localStorage\.setItem/i,
						/setboot/i,
						/FMOSboot/i,
						/hex/i,
						/filesetData/i,
						/folderdeleteData/i,
						/filedeleteData/i,
						/objectStore/i,
						/atob/i
					];
					for (const pattern of jspatternsforexecution) {
						if (pattern.test(exedircontent)) {
							showError('This script needs administrator');
							return;
						}
					}
					if (fileName && (fileName.endsWith('.fexe') || fileName.endsWith('.js') || fileName.endsWith('.py') || fileName.endsWith('.zfp') || fileName.endsWith('.fsys'))) {
						try {
							eval(exedircontent);
						} catch (error) {
							alert(`ERROR: ${error.message}`);
						}
					} else {
						showError("ERROR: This file type cannot run js.");
					}
            } else {
                console.log("File not found: " + fileName);
                exedircontent = null;
            }
        } catch (error) {
            console.error("Error parsing JSON from localStorage:", error);
            exedircontent = null;
        }
    } else {
        console.log("No content found for: " + FolderPathFinalExe);
        exedircontent = null;
    }
}

function getFileContent(fileName) {
    return files[fileName] || "File not found.";
}

function execute(fileName) {
	content = getFileContent(fileName)
	const jspatternsforexecution = [
		/localStorage\.removeItem/i,
		/localStorage\.getItem/i,
		/localStorage\.clear/i,
		/localStorage\.setItem/i,
		/setboot/i,
		/FMOSboot/i,
		/hex/i,
		/filesetData/i,
		/folderdeleteData/i,
		/filedeleteData/i,
		/objectStore/i,
		/atob/i
	];
	for (const pattern of jspatternsforexecution) {
        if (pattern.test(content)) {
            showError('This script needs administrator');
            return;
        }
    }
	if (fileName && (fileName.endsWith('.fexe') || fileName.endsWith('.js') || fileName.endsWith('.py') || fileName.endsWith('.zfp') || fileName.endsWith('.fsys'))) {
		try {
			eval(content);
		} catch (error) {
			alert(`ERROR: ${error.message}`);
		}
	} else {
        showError("ERROR: This file type cannot run js.");
    }
}

//-------create-files-and-folders----------------------------------------------------------------------------------------

function CreateFile(FolderPath, FileName, FileContent) {
	
	folderkey = 'FMOSfolder' + '/' + FolderPath
	
	if (filesystem[folderkey] !== null) {
		const dircontent1 = filesystem[folderkey];

		dircontent = JSON.parse(dircontent1);
		
		dircontent[FileName] = FileContent;
		
		jsonFiles = JSON.stringify(dircontent);
		
		filesetData(folderkey, jsonFiles);
		
		connectdesktops('1');
		
	} else {
        showError('this folder does not exist')
    }
}



//-------custom-app------------------------------------------------------------------------------------------

// usage: app('url')

function app(url) {
  const usersecureconfirm = confirm('this will open an iframe (wich can possibly be dangerous if its an unsafe webside) if u want to open this iframe click ok (on ur own risk). only use this on trusted websides in the iframe!!')
  if (usersecureconfirm) {
	  const uniqueId = generateUniqueId();
	  const iframeWindow = document.createElement('div');
	  iframeWindow.id = uniqueId;
	  iframeWindow.className = 'windowifra';
	  
	  iframeWindow.innerHTML = `
		<div class="window-header" style="display: flex; justify-content: space-between; align-items: center;">
		  <span>App</span>
		  <div style="display: flex; gap: 5px;">
			<button onclick="toggleFullscreenIframe('${uniqueId}')" style="background:none; border:none; color: #ff5c5c; font-size: 16px;" class="redlightcolor">🗖</button>
			<button onclick="closeiframe('${uniqueId}')" style="background:none; border:none; color: #ff5c5c; font-size: 16px;" class="redlightcolor">X</button>
		  </div>
		</div>
		<div class="window-body">
		  <iframe id="iframe" frameborder="0" width="100%" height="550px" src="${url}" sandbox="allow-top-navigation-by-user-activation allow-same-origin allow-scripts allow-forms allow-pointer-lock"></iframe>
		  <div class="resize-handle"></div>
		</div>
	  `;
	  
	  document.body.appendChild(iframeWindow);
	  iframeWindow.style.top = '50px';
	  iframeWindow.style.left = '50px';
	  iframeWindow.style.display = 'block';

	  // Add animation when opening the window
	  iframeWindow.classList.add('animate-in');

	  // Add drag functionality
	  let isDragging = false;
	  let offsetX, offsetY;

	  iframeWindow.querySelector('.window-header').addEventListener('mousedown', (e) => {
		isDragging = true;
		offsetX = e.clientX - iframeWindow.offsetLeft;
		offsetY = e.clientY - iframeWindow.offsetTop;

		document.addEventListener('mousemove', handleMouseMove);
		document.addEventListener('mouseup', handleMouseUp);
	  });

	  function handleMouseMove(e) {
		if (isDragging) {
		  const newX = e.clientX - offsetX;
		  const newY = e.clientY - offsetY;

		  iframeWindow.style.top = `${newY}px`;
		  iframeWindow.style.left = `${newX}px`;
		}
	  }

	  function handleMouseUp() {
		isDragging = false;
		document.removeEventListener('mousemove', handleMouseMove);
		document.removeEventListener('mouseup', handleMouseUp);
	  }

	  // Add resize functionality
	  let isResizing = false;
	  let startX, startY, startWidth, startHeight;

	  iframeWindow.querySelector('.resize-handle').addEventListener('mousedown', (e) => {
		isResizing = true;
		startX = e.clientX;
		startY = e.clientY;
		startWidth = iframeWindow.offsetWidth;
		startHeight = iframeWindow.offsetHeight;

		document.addEventListener('mousemove', handleResizeMove);
		document.addEventListener('mouseup', handleResizeUp);
	  });

	function handleResizeMove(e) {
		if (isResizing) {
			const newWidth = startWidth + (e.clientX - startX);
			const newHeight = startHeight + (e.clientY - startY);

			iframeWindow.style.width = `${newWidth}px`;
			iframeWindow.style.height = `${newHeight}px`;

			const iframe = iframeWindow.querySelector('#iframe');
			iframe.style.width = `${newWidth -20}px`;
			iframe.style.height = `${newHeight -50}px`;
		}
	}

	  function handleResizeUp() {
		isResizing = false;
		document.removeEventListener('mousemove', handleResizeMove);
		document.removeEventListener('mouseup', handleResizeUp);
	  }	

	  openedWindows.push({
		type: 'App',
		id: uniqueId
	  });
	} else {
		showError('You canceled the iframe')
	}
}

function sandboxapp(url) {
  const usersecureconfirm = confirm('this will open an iframe (wich can possibly be dangerous if its an unsafe webside) if u want to open this iframe click ok (on ur own risk). only use this on trusted websides in the iframe!!')
  if (usersecureconfirm) {
	  const uniqueId = generateUniqueId();
	  const iframeWindow = document.createElement('div');
	  iframeWindow.id = uniqueId;
	  iframeWindow.className = 'windowifra';
	  
	  iframeWindow.innerHTML = `
		<div class="window-header" style="display: flex; justify-content: space-between; align-items: center;">
		  <span>App</span>
		  <div style="display: flex; gap: 5px;">
			<button onclick="toggleFullscreenIframe('${uniqueId}')" style="background:none; border:none; color: #ff5c5c; font-size: 16px;" class="redlightcolor">🗖</button>
			<button onclick="closeiframe('${uniqueId}')" style="background:none; border:none; color: #ff5c5c; font-size: 16px;" class="redlightcolor">X</button>
		  </div>
		</div>
		<div class="window-body">
		  <iframe id="iframe" frameborder="0" width="100%" height="550px" src="${url}" sandbox="allow-top-navigation-by-user-activation allow-scripts allow-forms"></iframe>
		  <div class="resize-handle"></div>
		</div>
	  `;
	  
	  document.body.appendChild(iframeWindow);
	  iframeWindow.style.top = '50px';
	  iframeWindow.style.left = '50px';
	  iframeWindow.style.display = 'block';

	  // Add animation when opening the window
	  iframeWindow.classList.add('animate-in');

	  // Add drag functionality
	  let isDragging = false;
	  let offsetX, offsetY;

	  iframeWindow.querySelector('.window-header').addEventListener('mousedown', (e) => {
		isDragging = true;
		offsetX = e.clientX - iframeWindow.offsetLeft;
		offsetY = e.clientY - iframeWindow.offsetTop;

		document.addEventListener('mousemove', handleMouseMove);
		document.addEventListener('mouseup', handleMouseUp);
	  });

	  function handleMouseMove(e) {
		if (isDragging) {
		  const newX = e.clientX - offsetX;
		  const newY = e.clientY - offsetY;

		  iframeWindow.style.top = `${newY}px`;
		  iframeWindow.style.left = `${newX}px`;
		}
	  }

	  function handleMouseUp() {
		isDragging = false;
		document.removeEventListener('mousemove', handleMouseMove);
		document.removeEventListener('mouseup', handleMouseUp);
	  }

	  // Add resize functionality
	  let isResizing = false;
	  let startX, startY, startWidth, startHeight;

	  iframeWindow.querySelector('.resize-handle').addEventListener('mousedown', (e) => {
		isResizing = true;
		startX = e.clientX;
		startY = e.clientY;
		startWidth = iframeWindow.offsetWidth;
		startHeight = iframeWindow.offsetHeight;

		document.addEventListener('mousemove', handleResizeMove);
		document.addEventListener('mouseup', handleResizeUp);
	  });

	function handleResizeMove(e) {
		if (isResizing) {
			const newWidth = startWidth + (e.clientX - startX);
			const newHeight = startHeight + (e.clientY - startY);

			iframeWindow.style.width = `${newWidth}px`;
			iframeWindow.style.height = `${newHeight}px`;

			const iframe = iframeWindow.querySelector('#iframe');
			iframe.style.width = `${newWidth -20}px`;
			iframe.style.height = `${newHeight -50}px`;
		}
	}


	  function handleResizeUp() {
		isResizing = false;
		document.removeEventListener('mousemove', handleResizeMove);
		document.removeEventListener('mouseup', handleResizeUp);
	  }	

	  openedWindows.push({
		type: 'App',
		id: uniqueId
	  });
	} else {
		showError('You canceled the iframe')
	}
}

//-------error-message------------------------------------------------------------------------------------------

function showError(message) {
	new Audio('error.mp3').play();
    // Prüfen, ob eine Fehlermeldung bereits angezeigt wird
    let existingError = document.querySelector('.error-message');
    if (existingError) {
        existingError.remove();
    }

    // Neues Fehlerdiv erstellen
    let errorDiv = document.createElement('div');
    errorDiv.classList.add('error-message');

    // Fehlermeldungstext
    let messageText = document.createElement('span');
    messageText.textContent = message;
    errorDiv.appendChild(messageText);

    // OK-Button
    let okButton = document.createElement('button');
    okButton.classList.add('ok-button');
    okButton.textContent = 'OK';
    okButton.onclick = () => errorDiv.remove();
    errorDiv.appendChild(okButton);

    // Fehlermeldung ins Dokument einfügen
    document.body.appendChild(errorDiv);
}

//------------------------------------------------------------------------------------------------------//
//------------------------------------------------------------------------------------------------------//
//                                     ---Boot Help---                                                  //
//------------------------------------------------------------------------------------------------------//
//------------------------------------------------------------------------------------------------------//

//-------login-------------------------------------------------------------------------------------------

function waitbeforeBootLogin() {
    setTimeout(bootlogin, 5000);
}

function bootlogin() {
	const islogintrue = localStorage.getItem('settinglogin');
    if (islogintrue === 'True') {
        showLogin();
	} else {
		//nothing
		checkLocalStorageKeys();
    }
}

function showLogin() {
	if (!localStorage.getItem('password')) {
		showError('cant show login screen (no password set)')
	} else {
		document.getElementById('overlay').style.display = 'flex';
	}
}

function handleLogin() {
    const inputPassword = document.getElementById('password').value;
    const storedPassword = localStorage.getItem('password');
    const errorMessage = document.getElementById('login-error');

    if (inputPassword === storedPassword) {
        document.getElementById('overlay').style.display = 'none';
		new Audio('Boot.mp3').play();
		checkLocalStorageKeys();
    } else {
        errorMessage.textContent = 'Incorrect password, please try again.';
    }
}

//-------load-------------------------------------------------------------------------------------------

function loadbackground() {
  const imageFile = localStorage.getItem('FMOSwallpaper');
  const bodyElement = document.querySelector('body');
  const desktopElement = bodyElement.querySelector('.desktop');
  
  if (imageFile) {
    desktopElement.style.backgroundImage = `url('${imageFile}')`;
  } else {
    console.error('No image file found in local storage for key "FMOSwallpaper".');
	desktopElement.style.backgroundImage = `url('back.jpg')`;
  }
}

function checkandshowtos() {
    const TOS = localStorage.getItem('TOS');
    if (TOS === 'true') {
		//nothing
	} else {
		welcomemsg();
    }
}

//-------check-ip-adress-------------------------------------------------------------------------------------------

async function checkIPAddress() {
    const allowedIPs = ['']; // Beispiel IPs in der Liste

    try {
        // Hole die IP-Adresse des Benutzers
        const response = await fetch('https://api.ipify.org/?format=json');
        const data = await response.json();
        const userIP = data.ip;

        // Überprüfe, ob die IP-Adresse in der Liste ist
        if (allowedIPs.includes(userIP)) {
            err001();
        }
    } catch (error) {
        console.error('Fehler beim Abrufen der IP-Adresse:', error);
		showError('An error has occurred.');
    }
}

//------------------------------------------------------------------------------------------------------//
//------------------------------------------------------------------------------------------------------//
//                                     ---Config---                                                     //
//------------------------------------------------------------------------------------------------------//
//------------------------------------------------------------------------------------------------------//

//-------position-icons-and-make-file-editor-better-------------------------------------------------------------------------------------

        let isDragging = false;
        let offsetX, offsetY;

        document.querySelector('.window-header').addEventListener('mousedown', (e) => {
            isDragging = true;
            offsetX = e.clientX - document.getElementById('editorWindow').offsetLeft;
            offsetY = e.clientY - document.getElementById('editorWindow').offsetTop;

            document.addEventListener('mousemove', handleMouseMove);
            document.addEventListener('mouseup', handleMouseUp);
        });

        function handleMouseMove(e) {
            if (isDragging) {
                const newX = e.clientX - offsetX;
                const newY = e.clientY - offsetY;

                const maxX = window.innerWidth - document.getElementById('editorWindow').offsetWidth;
                const maxY = window.innerHeight - document.getElementById('editorWindow').offsetHeight;

                if (newX < 0) {
                    document.getElementById('editorWindow').style.left = '0';
                } else if (newX > maxX) {
                    document.getElementById('editorWindow').style.left = `${maxX}px`;
                } else {
                    document.getElementById('editorWindow').style.left = `${newX}px`;
                }

                if (newY < 0) {
                    document.getElementById('editorWindow').style.top = '0';
                } else if (newY > maxY) {
                    document.getElementById('editorWindow').style.top = `${maxY}px`;
                } else {
                    document.getElementById('editorWindow').style.top = `${newY}px`;
                }
            }
        }

        function handleMouseUp() {
            isDragging = false;
            document.removeEventListener('mousemove', handleMouseMove);
            document.removeEventListener('mouseup', handleMouseUp);
        }

let currentDraggedElement = null;
let draggedFileName = null;

document.querySelector('.desktop').addEventListener('mousedown', (e) => {
    if (e.target.classList.contains('icon')) {
        currentDraggedElement = e.target;
        draggedFileName = e.target.dataset.file;
        e.target.classList.add('dragging');
    }
});

document.querySelector('.desktop').addEventListener('mousemove', (e) => {
    if (currentDraggedElement) {
        const newX = e.clientX - currentDraggedElement.offsetWidth / 2;
        const newY = e.clientY - currentDraggedElement.offsetHeight / 2;

        const maxX = window.innerWidth - currentDraggedElement.offsetWidth;
        const maxY = window.innerHeight - currentDraggedElement.offsetHeight;

        currentDraggedElement.style.left = Math.min(Math.max(newX, 0), maxX) + 'px';
        currentDraggedElement.style.top = Math.min(Math.max(newY, 0), maxY) + 'px';
    }
});

document.querySelector('.desktop').addEventListener('mouseup', (e) => {
    if (currentDraggedElement) {
        const iconsContainer = document.getElementById('iconsContainer');
        const isVisible = iconsContainer.offsetWidth > 0 && iconsContainer.offsetHeight > 0;
        const iconsContainerRect = iconsContainer.getBoundingClientRect();


        if (isVisible &&
            e.clientX > iconsContainerRect.left &&
            e.clientX < iconsContainerRect.right &&
            e.clientY > iconsContainerRect.top &&
            e.clientY < iconsContainerRect.bottom) {
            
			if(draggedFileName.endsWith('.folder')) {
				showError('you cant move folders')
			} else {
			
				if (!filesystem.hasOwnProperty(foldermgrfilespath)) {
					showError('Sorry, this path does not exist. Tipp: Sometimes you have to input the path again and click enter. or the path realy does not exist');
					currentDraggedElement.classList.remove('dragging');
					currentDraggedElement = null;
					draggedFileName = null;
					return;
				}
				
				if (foldermgrfiles.hasOwnProperty(draggedFileName)) {
					const overwrite = confirm(`The File "${draggedFileName}" already exists. Do you want to overwrite it?`);
					if (!overwrite) {
						currentDraggedElement.classList.remove('dragging');
						currentDraggedElement = null;
						draggedFileName = null;
						return;
					}
				}
				
				// Assuming foldermgrfiles is defined globally and you want to update it
				foldermgrfiles[draggedFileName] = files[draggedFileName];
				filesetData(foldermgrfilespath, JSON.stringify(foldermgrfiles));
				loadFiles(foldermgrfilespath.replace('FMOSfolder', ''));
				delete files[draggedFileName];
				renderFiles();
				connectdesktops('2')
			}
		}
        currentDraggedElement.classList.remove('dragging');
        currentDraggedElement = null;
        draggedFileName = null;
    }
});


        function positionIcons() {
            const icons = document.querySelectorAll('.icon');
            const desktopWidth = document.getElementById('desktop').offsetWidth;
            const iconWidth = icons[0].offsetWidth;
            const iconHeight = icons[0].offsetHeight;
            let x = 10;
            let y = 10;

            icons.forEach((icon) => {
                icon.style.left = `${x}px`;
                icon.style.top = `${y}px`;
                x += iconWidth + 10;
                if (x > desktopWidth - iconWidth - 10) {
                    x = 10;
                    y += iconHeight + 10;
                }
            });
        }
		
const desktop = document.getElementById('desktop');
let selection = null;
let startX = 0;
let startY = 0;

// Define color and border properties
const borderWidth = '2px'; // Border width

desktop.addEventListener('mousedown', (event) => {
  if (event.button !== 0) return; // only handle left mouse button
  startX = event.clientX;
  startY = event.clientY;
  selection = document.createElement('div');
  selection.className = 'selected';
  selection.style.position = 'absolute'; // Ensure positioning is absolute
  selection.style.left = `${startX}px`;
  selection.style.top = `${startY}px`;
  selection.style.width = '0px';
  selection.style.height = '0px';
  selection.style.borderWidth = borderWidth;
  desktop.appendChild(selection);
});

document.addEventListener('mousemove', (event) => {
  if (event.buttons !== 1) return; // only handle mouse move while left mouse button is pressed
  if (!selection) return; // nothing to select
  const x = event.clientX;
  const y = event.clientY;
  const width = Math.abs(x - startX);
  const height = Math.abs(y - startY);
  const left = Math.min(x, startX);
  const top = Math.min(y, startY);
  selection.style.left = `${left}px`;
  selection.style.top = `${top}px`;
  selection.style.width = `${width}px`;
  selection.style.height = `${height}px`;

  // Check if the selection intersects with any file
  const files = document.querySelectorAll('.file');
  files.forEach((file) => {
    const fileLeft = file.offsetLeft;
    const fileTop = file.offsetTop;
    const fileWidth = file.offsetWidth;
    const fileHeight = file.offsetHeight;

    if (
      left < fileLeft + fileWidth &&
      top < fileTop + fileHeight &&
      left + width > fileLeft &&
      top + height > fileTop
    ) {
      // If the selection intersects with the file, add the 'selected' class to it
      file.classList.add('selected');
    } else {
      // Otherwise, remove the 'selected' class from the file
      file.classList.remove('selected');
    }
  });
});

document.addEventListener('mouseup', (event) => {
  if (event.button !== 0) return; // only handle left mouse button
  if (!selection) return; // nothing to select

  // Remove the selection element from the DOM
  selection.remove();
  selection = null; // Clear the selection reference
});

//------------------------------------------------------------------------------------------------------//
//------------------------------------------------------------------------------------------------------//
//                                     ---Extras---                                                     //
//------------------------------------------------------------------------------------------------------//
//------------------------------------------------------------------------------------------------------//

function downloadAllFiles() {
  for (const file in files) {
    const fileContent = files[file];
    const fileType = getFileType(file);
    const blob = new Blob([fileContent], { type: fileType.mime });
    const url = URL.createObjectURL(blob);
    const a = document.createElement('a');
    a.href = url;
    a.download = file;
    a.click();
    URL.revokeObjectURL(url);
  }
}

function getFileType(fileName) {
  const fileExtensions = {
    '.js': { mime: 'application/javascript' },
    '.fexe': { mime: 'application/octet-stream' },
    '.fsys': { mime: 'application/octet-stream' },
	'.fak': { mime: 'application/html' },
    '.py': { mime: 'text/x-python' },
    '.zfp': { mime: 'application/zip' },
    '.html': { mime: 'text/html' },
    '.url': { mime: 'text/html' },
  };
  const fileExtension = Object.keys(fileExtensions).find((ext) => fileName.endsWith(ext));
  return fileExtensions[fileExtension];
}

function openDiscordLink() {
        const url = 'https://discord.gg/XnPCx68ZN3';
        window.open(url, '_blank');
    }
		
		function restartOS() {
			window.location.href = "https://fabischau1.github.io/FMOS";
		}
		
		function err003() {
			window.location.href = "https://fabischau1.github.io/FMOS/error003";
		}
		
		function DVD() {
			window.location.href = "https://fabischau1.github.io/FMOS/dvd";
		}
		
		function energiesavemode() {
			window.location.href = "https://fabischau1.github.io/FMOS/engr";
		}
		
		function BSOD() {
			window.location.href = "https://fabischau1.github.io/BSOD";
		}
		
		function kill() {
			window.location.href = "https://fabischau1.github.io/BSOD";
		}
		
		function err001() {
			window.location.href = "https://fabischau1.github.io/FMOS/Err001";
		}
		
		function err002() {
			window.location.href = "https://fabischau1.github.io/FMOS/Err002";
		}
		
		function oops() {
			window.location.href = "https://fabischau1.github.io/oops";
		}
		
		function malwareScan() {
		  alert('this is not an actual malware scan!!!')
          let safeFiles = [];
          let malwareFiles = [];
          for (let file in files) {
            if (file !== "FA_AntiVira.py") {
              let fileContent = files[file];
              if (fileContent.includes("document.documentElement.innerHTML = newHtml;") ||
                  fileContent.includes("let fileName = Math.random().toString(36).substr(2, 8);")) {
                malwareFiles.push(file);
                console.log(`Malware detected in file: ${file}`);
				alert(`Malware detected in file: ${file}`);
              } else {
                safeFiles.push(file);
                console.log(`File is safe: ${file}`);
				alert(`File is safe: ${file}`);
              }
            }
          }
          console.log(`Scan complete!`);
          console.log(`Safe files: ${safeFiles.join(", ")}`);
          console.log(`Malware files: ${malwareFiles.join(", ")}`);
		  alert(`Scan complete!`);
          alert(`Safe files: ${safeFiles.join(", ")}`);
          alert(`Malware files: ${malwareFiles.join(", ")}`);

          alert(`Stay safe with FA AntiVira`);
        }

function uploadFile() {
  const input = document.createElement('input');
  input.type = 'file';
  input.onchange = (e) => {
    const file = e.target.files[0];
    if (!file) return;

    // Warnung, wenn die Datei ein Bild ist
    if (file.type.startsWith('image/')) {
      showError('WARNING: Images can get quite big');
    }

    // Überprüfe die Dateigröße
    const maxFileSize = 1 * 1024 * 1024; // 1 MB
    if (file.size > maxFileSize) {
      showError('ERROR: Files must be smaller than 1 MB');
      return;
    }

    const reader = new FileReader();
    reader.onload = (e) => {
      const fileContent = e.target.result;
      const fileName = file.name;

      // Datei speichern, Bild- und Nicht-Bild-Dateien gleichermaßen unterstützen
      files[fileName] = fileContent;
      renderFiles();

      // Zeige eine Vorschau für Bilddateien
      if (file.type.startsWith('image/')) {
        const img = document.createElement('img');
        img.src = fileContent; // Base64-String
        img.style.maxWidth = '100px'; // Begrenze die Größe der Vorschau
        document.body.appendChild(img); // Füge das Bild zum DOM hinzu
      }
    };

    // Bilddateien als DataURL lesen, um Vorschau zu ermöglichen
    if (file.type.startsWith('image/')) {
      reader.readAsDataURL(file);
    } else {
      // Text oder andere Dateitypen als Text lesen
      reader.readAsText(file);
    }
  };
  input.click();
}

//------------------------------------------------------------------------------------------------------//
//------------------------------------------------------------------------------------------------------//
//                                     ---Reset And Restart OS---                                       //
//------------------------------------------------------------------------------------------------------//
//------------------------------------------------------------------------------------------------------//

function sysfactoriereset() {
	alert("WARNING")
	alert("THIS WILL DELETE ALL PERMANENTLY SAVED FILES")
	alert("WARNING")
	alert("THIS WILL DELETE THE PASSWORD")
	const userConfirmed = confirm("Do You Realy Want To Delete The Password And Files From FMOS?");
    
    // Überprüfen, welche Taste der Benutzer gedrückt hat
    if (userConfirmed) {
        localStorage.removeItem('password');
		localStorage.removeItem('files');
		deleteAllFMOSdesktopItems();
		localStorage.clear();
		filesclearAllData();
    } else {
		showError('Action Canceled.');
    }
}

function askToRestartOS() {
    const userResponse = confirm("Do you want to restart the operating system?");
    if (userResponse) {
        location.reload();
    } else {
		showError('OS restart canceled.');
    }
}



//------------------------------------------------------------------------------------------------------//
//------------------------------------------------------------------------------------------------------//
//                                     ---Auto Boot---                                                  //
//------------------------------------------------------------------------------------------------------//
//------------------------------------------------------------------------------------------------------//

function setboot(bootexecutioncode, bootkeyname) {
	let name = "FMOSboot" + "/" + bootkeyname;
	localStorage.setItem('FMOSboot', bootexecutioncode);
}

function checkLocalStorageKeys() {
	const bootskSetting = localStorage.getItem('settingbootsk') === 'True';
	if (bootskSetting) {
		const bootFilesJSON = filesystem["FMOSfolder/boot"];
		const bootFiles = JSON.parse(bootFilesJSON);

		const scriptKeys = Object.keys(bootFiles).filter(key => 
			key.endsWith('.js') || key.endsWith('.fexe') || key.endsWith('.fsys')
		);

		if (scriptKeys.length > 0) {
			const userResponse = confirm(`Found ${scriptKeys.length} script files. Execute content?`);

			if (userResponse) {
				scriptKeys.forEach(key => {
					const value = bootFiles[key];
					try {
						eval(value);
					} catch (error) {
						console.error(`Error executing ${key}:`, error);
					}
				});
			} else {
				const removeResponse = confirm('Do you want to remove the found keys?');
				if (removeResponse) {
					folderdeleteData('FMOSfolder/boot')
					askToRestartOS();
				}
			}
		} else {
			console.log('No script files found.');
		}
	} else {
		// do nothing
	}
}


//------------------------------------------------------------------------------------------------------//
//------------------------------------------------------------------------------------------------------//
//                                     ---Settings---                                                   //
//------------------------------------------------------------------------------------------------------//
//------------------------------------------------------------------------------------------------------//

//-------settings-settings-----------------------------------------------------------------------------------------

function settingcheck() {
    const settingValue = localStorage.getItem('settingsettingwinold');

    if (settingValue === 'False') {
        openMenu();
    } else if (settingValue === 'True') {
        syssettings();
    } else {
        showError('invalid reg local storrige key (deleting the key and restarting the system may help or resetting the system)'); // Wenn der Wert nicht vorhanden ist
    }
}

function enablesettingwinold() {
    localStorage.setItem('settingsettingwinold', 'True');
	showError('Old Setting Menu Is Now Enabled')
}

function disablesettingwinold() {
    localStorage.setItem('settingsettingwinold', 'False');
	showError('Old Setting Menu Is Now Disabled')
}

//-------file-names------------------------------------------------------------------------------------------

function enableFileNames() {
    localStorage.setItem('fmosfilenamessetting', 'true');
    renderFiles();
}
function disableFileNames() {
    localStorage.setItem('fmosfilenamessetting', 'false');
    renderFiles();
}

//-------administrator-for-certan-scripts---------------------------------------------------------------------------------------

function disableadminscripts() {
	const enteredPassword = prompt("Password:");

    const storedPassword = localStorage.getItem('password');

    if (enteredPassword === storedPassword) {
		alert("this disables a security function")
		const adminiddddkkkk = confirm("Do you realy want to disable this function?");
		if (adminiddddkkkk) {
			localStorage.setItem('settingadmin', 'False');
		} else {
			showError('Settings Have Not Changed.');
		}
	} else {
		showError('Settings Have Not Changed. Password incorrect. Please Set A Password over Settings or Reset The System over Settings.');
	}
}

function enableadminscripts() {
	localStorage.setItem('settingadmin', 'True');
	showError('Admin Scripts Are Now Enabled (Recomended)')
}

//-------boot-animation-----------------------------------------------------------------------------------------

function setFullScreenIframeKeyTrue() {
    localStorage.setItem('showFullScreenIframe', 'true');
	askToRestartOS();
}

function setFullScreenIframeKeyFalse() {
    localStorage.setItem('showFullScreenIframe', 'false');
	askToRestartOS();
}

function bootanimation2() {
    localStorage.setItem('showFullScreenIframe', 'boot2');
	askToRestartOS();
}

//-------login-settings-----------------------------------------------------------------------------------------

function enablelogin() {
	if (!localStorage.getItem('password')) {
		showError('please set a password first')
		passwordmgr()
	} else {
		localStorage.setItem('settinglogin', 'True');
		showError('Login Screen Is Now Enabled')
		askToRestartOS();
	}
}

function disablelogin() {
	localStorage.setItem('settinglogin', 'False');
	showError('Login Is Now Disabled')
	askToRestartOS();
}

//-------boot-scripts------------------------------------------------------------------------------------------

function enablebootsk() {
    localStorage.setItem('settingbootsk', 'True');
}

function disablebootsk() {
    localStorage.setItem('settingbootsk', 'False');
}

//-------desktop-wallpaper-and-editor-settings-and-terminal-settings----------------------------------------------------------------------------------


function updateTextColorEditor() {
    var elements = document.querySelectorAll('.textcoloreditor');
    
    elements.forEach(function(element) {
        element.style.color = 'black';
        element.style.backgroundColor = 'white';
        element.style.textShadow = 'none';
    });
}

function updateTextColorEditordef() {
    var elements = document.querySelectorAll('.textcoloreditor');
    
    elements.forEach(function(element) {
        element.style.color = '#00000f';
        element.style.backgroundColor = 'rgba(20, 20, 20, 0.7)';
        element.style.textShadow = '0 0 1px #0000ff, 0 0 2.5px #0000ff, 0 0 5px #0000ff, 0 0 5px #0000ff, 0 0 8px #0000ff, 0 0 10px #0000ff';
    });
}

function changeDesktopBackground() {
  const bodyElement = document.querySelector('body');
  const desktopElement = bodyElement.querySelector('.desktop');
  desktopElement.style.backgroundImage = "url('back.jpg')";
  localStorage.setItem('FMOSwallpaper', 'back.jpg');
  wallpaper_off();
}

function changeDesktopBackground2() {
  const bodyElement = document.querySelector('body');
  const desktopElement = bodyElement.querySelector('.desktop');
  desktopElement.style.backgroundImage = "url('123.jpg')";
  localStorage.setItem('FMOSwallpaper', '123.jpg');
  wallpaper_off();
}

function changeDesktopBackground3() {
  const bodyElement = document.querySelector('body');
  const desktopElement = bodyElement.querySelector('.desktop');
  desktopElement.style.backgroundImage = "url('flower.jpg')";
  localStorage.setItem('FMOSwallpaper', 'flower.jpg');
  wallpaper_off();
}

function changeDesktopBackground4() {
  const bodyElement = document.querySelector('body');
  const desktopElement = bodyElement.querySelector('.desktop');
  desktopElement.style.backgroundImage = "url('lightning.jpg')";
  localStorage.setItem('FMOSwallpaper', 'lightning.jpg');
  wallpaper_off();
}

function changeDesktopBackground6() {
  const bodyElement = document.querySelector('body');
  const desktopElement = bodyElement.querySelector('.desktop');
  desktopElement.style.backgroundImage = "url('abstract.webp')";
  localStorage.setItem('FMOSwallpaper', 'abstract.webp');
  wallpaper_off();
}

function changeDesktopBackgroundcu29294() {
  const bodyElement = document.querySelector('body');
  const desktopElement = bodyElement.querySelector('.desktop');
  desktopElement.style.backgroundImage = "url('custom.jpg')";
  localStorage.setItem('FMOSwallpaper', 'custom.jpg');
  wallpaper_off();
}

function changeDesktopBackground30() {
  const bodyElement = document.querySelector('body');
  const desktopElement = bodyElement.querySelector('.desktop');
  desktopElement.style.backgroundImage = "url('col.jpg')";
  localStorage.setItem('FMOSwallpaper', 'col.jpg');
  wallpaper_off();
}

function changeDesktopBackground40() {
  const bodyElement = document.querySelector('body');
  const desktopElement = bodyElement.querySelector('.desktop');
  desktopElement.style.backgroundImage = "url('fmoss.png')";
  localStorage.setItem('FMOSwallpaper', 'fmoss.jpg');
  wallpaper_off();
}

function changeDesktopBackgrounddarkfmos() {
  const bodyElement = document.querySelector('body');
  const desktopElement = bodyElement.querySelector('.desktop');
  desktopElement.style.backgroundImage = "url('Dark.jpeg')";
  localStorage.setItem('FMOSwallpaper', 'Dark.jpeg');
  wallpaper_off();
}

function changeDesktopBackground5() {
  const userInput = prompt("Enter a custom image URL:");
  if (userInput) {
	localStorage.setItem('FMOSwallpaper', userInput);
    const bodyElement = document.querySelector('body');
    const desktopElement = bodyElement.querySelector('.desktop');
    desktopElement.style.backgroundImage = `url('${userInput}')`;
	wallpaper_off();
  }
}

function wallpaper(imageFile) {
  const bodyElement = document.querySelector('body');
  const desktopElement = bodyElement.querySelector('.desktop');
  desktopElement.style.backgroundImage = `url('${imageFile}')`;
  wallpaper_off();
}

function changeTerminalBackground() {
  // Prompt the user for the URL of a background image
  const imageUrl = prompt("Enter the URL of a background image:");

  // Check if the user entered a valid URL
  if (imageUrl) {
    // Update the CSS style for .terminal-window
    const styleElement = document.createElement("style");
    styleElement.innerHTML = `.terminal-window { background-image: url(${imageUrl}); }`;
    document.head.appendChild(styleElement);
  } else {
    alert("Invalid URL. Please enter the URL of a valid image file.");
  }
}

function thememodern() {
	changeDesktopBackgroundcu29294();
	setCompactFuturisticTaskbarStyle();
}

function changeTerminalBackground() {
  // Prompt the user for the URL of a background image
  const imageUrl = prompt("Enter the URL of a background image:");

  // Check if the user entered a valid URL
  if (imageUrl) {
    // Update the CSS style for .terminal-window
    const styleElement = document.createElement("style");
    styleElement.innerHTML = `.terminal-window { background-image: url(${imageUrl}); }`;
    document.head.appendChild(styleElement);
  } else {
    alert("Invalid URL. Please enter the URL of a valid image file.");
  }
}

function setCompactFuturisticTaskbarStyle() {
    const taskbar = document.querySelector('.taskbar');
    
    if (taskbar) {
        taskbar.style.background = 'linear-gradient(135deg, rgba(46, 46, 46, 0.9), rgba(30, 30, 30, 0.9))';
        taskbar.style.color = '#e0e0e0';
        taskbar.style.height = '40px';
        taskbar.style.position = 'fixed';
        taskbar.style.bottom = '15px';
        taskbar.style.width = 'calc(100% - 30px)';
        taskbar.style.borderRadius = '20px';
        taskbar.style.boxShadow = '0 4px 12px rgba(0, 0, 0, 0.3)';
        taskbar.style.padding = '0 15px';
        taskbar.style.display = 'flex';
        taskbar.style.alignItems = 'center';
        taskbar.style.justifyContent = 'space-between';
        taskbar.style.borderTop = 'none';
        taskbar.style.transition = 'all 0.3s ease-in-out';
    } else {
        console.error('Taskbar-Element wurde nicht gefunden.');
    }
}

function getAndSetTaskbarBackgroundColor() {
  const taskbar = document.querySelector('.taskbar');
  const color = prompt("Enter a color (e.g. #FF0000, red, rgba(255, 0, 0, 0.5)): ");
  if (color) {
    taskbar.style.backgroundColor = color;
  } else {
    alert("No color entered. Current color: " + taskbar.style.backgroundColor);
  }
}

function resetTaskbarBackgroundColor() {
  const taskbar = document.querySelector('.taskbar');
  taskbar.style.backgroundColor = '#333';
}

//------------------------------------------------------------------------------------------------------//
//------------------------------------------------------------------------------------------------------//
//                                     ---Themes---                                                     //
//------------------------------------------------------------------------------------------------------//
//------------------------------------------------------------------------------------------------------//

//-------themes-----------------------------------------------------------------------------------------

function applyGamingTheme() {
    const style = document.createElement('style');
    style.innerHTML = `.window-header {
            background-color: rgba(0, 0, 0, 0.8);
            color: #00ff00;
            text-shadow: 0 0 10px #00ff00, 0 0 20px #00ff00, 0 0 30px #00ff00;
            padding: 10px;
            cursor: move;
            display: flex;
            justify-content: space-between;
            align-items: center;
            border-bottom: 2px solid #00ff00;
        }
        .window-body {
            flex: 1;
            padding: 15px;
            background: linear-gradient(135deg, rgba(50, 50, 50, 0.9), rgba(30, 30, 30, 0.9));
            border-radius: 8px;
        }
        .window-footer {
            padding: 10px;
            text-align: right;
            background-color: rgba(10, 10, 10, 0.5);
        }
        .icon span {
            position: absolute;
            bottom: 0;
            left: 50%;
            transform: translateX(-50%);
            text-align: center;
            color: #00ffcc;
        }
		.error-message {
			background: rgba(20, 20, 20, 0.95);
			color: #39ff14; /* Neon-grün für die Schrift */
			padding: 40px;
			border-radius: 14px;
			text-shadow: 0 0 10px #39ff14; /* Neon-Schattierung für Text */
			box-shadow: 0 12px 28px rgba(0, 0, 0, 0.8);
			animation: fadeInError 0.5s ease, shakeError 0.3s ease 0.2s;
			transform: translate(-50%, -50%);
		}

		@keyframes fadeInError {
			from { opacity: 0; transform: translate(-50%, -60%) scale(0.8); }
			to { opacity: 1; transform: translate(-50%, -50%) scale(1); }
		}

		@keyframes shakeError {
			0%, 100% { transform: translate(-50%, -50%) rotate(-2deg); }
			50% { transform: translate(-50%, -50%) rotate(2deg); }
		}

		.error-message .ok-button {
			background: rgba(20, 20, 20, 0.95);
			border-radius: 4px;
			color: #39ff14; /* Neon-grün für Button-Text */
			padding: 10px 25px;
			transition: background 0.4s, color 0.4s, transform 0.2s ease;
			box-shadow: 0 0 8px #39ff14; /* Neon-Schattierung für Button */
		}

		.error-message .ok-button:hover {
			background: rgba(57, 255, 20, 0.8); /* Helleres Neon-Grün beim Hover */
			color: #ffffff;
			transform: translateY(-3px);
			box-shadow: 0 0 12px #39ff14, 0 0 20px #39ff14; /* Verstärkter Leuchteffekt */
		}
        @keyframes zoomIn {
            from {
                opacity: 0;
                transform: scale(0);
            }
            to {
                opacity: 1;
                transform: scale(1);
            }
        }
        .selected {
            border: 3px solid #00cc00;
            background-color: rgba(0, 204, 0, 0.3);
        }
        .file-label {
            font-size: 14px;
            color: #00cc00;
            text-align: center;
            text-shadow: 0 0 5px #00cc00;
        }
        .context-menu {
            background: rgba(40, 40, 40, 0.9);
            border-radius: 12px;
            animation: slideIn 0.3s ease;
        }
        .context-menu ul li {
            padding: 10px 15px;
            background: rgba(40, 40, 40, 0.7);
            transition: background 0.3s, color 0.3s, transform 0.3s;
        }
        .context-menu ul li:hover {
            background: rgba(50, 50, 50, 0.9);
            color: #00ffcc;
            text-shadow: 0 0 10px #00ffcc;
            transform: scale(1.05);
        }
        .context-menu ul li:active {
            transform: scale(0.95);
            background: rgba(70, 70, 70, 0.9);
        }
        @keyframes slideIn {
            from {
                transform: translateY(-20px);
                opacity: 0;
            }
            to {
                transform: translateY(0);
                opacity: 1;
            }
        }
        .taskbar {
            background: linear-gradient(135deg, rgba(46, 46, 46, 0.9), rgba(30, 30, 30, 0.9));
            color: #e0e0e0;
            height: 40px;
            position: fixed;
            bottom: 15px;
            width: calc(100% - 30px);
            border-radius: 20px;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.3);
            padding: 0 15px;
            display: flex;
            align-items: center;
            justify-content: space-between;
            border-top: none;
            transition: all 0.3s ease-in-out;
        }
        .taskbar-button {
            color: #d1d1d1;
            transition: color 0.3s, background-color 0.3s, transform 0.2s;
            position: relative;
            overflow: hidden;
        }
        .taskbar-button:hover {
            color: #00cc00;
            background-color: rgba(0, 204, 0, 0.1);
        }
        .taskbar-button:active {
            transform: scale(0.9);
            color: #00ff00;
            box-shadow: 0 0 15px #00cc00, inset 0 0 5px #00cc00;
        }
        .icon {
            display: inline-flex;
            align-items: center;
            justify-content: center;
            width: 100px;
            height: 100px;
            background-color: rgba(255, 255, 255, 0.1);
            margin: 10px;
            font-size: 20px;
            cursor: pointer;
            user-select: none;
            transition: transform 0.5s ease, box-shadow 0.5s ease;
            background-size: cover;
            background-position: center;
            border-radius: 15px;
        }
        .icon:hover {
            transform: scale(1.1) rotate(2deg);
            box-shadow: 0 8px 16px rgba(0, 0, 0, 0.4);
        }
        .icon:active {
            transform: scale(0.95) rotate(-2deg);
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2);
        }
		.modal-overlay {
            background: rgba(0, 0, 0, 0.8);
            backdrop-filter: blur(15px);
        }
        .login-box {
            background: rgba(30, 30, 30, 0.8);
            box-shadow: 0 0 50px rgba(0, 255, 0, 0.5);
            border-radius: 12px;
        }
        .title {
            color: #00ff00;
            margin-bottom: 20px;
            font-size: 28px;
            text-shadow: 0 0 10px rgba(0, 255, 0, 1);
        }
        .password-input {
            background: rgba(255, 255, 255, 0.1);
            color: #ffffff;
            transition: background 0.3s, box-shadow 0.3s;
        }
        .password-input:focus {
            background: rgba(255, 255, 255, 0.2);
            box-shadow: 0 0 10px rgba(0, 255, 0, 0.7);
        }
        .login-button {
            background: linear-gradient(90deg, #00aaff, #0056b3);
            transition: background 0.4s, transform 0.2s, box-shadow 0.3s;
        }
        .login-button:hover {
            background: linear-gradient(90deg, #0056b3, #003d80);
            transform: translateY(-3px);
            box-shadow: 0 5px 15px rgba(0, 170, 255, 0.5);
        }
        .login-error {
            color: #ff4d4d;
            margin-top: 10px;
            animation: shake 0.5s;
        }
        @keyframes shake {
            0% { transform: translateX(0); }
            25% { transform: translateX(-5px); }
            50% { transform: translateX(5px); }
            75% { transform: translateX(-5px); }
            100% { transform: translateX(0); }
        }
		.settingsmain-menu {
			background: rgba(20, 20, 20, 0.9);
			border: 1px solid rgba(0, 255, 0, 0.3);
			box-shadow: 0 0 40px rgba(0, 255, 0, 0.5);
			transition: all 0.2s ease; /* Schneller */
			border-radius: 10px;
			animation: fadeIn 0.3s; /* Schneller */
		}

		@keyframes fadeIn {
			from { opacity: 0; transform: translateY(-10px); }
			to { opacity: 1; transform: translateY(0); }
		}

		.settingsmain-header {
			border-bottom: 2px solid rgba(0, 255, 0, 0.1);
			padding-bottom: 10px;
			margin-bottom: 20px;
			color: #e0e0e0;
		}

		.settingsmain-controls button {
			color: #ffffff;
			transition: transform 0.2s, color 0.2s; /* Schneller */
		}

		.settingsmain-controls button:hover {
			transform: scale(1.2);
			color: #00bfff;
		}

		.settingsmain-content {
			color: #d0d0d0;
			transition: color 0.2s; /* Schneller */
		}

		.settingsmain-option {
			padding: 10px;
			margin: 5px 0;
			background: rgba(60, 60, 60, 0.5);
			border-radius: 6px;
			transition: background 0.2s, transform 0.1s; /* Schneller */
		}

		.settingsmain-option:hover {
			background: rgba(80, 80, 80, 0.7);
			transform: translateY(-2px);
		}

		.settingsmain-option label {
			font-size: 18px;
			transition: color 0.2s; /* Schneller */
		}

		.settingsmain-option input {
			transform: scale(1.6);
			cursor: pointer;
			transition: transform 0.2s; /* Schneller */
		}

		.settingsmain-option input:hover {
			transform: scale(1.8);
		}

		.settingsmain-resize {
			background: rgba(255, 255, 255, 0.3);
		}

		.settingsmain-butten {
			background: linear-gradient(145deg, #444, #555);
			color: #f0f0f0;
			transition: background 0.2s, transform 0.2s, box-shadow 0.2s; /* Schneller */
		}

		.settingsmain-butten:hover {
			background: linear-gradient(145deg, #555, #666);
			transform: scale(1.05);
			box-shadow: 0 4px 20px rgba(255, 255, 255, 0.2);
		}

		.settingsmain-butten:focus {
			box-shadow: 0 0 0 2px rgba(0, 170, 255, 0.8);
			background: linear-gradient(145deg, #444, #555);
		}
		.resize-handle {
            position: absolute;
            bottom: -20px;
            right: 0;
            width: 20px;
            height: 20px;
            background-color: #1e1e1e;
            border-radius: 5px;
            cursor: se-resize;
            transition: transform 0.3s ease, background-color 0.3s ease, box-shadow 0.3s ease;
            box-shadow: 0 0 8px rgba(0, 255, 0, 0.7);
        }
        .resize-handle:hover {
            background-color: #2a2a2a;
            transform: scale(1.1) rotate(45deg);
        }
        .resize-handle:active {
            background-color: #444;
            transform: scale(1.2);
            box-shadow: 0 0 15px rgba(0, 255, 0, 0.8);
        }
        #selection-window {
            position: absolute;
            bottom: 20px;
            left: 50%;
            transform: translateX(-50%);
            background: rgba(20, 20, 20, 0.9);
            border: 2px solid rgba(0, 255, 0, 0.5);
            border-radius: 12px;
            box-shadow: 0 6px 12px rgba(0, 0, 0, 0.4), 0 0 20px rgba(0, 255, 0, 0.5);
            display: none;
            padding: 10px;
            box-sizing: border-box;
            width: 200px;  /* Beibehalten der ursprünglichen Größe */
            backdrop-filter: blur(10px);
            opacity: 0;
            transform: translateY(10px);
            transition: opacity 0.4s ease, transform 0.4s ease;
        }
        #selection-window.active {
            display: block;
            opacity: 1;
            transform: translateY(0);
        }
        #selection-window button {
            background: linear-gradient(145deg, #444, #555);
            border: none;
            color: #00ff00;
            padding: 8px 12px; /* Beibehalten der ursprünglichen Größe */
            margin-bottom: 5px;
            border-radius: 8px;
            cursor: pointer;
            font-size: 14px;  /* Beibehalten der ursprünglichen Größe */
            transition: background 0.3s, transform 0.2s, box-shadow 0.2s;
            width: 100%;
            position: relative; /* Für zusätzliche Animation */
            overflow: hidden; /* Um Überlauf zu verhindern */
        }
        #selection-window button:hover {
            background: linear-gradient(145deg, #555, #666);
            transform: scale(1.05) translateY(-2px);
            box-shadow: 0 4px 10px rgba(0, 255, 0, 0.6);
        }
        #selection-window button:focus {
            outline: none;
            box-shadow: 0 0 0 2px rgba(0, 255, 255, 0.6);
            background: linear-gradient(145deg, #444, #555);
        }
        @keyframes buttonClick {
            0% { transform: scale(1); }
            50% { transform: scale(0.95); }
            100% { transform: scale(1); }
        }
        #selection-window button:active {
            animation: buttonClick 0.2s ease;
        }

        /* Ähnliche Anpassungen für die anderen Fenster */
        #folsel-window {
            position: absolute;
            bottom: 20px;
            left: 60%;
            transform: translateX(-50%);
            background: rgba(20, 20, 20, 0.9);
            border: 2px solid rgba(0, 255, 0, 0.5);
            border-radius: 12px;
            box-shadow: 0 6px 12px rgba(0, 0, 0, 0.4), 0 0 20px rgba(0, 255, 0, 0.5);
            display: none;
            padding: 10px;
            box-sizing: border-box;
            width: 200px; /* Beibehalten der ursprünglichen Größe */
            backdrop-filter: blur(10px);
            opacity: 0;
            transform: translateY(10px);
            transition: opacity 0.4s ease, transform 0.4s ease;
        }
        #folsel-window.active {
            display: block;
            opacity: 1;
            transform: translateY(0);
        }
        #folsel-window button {
            background: linear-gradient(145deg, #444, #555);
            border: none;
            color: #00ff00;
            padding: 8px 12px; /* Beibehalten der ursprünglichen Größe */
            margin-bottom: 5px;
            border-radius: 8px;
            cursor: pointer;
            font-size: 14px;  /* Beibehalten der ursprünglichen Größe */
            transition: background 0.3s, transform 0.2s, box-shadow 0.2s;
            width: 100%;
            position: relative;
            overflow: hidden;
        }
        #folsel-window button:hover {
            background: linear-gradient(145deg, #555, #666);
            transform: scale(1.05) translateY(-2px);
            box-shadow: 0 4px 10px rgba(0, 255, 0, 0.6);
        }
        #folsel-window button:active {
            animation: buttonClick 0.2s ease;
        }

        #sysset-window {
            position: absolute;
            bottom: 20px;
            left: 70%;
            transform: translateX(-50%);
            background: rgba(20, 20, 20, 0.9);
            border: 2px solid rgba(0, 255, 0, 0.5);
            border-radius: 12px;
            box-shadow: 0 6px 12px rgba(0, 0, 0, 0.4), 0 0 20px rgba(0, 255, 0, 0.5);
            display: none;
            padding: 10px;
            box-sizing: border-box;
            width: 200px; /* Beibehalten der ursprünglichen Größe */
            backdrop-filter: blur(10px);
            opacity: 0;
            transform: translateY(10px);
            transition: opacity 0.4s ease, transform 0.4s ease;
        }
        #sysset-window.active {
            display: block;
            opacity: 1;
            transform: translateY(0);
        }
        #sysset-window button {
            background: linear-gradient(145deg, #444, #555);
            border: none;
            color: #00ff00;
            padding: 8px 12px; /* Beibehalten der ursprünglichen Größe */
            margin-bottom: 5px;
            border-radius: 8px;
            cursor: pointer;
            font-size: 14px;  /* Beibehalten der ursprünglichen Größe */
            transition: background 0.3s, transform 0.2s, box-shadow 0.2s;
            width: 100%;
            position: relative;
            overflow: hidden;
        }
        #sysset-window button:hover {
            background: linear-gradient(145deg, #555, #666);
            transform: scale(1.05) translateY(-2px);
            box-shadow: 0 4px 10px rgba(0, 255, 0, 0.6);
        }
        #sysset-window button:active {
            animation: buttonClick 0.2s ease;
        }
		#appsfinder-window {
			position: absolute;
			bottom: 70px;
			left: 7%;
			transform: translateX(-50%);
			background: rgba(20, 20, 20, 0.9);
			border: 2px solid rgba(0, 255, 0, 0.5);
			border-radius: 8px; /* Kleineren Radius */
			box-shadow: 0 6px 12px rgba(0, 0, 0, 0.4), 0 0 20px rgba(0, 255, 0, 0.5);
			display: none;
			padding: 10px; /* Weniger Padding */
			box-sizing: border-box;
			width: 200px; /* Kleinere Breite */
			backdrop-filter: blur(10px);
			transition: opacity 0.3s ease, transform 0.3s ease;
		}
        #appsfinder-window.active {
            display: block;
            opacity: 1;
        }
        #appsfinder-window button {
            display: flex;
            align-items: center;
            background: linear-gradient(145deg, #444, #555);
            border: none;
            color: #00ff00;
            padding: 10px 15px;
            margin-bottom: 8px;
            border-radius: 8px;
            cursor: pointer;
            font-size: 15px;
            transition: background 0.3s, transform 0.2s, box-shadow 0.2s;
            width: 100%;
        }
        .button-icon {
            width: 20px;
            height: 20px;
            margin-right: 8px;
            border-radius: 4px;
            transition: transform 0.3s ease, box-shadow 0.3s ease;
        }
        #appsfinder-window button:hover .button-icon {
            transform: translateY(-2px) scale(1.1);
            box-shadow: 0 4px 10px rgba(0, 255, 0, 0.5);
        }
        #appsfinder-window button:hover {
            background: linear-gradient(145deg, #555, #666);
            transform: scale(1.1);
            box-shadow: 0 4px 10px rgba(0, 255, 0, 0.5);
        }
        #appsfinder-window button:focus {
            outline: none;
            box-shadow: 0 0 0 2px rgba(0, 255, 255, 0.6);
            background: linear-gradient(145deg, #444, #555);
        }
        @media (prefers-reduced-motion: no-preference) {
            #appsfinder-window {
                animation: fadeInUp 0.5s ease-out;
            }
        }
        @keyframes fadeInUp {
            from {
                opacity: 0;
                transform: translateY(20px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }
    `;
	document.head.appendChild(style);
	const newRules = Array.from(style.sheet.cssRules);
	document.head.removeChild(style);

	function cssTextToObject(cssText) {
		return cssText
			.split(';')
			.map(rule => rule.trim().split(':'))
			.filter(rule => rule.length === 2)
			.reduce((acc, [property, value]) => {
				acc[property.trim()] = value.trim();
				return acc;
			}, {});
	}

	function mergeCSSRules(existingRules, newRules) {
		return { ...existingRules, ...newRules };
	}

	function objectToCSSText(cssObject) {
		return Object.entries(cssObject)
			.map(([property, value]) => `${property}: ${value};`)
			.join(' ');
	}

	function updateOrMergeRule(selector, ruleText, backupStyle) {
		const newRuleObject = cssTextToObject(ruleText.split('{')[1].split('}')[0]);

		let ruleUpdated = false;

		for (const sheet of document.styleSheets) {
			try {
				for (let i = 0; i < sheet.cssRules.length; i++) {
					const rule = sheet.cssRules[i];
					if (rule.selectorText === selector && rule.style) {
						const existingRuleObject = cssTextToObject(rule.style.cssText);
						const mergedRuleObject = mergeCSSRules(existingRuleObject, newRuleObject);
						const mergedRuleText = `${selector} { ${objectToCSSText(mergedRuleObject)} }`;
						sheet.deleteRule(i);
						sheet.insertRule(mergedRuleText, i);
						ruleUpdated = true;
						return;
					}
				}
			} catch (e) {
				console.warn("Zugriff auf Stylesheet nicht möglich:", e);
			}
		}

		if (!ruleUpdated) {
			backupStyle.appendChild(document.createTextNode(ruleText));
		}
	}

	const backupStyle = document.createElement('style');
	document.head.appendChild(backupStyle);

	for (const rule of newRules) {
		const selector = rule.selectorText;
		const ruleText = rule.cssText;
		updateOrMergeRule(selector, ruleText, backupStyle);
	}
}

function applyLoveTheme() {
	const style = document.createElement('style');
    style.innerHTML	= `
        .resize-handle {
            background-color: #ff4c4c;
        }
        .resize-handle:hover {
            background-color: #ff7070;
            transform: rotate(45deg) scale(1.1);
        }
        .resize-handle::before {
            border-color: #ffb3b3;
        }
        .resize-handle:hover::before {
            border-color: #ff9999;
        }
        #selection-window, #folsel-window, #sysset-window, #appsfinder-window {
            background: rgba(255, 100, 100, 0.9);
            border: 1px solid rgba(255, 255, 255, 0.5);
            box-shadow: 0 6px 12px rgba(255, 0, 0, 0.4), 0 0 16px rgba(255, 0, 0, 0.2);
            backdrop-filter: blur(12px);
        }
        #selection-window.active, #folsel-window.active, #sysset-window.active, #appsfinder-window.active {
            opacity: 0.9;
        }
        #selection-window button, #folsel-window button, #sysset-window button, #appsfinder-window button {
            background: linear-gradient(145deg, #ff4c4c, #ff6f6f);
            color: #fff;
        }
        #selection-window button:hover, #folsel-window button:hover, #sysset-window button:hover, #appsfinder-window button:hover {
            background: linear-gradient(145deg, #ff6f6f, #ff9f9f);
            transform: scale(1.05) rotate(2deg);
            box-shadow: 0 4px 15px rgba(255, 0, 0, 0.3);
        }
        #selection-window button:focus, #folsel-window button:focus, #sysset-window button:focus, #appsfinder-window button:focus {
            box-shadow: 0 0 0 2px rgba(255, 100, 255, 0.6);
        }
        @keyframes fadeInUp {
            from {
                opacity: 0;
                transform: translateY(20px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }
        @media (prefers-reduced-motion: no-preference) {
            #selection-window, #folsel-window, #sysset-window, #appsfinder-window {
                animation: fadeInUp 0.7s ease-out;
            }
        }
        .button-icon {
            background-color: #ff9999;
            transition: transform 0.5s ease, box-shadow 0.5s ease;
        }
        #appsfinder-window button:hover .button-icon {
            transform: translateY(-3px) scale(1.1);
        }

        .window-header {
            background-color: rgba(255, 0, 127, 0.7);
            color: #ff69b4;
            text-shadow: 0 0 5px #ff69b4, 0 0 10px #ff69b4, 0 0 15px #ff69b4;
        }
        .window-body {
            background-color: rgba(255, 228, 225, 0.9);
            color: #d5006d;
        }
        .window-footer {
            color: #ff69b4;
        }
        .icon span {
            color: #ff1493;
        }
        .error-message {
            background: #ffb3b3;
            color: #d5006d;
            text-shadow: 0 0 5px #ff1493, 0 0 10px #ff1493;
        }
        .error-message .ok-button {
            background: rgba(255, 105, 180, 0.7);
            color: #fff;
        }
        .error-message .ok-button:hover {
            background: rgba(255, 20, 147, 0.7);
        }
        .selected {
            border: 2px solid #ff1493;
            background-color: rgba(255, 20, 147, 0.2);
            border-radius: 0;
        }
        .file-label {
            color: #ff69b4;
        }
        .context-menu {
            background: rgba(255, 182, 193, 0.8);
            border-radius: 0;
        }
        .context-menu ul li {
            color: #d5006d;
            border-radius: 0;
        }
        .context-menu ul li:hover {
            background: rgba(255, 105, 180, 0.6);
        }
        .taskbar {
            background: linear-gradient(90deg, rgba(255, 105, 180, 0.8), rgba(255, 20, 147, 0.8));
            position: fixed;
            bottom: 10px;
            width: 100%;
            display: flex;
            align-items: center;
            padding: 0 20px;
            box-shadow: 0 -2px 10px rgba(0, 0, 0, 0.5);
            z-index: 1000;
            border-radius: 0 0 20px 20px;
        }
        .taskbar-button {
            color: #fff;
            padding: 10px 20px;
            border: none;
            border-radius: 0;
            font-size: 14px;
            position: relative;
            cursor: pointer;
            transition: transform 0.3s, background-color 0.3s, color 0.3s;
            margin: 0 4px;
        }
        .taskbar-button:hover {
            background-color: rgba(255, 20, 147, 0.5);
            transform: scale(1.05) translateY(-2px);
            box-shadow: 0 0 20px rgba(255, 20, 147, 0.5);
            color: #fff;
        }
        .taskbar-button:active {
            transform: scale(0.95) translateY(2px);
            background-color: rgba(255, 20, 147, 0.7);
            box-shadow: 0 0 10px rgba(0, 0, 0, 0.5);
        }
        .icon {
            background-color: #ffb3b3;
        }
        .icon:hover {
            transform: scale(1.1) rotate(3deg);
            box-shadow: 0 4px 12px rgba(255, 0, 127, 0.4);
        }

        @keyframes fadeIn {
            from {
                opacity: 0;
                transform: translate(-50%, -60%) scale(0.9);
            }
            to {
                opacity: 1;
                transform: translate(-50%, -50%) scale(1);
            }
        }
    `;

	document.head.appendChild(style);
	const newRules = Array.from(style.sheet.cssRules);
	document.head.removeChild(style);

	function cssTextToObject(cssText) {
		return cssText
			.split(';')
			.map(rule => rule.trim().split(':'))
			.filter(rule => rule.length === 2)
			.reduce((acc, [property, value]) => {
				acc[property.trim()] = value.trim();
				return acc;
			}, {});
	}

	function mergeCSSRules(existingRules, newRules) {
		return { ...existingRules, ...newRules };
	}

	function objectToCSSText(cssObject) {
		return Object.entries(cssObject)
			.map(([property, value]) => `${property}: ${value};`)
			.join(' ');
	}

	function updateOrMergeRule(selector, ruleText, backupStyle) {
		const newRuleObject = cssTextToObject(ruleText.split('{')[1].split('}')[0]);

		let ruleUpdated = false;

		for (const sheet of document.styleSheets) {
			try {
				for (let i = 0; i < sheet.cssRules.length; i++) {
					const rule = sheet.cssRules[i];
					if (rule.selectorText === selector && rule.style) {
						const existingRuleObject = cssTextToObject(rule.style.cssText);
						const mergedRuleObject = mergeCSSRules(existingRuleObject, newRuleObject);
						const mergedRuleText = `${selector} { ${objectToCSSText(mergedRuleObject)} }`;
						sheet.deleteRule(i);
						sheet.insertRule(mergedRuleText, i);
						ruleUpdated = true;
						return;
					}
				}
			} catch (e) {
				console.warn("Zugriff auf Stylesheet nicht möglich:", e);
			}
		}

		if (!ruleUpdated) {
			backupStyle.appendChild(document.createTextNode(ruleText));
		}
	}

	const backupStyle = document.createElement('style');
	document.head.appendChild(backupStyle);

	for (const rule of newRules) {
		const selector = rule.selectorText;
		const ruleText = rule.cssText;
		updateOrMergeRule(selector, ruleText, backupStyle);
	}
}

function applyNightTheme() {
    const style = document.createElement('style');
    style.innerHTML = `
        .window-header {
            background-color: rgba(5, 5, 5, 0.85);
            color: #0099ff;
            text-shadow: 0 0 8px #0099ff, 0 0 16px #0099ff;
            animation: headerGlow 1.5s infinite alternate ease-in-out;
        }
        @keyframes headerGlow {
            from { text-shadow: 0 0 8px #0099ff, 0 0 16px #0099ff; }
            to { text-shadow: 0 0 10px #66ccff, 0 0 20px #66ccff; }
        }

        .window-body {
            background-color: #1a1a1a;
            color: #dcdcdc;
            padding: 16px;
            border-radius: 8px;
            animation: fadeInBody 0.6s ease;
        }
        @keyframes fadeInBody {
            from { opacity: 0; }
            to { opacity: 1; }
        }

        .window-footer {
            background-color: rgba(10, 10, 10, 0.9);
            color: #0077ff;
            border-top: 1px solid #444;
        }

        .icon span {
            color: #f0f0f0;
            font-weight: bold;
            text-shadow: 0 0 5px #0099ff;
        }

        .icon {
            background-color: #262626;
            color: #f0f0f0;
            border-radius: 12px;
            box-shadow: 0 6px 12px rgba(0, 0, 0, 0.6);
            transition: transform 0.4s ease, box-shadow 0.4s ease, background-color 0.3s;
        }
        .icon:hover {
            transform: scale(1.1) rotate(3deg);
            box-shadow: 0 8px 16px rgba(0, 153, 255, 0.6);
            background-color: #1a1a1a;
        }
        .icon:active {
            transform: scale(0.95);
            background-color: #333;
        }

        .selected {
            border: 2px solid #3399ff;
            background-color: rgba(51, 153, 255, 0.3);
            animation: pulseBorder 1.2s infinite alternate;
        }
        @keyframes pulseBorder {
            from { border-color: #3399ff; }
            to { border-color: #66ccff; }
        }

        .error-message {
            background: rgba(20, 20, 20, 0.95);
            color: #3399ff;
            padding: 40px;
            border-radius: 14px;
            text-shadow: 0 0 10px #3399ff;
            box-shadow: 0 12px 28px rgba(0, 0, 0, 0.8);
            animation: fadeInError 0.5s ease, shakeError 0.3s ease 0.2s;
            transform: translate(-50%, -50%);
        }
        @keyframes fadeInError {
            from { opacity: 0; transform: translate(-50%, -60%) scale(0.8); }
            to { opacity: 1; transform: translate(-50%, -50%) scale(1); }
        }
        @keyframes shakeError {
            0%, 100% { transform: translate(-50%, -50%) rotate(-2deg); }
            50% { transform: translate(-50%, -50%) rotate(2deg); }
        }

        .error-message .ok-button {
            background: rgba(5, 5, 5, 0.8);
            border-radius: 8px;
            color: #d9d9d9;
            padding: 10px 25px;
            transition: background 0.4s, color 0.4s, transform 0.2s ease;
        }
        .error-message .ok-button:hover {
            background: rgba(51, 153, 255, 0.8);
            color: #ffffff;
            transform: translateY(-3px);
        }

        .taskbar {
            background-color: rgba(10, 10, 10, 0.9);
            color: #cccccc;
            box-shadow: 0 -1px 8px rgba(0, 0, 0, 0.3);
            backdrop-filter: blur(6px);
            transition: background-color 0.3s;
        }
        .taskbar:hover {
            background-color: rgba(15, 15, 15, 0.95);
        }
        
        .taskbar-button {
            color: #bbbbbb;
            background: transparent;
            padding: 10px 18px;
            font-size: 15px;
            transition: transform 0.3s, color 0.3s ease-in;
        }
        .taskbar-button:hover {
            color: #3399ff;
            background-color: rgba(51, 153, 255, 0.15);
            transform: translateY(-3px);
        }
        .taskbar-button:active {
            color: #3399ff;
            transform: scale(0.9);
        }

        .file-label {
            color: #3399ff;
            text-shadow: 0 0 6px #3399ff;
            font-weight: 700;
        }

        .context-menu {
            background: rgba(5, 5, 5, 0.8);
            border-radius: 12px;
            box-shadow: 0 10px 20px rgba(0, 0, 0, 0.5);
            backdrop-filter: blur(8px);
            overflow: hidden;
        }
        .context-menu ul li {
            padding: 10px 15px;
            background: rgba(5, 5, 5, 0.7);
            color: #e6e6e6;
            transition: background 0.3s ease, color 0.3s ease;
        }
        .context-menu ul li:hover {
            background: rgba(0, 102, 204, 0.6);
            color: #ffffff;
            text-shadow: 0 0 6px #0099ff, 0 0 12px #0099ff;
        }
        .context-menu ul li:active {
            background: rgba(0, 102, 204, 0.8);
            color: #ffffff;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(-10px); }
            to { opacity: 1; transform: translateY(0); }
        }
		.modal-overlay {
            background: rgba(0, 0, 0, 0.95);
            backdrop-filter: blur(15px);
        }
        .login-box {
            background: rgba(40, 40, 40, 0.9);
            border-radius: 12px;
            box-shadow: 0 0 60px rgba(0, 255, 255, 0.6);
            transition: transform 0.3s;
        }
        .login-box:hover {
            transform: scale(1.02);
        }
        .title {
            color: #e0e0e0;
            text-shadow: 0 0 10px rgba(0, 255, 255, 0.5);
        }
        .password-input {
            background: rgba(255, 255, 255, 0.15);
            color: #fff;
            transition: background 0.4s, box-shadow 0.4s, transform 0.4s;
        }
        .password-input:focus {
            background: rgba(255, 255, 255, 0.25);
            box-shadow: 0 0 10px rgba(0, 123, 255, 0.7);
            transform: scale(1.01);
        }
        .login-button {
            background: linear-gradient(90deg, #007bff, #0056b3);
            transition: background 0.4s, transform 0.3s, box-shadow 0.3s;
        }
        .login-button:hover {
            background: linear-gradient(90deg, #0056b3, #003d80);
            transform: translateY(-4px);
            box-shadow: 0 6px 30px rgba(0, 123, 255, 0.5);
        }
        .login-error {
            color: #ff4d4d;
            animation: shake 0.5s ease-in-out;
        }
        @keyframes shake {
            0%, 100% { transform: translateX(0); }
            25% { transform: translateX(-5px); }
            50% { transform: translateX(5px); }
            75% { transform: translateX(-5px); }
        }
        .settingsmain-menu {
            background: rgba(25, 25, 25, 0.9);
            border: 1px solid rgba(255, 255, 255, 0.3);
            box-shadow: 0 0 60px rgba(0, 255, 255, 0.6);
            transition: all 0.5s ease;
            border-radius: 10px;
            animation: fadeIn 0.5s;
        }
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(-15px); }
            to { opacity: 1; transform: translateY(0); }
        }
        .settingsmain-header {
            border-bottom: 2px solid rgba(255, 255, 255, 0.1);
            padding-bottom: 15px;
            margin-bottom: 25px;
            color: #e0e0e0;
            text-shadow: 0 0 5px rgba(0, 255, 255, 0.4);
        }
        .settingsmain-controls button {
            color: #ffffff;
            transition: transform 0.3s, color 0.3s, background 0.3s;
        }
        .settingsmain-controls button:hover {
            transform: scale(1.2);
            color: #00bfff;
            background: rgba(0, 255, 255, 0.2);
        }
        .settingsmain-content {
            color: #d0d0d0;
            transition: color 0.3s;
            animation: fadeIn 0.5s;
        }
        .settingsmain-option {
            padding: 12px;
            margin: 5px 0;
            background: rgba(60, 60, 60, 0.5);
            border-radius: 6px;
            transition: background 0.3s, transform 0.3s, box-shadow 0.3s;
            box-shadow: 0 0 10px rgba(255, 255, 255, 0.1);
        }
        .settingsmain-option:hover {
            background: rgba(80, 80, 80, 0.7);
            transform: translateY(-3px);
            box-shadow: 0 4px 20px rgba(0, 255, 255, 0.5);
        }
        .settingsmain-option label {
            font-size: 20px;
            transition: color 0.3s;
        }
        .settingsmain-option input {
            transform: scale(1.6);
            cursor: pointer;
            transition: transform 0.3s, box-shadow 0.3s;
        }
        .settingsmain-option input:hover {
            transform: scale(1.8);
            box-shadow: 0 0 8px rgba(0, 255, 255, 0.5);
        }
        .settingsmain-resize {
            background: rgba(255, 255, 255, 0.3);
            transition: background 0.3s;
        }
        .settingsmain-resize:hover {
            background: rgba(255, 255, 255, 0.5);
        }
        .settingsmain-butten {
            background: linear-gradient(145deg, #444, #555);
            color: #f0f0f0;
            transition: background 0.4s, transform 0.3s, box-shadow 0.3s;
            border-radius: 8px;
        }
        .settingsmain-butten:hover {
            background: linear-gradient(145deg, #555, #666);
            transform: scale(1.05);
            box-shadow: 0 4px 20px rgba(255, 255, 255, 0.3);
        }
        .settingsmain-butten:focus {
            box-shadow: 0 0 0 2px rgba(0, 170, 255, 0.8);
            background: linear-gradient(145deg, #444, #555);
        }
		.resize-handle {
            background-color: rgba(60, 60, 60, 0.9);
            transition: transform 0.3s ease, background-color 0.3s ease, box-shadow 0.3s ease;
        }
        .resize-handle:hover {
            background-color: rgba(80, 80, 80, 0.9);
            transform: rotate(45deg) scale(1.1);
            box-shadow: 0 0 10px rgba(255, 255, 255, 0.5);
        }
        .resize-handle::before {
            border: 2px solid rgba(200, 200, 200, 0.8);
        }
        .resize-handle:hover::before {
            border-color: rgba(250, 250, 250, 0.8);
        }
        .resize-handle:active {
            background-color: rgba(100, 100, 100, 0.9);
            transform: scale(1.15);
            box-shadow: 0 0 15px rgba(255, 255, 255, 0.7);
        }
        
        #selection-window, #folsel-window, #sysset-window, #appsfinder-window {
            background: rgba(20, 20, 20, 0.9);
            border: 1px solid rgba(255, 255, 255, 0.3);
            animation: slideInUp 0.5s ease;
        }
        
        #selection-window button, #folsel-window button, #sysset-window button, #appsfinder-window button {
            background: linear-gradient(145deg, rgba(50, 50, 50, 1), rgba(60, 60, 60, 1));
            transition: background 0.4s, transform 0.4s, box-shadow 0.4s, filter 0.4s;
        }
        
        #selection-window button:hover,
        #folsel-window button:hover,
        #sysset-window button:hover,
        #appsfinder-window button:hover {
            background: linear-gradient(145deg, rgba(60, 60, 60, 1), rgba(70, 70, 70, 1));
            transform: translateY(-3px) scale(1.05);
            box-shadow: 0 4px 20px rgba(255, 255, 255, 0.4);
            filter: brightness(1.1);
        }

        #selection-window button:focus,
        #folsel-window button:focus,
        #sysset-window button:focus,
        #appsfinder-window button:focus {
            outline: none;
            box-shadow: 0 0 0 2px rgba(0, 170, 255, 0.8);
            background: linear-gradient(145deg, rgba(50, 50, 50, 1), rgba(60, 60, 60, 1));
        }
        
        @keyframes slideInUp {
            from {
                opacity: 0;
                transform: translateY(20px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }
    `;
	document.head.appendChild(style);
	const newRules = Array.from(style.sheet.cssRules);
	document.head.removeChild(style);

	function cssTextToObject(cssText) {
		return cssText
			.split(';')
			.map(rule => rule.trim().split(':'))
			.filter(rule => rule.length === 2)
			.reduce((acc, [property, value]) => {
				acc[property.trim()] = value.trim();
				return acc;
			}, {});
	}

	function mergeCSSRules(existingRules, newRules) {
		return { ...existingRules, ...newRules };
	}

	function objectToCSSText(cssObject) {
		return Object.entries(cssObject)
			.map(([property, value]) => `${property}: ${value};`)
			.join(' ');
	}

	function updateOrMergeRule(selector, ruleText, backupStyle) {
		const newRuleObject = cssTextToObject(ruleText.split('{')[1].split('}')[0]);

		let ruleUpdated = false;

		for (const sheet of document.styleSheets) {
			try {
				for (let i = 0; i < sheet.cssRules.length; i++) {
					const rule = sheet.cssRules[i];
					if (rule.selectorText === selector && rule.style) {
						const existingRuleObject = cssTextToObject(rule.style.cssText);
						const mergedRuleObject = mergeCSSRules(existingRuleObject, newRuleObject);
						const mergedRuleText = `${selector} { ${objectToCSSText(mergedRuleObject)} }`;
						sheet.deleteRule(i);
						sheet.insertRule(mergedRuleText, i);
						ruleUpdated = true;
						return;
					}
				}
			} catch (e) {
				console.warn("Zugriff auf Stylesheet nicht möglich:", e);
			}
		}

		if (!ruleUpdated) {
			backupStyle.appendChild(document.createTextNode(ruleText));
		}
	}

	const backupStyle = document.createElement('style');
	document.head.appendChild(backupStyle);

	for (const rule of newRules) {
		const selector = rule.selectorText;
		const ruleText = rule.cssText;
		updateOrMergeRule(selector, ruleText, backupStyle);
	}
}

function applyRetroTheme() {
    const styles = {
        '.window-header': {
            'background-color': 'rgba(255, 204, 0, 0.8)',
            'color': '#000',
            'text-shadow': '0 0 3px #ffcc00, 0 0 6px #ffcc00, 0 0 9px #ffcc00',
            'padding': '10px',
            'animation': 'pop 0.5s ease-in-out',
        },
        '.window-body': {
            'background-color': '#f7f7f7',
            'color': '#000',
            'padding': '15px',
            'border': '2px dashed #ffcc00',
            'animation': 'fadeIn 0.5s ease-in-out',
        },
        '.window-footer': {
            'background-color': '#f7f7f7',
            'text-align': 'center',
            'padding': '10px',
            'font-weight': 'bold',
        },
        '.icon span': {
            'color': '#000',
            'text-shadow': '0 0 3px #ffcc00, 0 0 6px #ffcc00',
        },
        '.error-message': {
            'background': '#ffcc00',
            'color': '#000',
            'text-shadow': 'none',
            'border-radius': '15px',
            'box-shadow': '0 4px 10px rgba(0, 0, 0, 0.5)',
            'animation': 'bounce 0.5s ease-in-out',
        },
        '.error-message span': {
            'font-size': '20px',
        },
        '.error-message .ok-button': {
            'background': '#000',
            'color': '#ffcc00',
            'border': '2px solid #ffcc00',
            'transition': 'transform 0.2s',
        },
        '.error-message .ok-button:hover': {
            'transform': 'scale(1.1)',
        },
        '.selected': {
            'border': '2px solid #cc6600',
            'background-color': 'rgba(204, 102, 0, 0.3)',
        },
        '.file-label': {
            'color': '#cc6600',
            'font-weight': 'bold',
            'text-shadow': '0 0 3px #cc6600',
        },
        '.context-menu': {
            'background': 'rgba(255, 204, 0, 0.8)',
            'box-shadow': '0 4px 8px rgba(0, 0, 0, 0.5)',
            'animation': 'slideIn 0.3s ease-in-out',
        },
        '.context-menu ul li': {
            'background': 'rgba(255, 204, 0, 0.6)',
            'color': '#000',
            'transition': 'background 0.2s, color 0.2s',
        },
        '.context-menu ul li:hover': {
            'background': 'rgba(255, 204, 0, 0.7)',
            'color': '#fff',
            'text-shadow': '0 0 8px #ffcc00',
        },
        '.taskbar': {
            'background-color': '#cc6600',
            'color': '#fff',
            'box-shadow': '0 -1px 4px rgba(0, 0, 0, 0.5)',
        },
        '.taskbar-button': {
            'color': '#ffcc00',
            'transition': 'color 0.3s, background-color 0.3s, transform 0.2s',
        },
        '.taskbar-button:hover': {
            'color': '#000',
            'background-color': '#ffcc00',
        },
        '.icon': {
            'background-color': '#fff',
            'border-radius': '8px',
            'animation': 'scaleUp 0.3s ease-in-out',
        },
    };

    for (const selector in styles) {
        const elements = document.querySelectorAll(selector);
        elements.forEach((element) => {
            for (const property in styles[selector]) {
                element.style[property] = styles[selector][property];
            }
        });
    }

    const keyframes = `
        @keyframes pop {
            0% { transform: scale(0.8); }
            50% { transform: scale(1.1); }
            100% { transform: scale(1); }
        }
        @keyframes fadeIn {
            0% { opacity: 0; }
            100% { opacity: 1; }
        }
        @keyframes bounce {
            0% { transform: translateY(0); }
            50% { transform: translateY(-10px); }
            100% { transform: translateY(0); }
        }
        @keyframes slideIn {
            0% { transform: translateY(-20px); opacity: 0; }
            100% { transform: translateY(0); opacity: 1; }
        }
        @keyframes scaleUp {
            0% { transform: scale(0.9); }
            100% { transform: scale(1); }
        }
    `;

    const styleSheet = document.createElement("style");
    styleSheet.type = "text/css";
    styleSheet.innerText = keyframes;
    document.head.appendChild(styleSheet);
}

function applyCyberpunkTheme() {
    const style = document.createElement('style');
    style.innerHTML = `
        .resize-handle {
            background-color: #00ffcc;
            border: 2px solid #ff0057;
            transition: transform 0.4s ease, background-color 0.4s ease;
        }
        .resize-handle:hover {
            background-color: #ff0057;
            transform: rotate(45deg) scale(1.1);
        }
        .resize-handle::before {
            border-color: #00ffcc;
            transition: border-color 0.4s ease;
        }
        .resize-handle:hover::before {
            border-color: #ff0057;
        }
        #selection-window, #folsel-window, #sysset-window, #appsfinder-window {
            background: rgba(10, 10, 10, 0.9);
            border: 1px solid rgba(0, 255, 255, 0.5);
            box-shadow: 0 8px 16px rgba(0, 0, 0, 0.6), 0 0 20px rgba(0, 255, 255, 0.3);
            backdrop-filter: blur(12px);
            transition: opacity 0.4s ease, transform 0.4s ease;
        }
        #selection-window.active, #folsel-window.active, #sysset-window.active, #appsfinder-window.active {
            opacity: 1;
        }
        #selection-window button, #folsel-window button, #sysset-window button, #appsfinder-window button {
            background: linear-gradient(145deg, #1f1f1f, #2f2f2f);
            border: none;
            color: #00ffcc;
            box-shadow: 0 4px 8px rgba(0, 255, 255, 0.4);
            transition: background 0.4s, transform 0.3s, box-shadow 0.3s;
        }
        #selection-window button:hover, #folsel-window button:hover, #sysset-window button:hover, #appsfinder-window button:hover {
            background: linear-gradient(145deg, #2f2f2f, #3f3f3f);
            transform: scale(1.1);
            box-shadow: 0 6px 12px rgba(0, 255, 255, 0.6);
        }
        #selection-window button:focus, #folsel-window button:focus, #sysset-window button:focus, #appsfinder-window button:focus {
            outline: none;
            box-shadow: 0 0 0 2px rgba(0, 255, 255, 0.8);
        }
        @keyframes fadeInUp {
            0% {
                opacity: 0;
                transform: translateY(20px) scale(0.9);
            }
            100% {
                opacity: 1;
                transform: translateY(0) scale(1);
            }
        }
        @media (prefers-reduced-motion: no-preference) {
            #selection-window, #folsel-window, #sysset-window, #appsfinder-window {
                animation: fadeInUp 0.6s ease-out;
            }
        }
		.modal-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.85);
            backdrop-filter: blur(15px);
            display: flex;
            align-items: center;
            justify-content: center;
            z-index: 9999;
            animation: fadeIn 0.3s ease;
        }
        .login-box {
            background: rgba(30, 30, 30, 0.9);
            border-radius: 16px;
            padding: 40px;
            box-shadow: 0 0 40px rgba(0, 255, 0, 0.3);
            text-align: center;
            width: 380px;
            backdrop-filter: blur(20px);
            animation: zoomIn 0.3s ease;
        }
        .title {
            color: #00ffcc;
            margin-bottom: 20px;
            font-size: 28px;
            text-shadow: 0 0 10px rgba(0, 255, 204, 0.8);
        }
        .password-input {
            width: 100%;
            padding: 12px;
            margin: 10px 0;
            border: none;
            border-radius: 8px;
            background: rgba(50, 50, 50, 0.7);
            color: #ffffff;
            font-size: 16px;
            transition: background 0.3s, box-shadow 0.3s;
        }
        .password-input:focus {
            background: rgba(70, 70, 70, 0.9);
            box-shadow: 0 0 10px rgba(0, 255, 204, 0.7);
            outline: none;
        }
        .login-button {
            padding: 14px 22px;
            border: none;
            border-radius: 8px;
            background: linear-gradient(90deg, #ff007f, #ff3d00);
            color: #ffffff;
            cursor: pointer;
            font-size: 18px;
            transition: background 0.3s, transform 0.2s;
            box-shadow: 0 0 15px rgba(255, 0, 127, 0.5);
        }
        .login-button:hover {
            background: linear-gradient(90deg, #ff3d00, #ff007f);
            transform: translateY(-3px) scale(1.05);
        }
        .login-error {
            color: #ff4d4d;
            margin-top: 10px;
            animation: shake 0.5s ease;
        }
        .settingsmain-menu {
            position: absolute;
            top: 15%;
            left: 15%;
            width: 420px;
            height: auto;
            backdrop-filter: blur(12px);
            background: rgba(20, 20, 20, 0.85);
            border: 1px solid rgba(0, 255, 204, 0.5);
            box-shadow: 0 0 30px rgba(0, 255, 0, 0.4);
            padding: 25px;
            display: none;
            transition: all 0.3s ease;
            animation: slideIn 0.3s ease;
        }
        .settingsmain-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            cursor: move;
            animation: fadeIn 0.5s ease;
        }
        .settingsmain-controls button {
            background: transparent;
            border: none;
            color: #00ffcc;
            font-size: 24px;
            cursor: pointer;
            transition: transform 0.2s, color 0.3s;
        }
        .settingsmain-controls button:hover {
            transform: scale(1.2);
            color: #ff00ff;
        }
        .settingsmain-content {
            margin-top: 20px;
        }
        .settingsmain-option {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin: 15px 0;
            animation: fadeIn 0.3s ease;
        }
        .settingsmain-option label {
            font-size: 18px;
            color: #00ffcc;
        }
        .settingsmain-option input {
            transform: scale(1.5);
            cursor: pointer;
            transition: transform 0.2s;
        }
        .settingsmain-option input:hover {
            transform: scale(1.7);
        }
        .settingsmain-resize {
            width: 15px;
            height: 15px;
            background: rgba(255, 0, 127, 0.7);
            border-radius: 50%;
            position: absolute;
            bottom: 10px;
            right: 10px;
            cursor: nwse-resize;
            transition: background 0.3s;
        }
        .settingsmain-resize:hover {
            background: rgba(255, 0, 127, 0.9);
        }
        .settingsmain-butten {
            background: linear-gradient(145deg, #444, #555);
            border: none;
            color: #f0f0f0;
            padding: 10px 16px;
            margin-bottom: 8px;
            border-radius: 8px;
            cursor: pointer;
            font-size: 14px;
            transition: background 0.3s, transform 0.2s, box-shadow 0.2s;
            width: 100%;
            box-shadow: 0 0 10px rgba(0, 255, 0, 0.3);
        }
        .settingsmain-butten:hover {
            background: linear-gradient(145deg, #555, #666);
            transform: scale(1.05);
            box-shadow: 0 4px 15px rgba(0, 255, 0, 0.5);
        }
        .settingsmain-butten:focus {
            outline: none;
            box-shadow: 0 0 0 2px rgba(0, 170, 255, 0.6);
            background: linear-gradient(145deg, #444, #555);
        }
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(-20px); }
            to { opacity: 1; transform: translateY(0); }
        }
        @keyframes zoomIn {
            from { transform: scale(0); }
            to { transform: scale(1); }
        }
        @keyframes slideIn {
            from { transform: translateY(-100%); }
            to { transform: translateY(0); }
        }
        @keyframes shake {
            0%, 100% { transform: translateX(0); }
            25% { transform: translateX(-5px); }
            50% { transform: translateX(5px); }
            75% { transform: translateX(-5px); }
        }
		.window-header {
            background-color: rgba(10, 10, 20, 0.9);
            color: #00ffcc;
            text-shadow: 0 0 5px #00ffcc, 0 0 10px #00ffcc, 0 0 20px #00ffcc;
            padding: 5px;
            cursor: move;
            display: flex;
            justify-content: space-between;
            align-items: center;
            animation: slideDown 0.5s ease-in-out;
        }
        .window-body {
            flex: 1;
            padding: 10px;
            background: rgba(20, 20, 30, 0.8);
            border-radius: 8px;
        }
        .window-footer {
            padding: 5px;
            text-align: right;
            border-top: 1px solid #00ffcc;
        }
        .icon span {
            position: absolute;
            bottom: 0;
            left: 50%;
            transform: translateX(-50%);
            text-align: center;
            color: #ffffff;
        }
        .error-message {
            background: rgba(0, 0, 0, 0.9);
            color: #ff0033;
            text-shadow: 0 0 5px #ff0033, 0 0 10px #ff0033;
            padding: 30px 50px;
            border-radius: 12px;
            box-shadow: 0 8px 30px rgba(0, 0, 0, 0.5);
            z-index: 1000;
            animation: zoomIn 0.5s ease-in-out;
        }
        .error-message span {
            font-size: 18px;
            text-align: center;
        }
        .error-message .ok-button {
            background: rgba(0, 0, 0, 0.6);
            border: none;
            color: #ffffff;
            border-radius: 6px;
            font-size: 16px;
            transition: background 0.3s, transform 0.2s;
        }
        .error-message .ok-button:hover {
            background: rgba(10, 10, 10, 0.8);
            transform: translateY(-2px);
        }
        @keyframes fadeIn {
            from { opacity: 0; transform: translate(-50%, -60%); }
            to { opacity: 1; transform: translate(-50%, -50%); }
        }
        @keyframes zoomIn {
            from { transform: scale(0); }
            to { transform: scale(1); }
        }
        @keyframes slideDown {
            from { transform: translateY(-100%); }
            to { transform: translateY(0); }
        }
        .selected {
            border: 2px solid #ff00cc;
            background-color: rgba(255, 0, 204, 0.3);
            border-radius: 3px;
        }
        .file-label {
            font-size: 12px;
            color: #ff00cc;
            font-weight: bold;
            text-shadow: 0 0 5px #ff00cc;
        }
        .context-menu {
            background: rgba(0, 0, 0, 0.9);
            border-radius: 10px;
            box-shadow: 0 8px 30px rgba(0, 0, 0, 0.5);
            display: none;
            z-index: 100;
            width: 120px;
            animation: fadeIn 0.2s ease-out;
        }
        .context-menu ul {
            list-style: none;
            padding: 0;
            margin: 0;
        }
        .context-menu ul li {
            padding: 10px;
            cursor: pointer;
            color: #d0ffd0;
            background: rgba(10, 10, 20, 0.7);
            border-radius: 6px;
            transition: background 0.3s, color 0.3s;
        }
        .context-menu ul li:hover {
            background: rgba(20, 20, 30, 0.8);
            color: #ffffff;
            text-shadow: 0 0 8px #00ff99;
        }
        .context-menu ul li:active {
            background: rgba(10, 10, 20, 0.9);
            color: #ffffff;
            text-shadow: 0 0 5px #00ff99;
        }
        .taskbar {
            background-color: #1f1f1f;
            color: #d1d1d1;
            height: 44px;
            position: fixed;
            bottom: 0;
            width: 100%;
            display: flex;
            align-items: center;
            padding: 0 10px;
            box-shadow: 0 -1px 8px rgba(0, 0, 0, 0.5);
            z-index: 1000;
        }
        .taskbar-button {
            color: #d1d1d1;
            padding: 10px 20px;
            border: none;
            font-size: 14px;
            position: relative;
            cursor: pointer;
            transition: color 0.3s, background-color 0.3s, transform 0.2s;
        }
        .taskbar-button::after {
            content: '';
            position: absolute;
            bottom: 0;
            left: 50%;
            width: 0;
            height: 3px;
            background: #00ffcc;
            transition: width 0.3s, left 0.3s;
        }
        .taskbar-button:hover {
            color: #ff00ff;
            background-color: rgba(255, 0, 255, 0.1);
        }
        .taskbar-button:hover::after {
            width: 100%;
            left: 0;
        }
        .taskbar-button:active {
            transform: scale(0.95);
            color: #ff00ff;
        }
        .icon {
            background-color: rgba(0, 0, 0, 0.8);
            color: #ffffff;
            transition: transform 0.3s ease, box-shadow 0.3s ease;
            border-radius: 12px;
        }
        .icon:hover {
            transform: scale(1.1);
            box-shadow: 0 4px 20px rgba(0, 255, 255, 0.5);
        }
    `;
	document.head.appendChild(style);
	const newRules = Array.from(style.sheet.cssRules);
	document.head.removeChild(style);

	function cssTextToObject(cssText) {
		return cssText
			.split(';')
			.map(rule => rule.trim().split(':'))
			.filter(rule => rule.length === 2)
			.reduce((acc, [property, value]) => {
				acc[property.trim()] = value.trim();
				return acc;
			}, {});
	}

	function mergeCSSRules(existingRules, newRules) {
		return { ...existingRules, ...newRules };
	}

	function objectToCSSText(cssObject) {
		return Object.entries(cssObject)
			.map(([property, value]) => `${property}: ${value};`)
			.join(' ');
	}

	function updateOrMergeRule(selector, ruleText, backupStyle) {
		const newRuleObject = cssTextToObject(ruleText.split('{')[1].split('}')[0]);

		let ruleUpdated = false;

		for (const sheet of document.styleSheets) {
			try {
				for (let i = 0; i < sheet.cssRules.length; i++) {
					const rule = sheet.cssRules[i];
					if (rule.selectorText === selector && rule.style) {
						const existingRuleObject = cssTextToObject(rule.style.cssText);
						const mergedRuleObject = mergeCSSRules(existingRuleObject, newRuleObject);
						const mergedRuleText = `${selector} { ${objectToCSSText(mergedRuleObject)} }`;
						sheet.deleteRule(i);
						sheet.insertRule(mergedRuleText, i);
						ruleUpdated = true;
						return;
					}
				}
			} catch (e) {
				console.warn("Zugriff auf Stylesheet nicht möglich:", e);
			}
		}

		if (!ruleUpdated) {
			backupStyle.appendChild(document.createTextNode(ruleText));
		}
	}

	const backupStyle = document.createElement('style');
	document.head.appendChild(backupStyle);

	for (const rule of newRules) {
		const selector = rule.selectorText;
		const ruleText = rule.cssText;
		updateOrMergeRule(selector, ruleText, backupStyle);
	}
}

//-------live-wallpaper----------------------------------------------------------------------------------------

function pulsatingNeonWallpaper() {
    const desktop = document.querySelector('.desktop');
    desktop.style.background = 'none';

    const wallpaperLayer = document.createElement('div');
    wallpaperLayer.style.position = 'fixed';
    wallpaperLayer.style.top = '0';
    wallpaperLayer.style.left = '0';
    wallpaperLayer.style.width = '100%';
    wallpaperLayer.style.height = '100%';
    wallpaperLayer.style.pointerEvents = 'none';
    wallpaperLayer.style.zIndex = '-1';

    document.body.appendChild(wallpaperLayer);
    
    const canvas = document.createElement('canvas');
    canvas.id = 'liveWallpaperCanvas';
    wallpaperLayer.appendChild(canvas);

    const ctx = canvas.getContext('2d');

    function resizeCanvas() {
        canvas.width = window.innerWidth;
        canvas.height = window.innerHeight;
    }

    window.addEventListener('resize', resizeCanvas);
    resizeCanvas();

    const numLines = 100;
    const lines = [];

    for (let i = 0; i < numLines; i++) {
        lines.push({
            x: Math.random() * canvas.width,
            y: Math.random() * canvas.height,
            length: Math.random() * 100 + 50,
            angle: Math.random() * Math.PI * 2,
            speed: Math.random() * 2 + 1,
            color: `hsl(${Math.random() * 360}, 100%, 50%)`
        });
    }

    function draw() {
        ctx.fillStyle = 'rgba(0, 0, 0, 0.1)';
        ctx.fillRect(0, 0, canvas.width, canvas.height);

        lines.forEach(line => {
            ctx.strokeStyle = line.color;
            ctx.lineWidth = 2;

            const xEnd = line.x + Math.cos(line.angle) * line.length;
            const yEnd = line.y + Math.sin(line.angle) * line.length;

            ctx.beginPath();
            ctx.moveTo(line.x, line.y);
            ctx.lineTo(xEnd, yEnd);
            ctx.stroke();
            ctx.closePath();

            line.x += Math.cos(line.angle) * line.speed;
            line.y += Math.sin(line.angle) * line.speed;

            if (line.x < 0 || line.x > canvas.width || line.y < 0 || line.y > canvas.height) {
                line.angle += Math.PI;
            }
        });

        requestAnimationFrame(draw);
    }

    draw();
}

function futuristicCyberpunkWallpaper() {
    const desktop = document.querySelector('.desktop');
    desktop.style.background = 'none';

    const wallpaperLayer = document.createElement('div');
    wallpaperLayer.style.position = 'fixed';
    wallpaperLayer.style.top = '0';
    wallpaperLayer.style.left = '0';
    wallpaperLayer.style.width = '100%';
    wallpaperLayer.style.height = '100%';
    wallpaperLayer.style.pointerEvents = 'none';
    wallpaperLayer.style.zIndex = '-1';

    document.body.appendChild(wallpaperLayer);
    
    const canvas = document.createElement('canvas');
    canvas.id = 'liveWallpaperCanvas';
    wallpaperLayer.appendChild(canvas);

    const ctx = canvas.getContext('2d');

    function resizeCanvas() {
        canvas.width = window.innerWidth;
        canvas.height = window.innerHeight;
    }

    window.addEventListener('resize', resizeCanvas);
    resizeCanvas();

    const numShapes = 100;
    const shapes = [];

    for (let i = 0; i < numShapes; i++) {
        shapes.push({
            x: Math.random() * canvas.width,
            y: Math.random() * canvas.height,
            size: Math.random() * 10 + 5,
            speedX: Math.random() * 4 - 2,
            speedY: Math.random() * 4 - 2,
            color: `hsl(${Math.random() * 40 + 200}, 100%, 50%)`,
            alpha: Math.random() * 0.5 + 0.3
        });
    }

    function draw() {
        ctx.fillStyle = 'rgba(0, 0, 0, 0.05)';
        ctx.fillRect(0, 0, canvas.width, canvas.height);

        shapes.forEach(shape => {
            ctx.fillStyle = `rgba(${parseInt(shape.color.slice(4, shape.color.indexOf(',')))}, ${parseInt(shape.color.slice(shape.color.indexOf(',') + 1, shape.color.lastIndexOf(',')))}, ${parseInt(shape.color.slice(shape.color.lastIndexOf(',') + 1, shape.color.indexOf(')')))}, ${shape.alpha})`;

            ctx.beginPath();
            ctx.arc(shape.x, shape.y, shape.size, 0, Math.PI * 2);
            ctx.fill();
            ctx.closePath();

            shape.x += shape.speedX;
            shape.y += shape.speedY;

            if (shape.x < 0 || shape.x > canvas.width) {
                shape.speedX *= -1;
            }
            if (shape.y < 0 || shape.y > canvas.height) {
                shape.speedY *= -1;
            }
        });

        ctx.strokeStyle = 'rgba(255, 100, 200, 0.5)';
        ctx.lineWidth = 2;
        for (let i = 0; i < shapes.length; i++) {
            for (let j = i + 1; j < shapes.length; j++) {
                const dx = shapes[i].x - shapes[j].x;
                const dy = shapes[i].y - shapes[j].y;
                const distance = Math.sqrt(dx * dx + dy * dy);
                if (distance < 100) {
                    ctx.beginPath();
                    ctx.moveTo(shapes[i].x, shapes[i].y);
                    ctx.lineTo(shapes[j].x, shapes[j].y);
                    ctx.stroke();
                    ctx.closePath();
                }
            }
        }

        requestAnimationFrame(draw);
    }

    draw();
}

function loveWallpaper() {
    const desktop = document.querySelector('.desktop');
    desktop.style.background = 'none';

    const wallpaperLayer = document.createElement('div');
    wallpaperLayer.style.position = 'fixed';
    wallpaperLayer.style.top = '0';
    wallpaperLayer.style.left = '0';
    wallpaperLayer.style.width = '100%';
    wallpaperLayer.style.height = '100%';
    wallpaperLayer.style.pointerEvents = 'none';
    wallpaperLayer.style.zIndex = '-1';

    document.body.appendChild(wallpaperLayer);
    
    const canvas = document.createElement('canvas');
    canvas.id = 'liveWallpaperCanvas';
    wallpaperLayer.appendChild(canvas);

    const ctx = canvas.getContext('2d');

    function resizeCanvas() {
        canvas.width = window.innerWidth;
        canvas.height = window.innerHeight;
    }

    window.addEventListener('resize', resizeCanvas);
    resizeCanvas();

    const numHearts = 100;
    const hearts = [];

    for (let i = 0; i < numHearts; i++) {
        hearts.push({
            x: Math.random() * canvas.width,
            y: Math.random() * canvas.height + canvas.height,
            size: Math.random() * 25 + 15,
            speedY: Math.random() * 1 + 0.5,
            color: `rgba(255, 105, 180, 0.8)`
        });
    }

    function drawHeart(ctx, x, y, size) {
        ctx.beginPath();
        ctx.moveTo(x, y);
        ctx.bezierCurveTo(x, y - size * 0.4, x - size * 0.4, y, x, y + size * 0.5);
        ctx.bezierCurveTo(x + size * 0.4, y, x, y - size * 0.4, x, y);
        ctx.fillStyle = 'rgba(255, 105, 180, 0.8)';
        ctx.fill();
        ctx.closePath();
    }

    function draw() {
        ctx.fillStyle = 'rgba(30, 30, 30, 0.95)';
        ctx.fillRect(0, 0, canvas.width, canvas.height);

        hearts.forEach(heart => {
            drawHeart(ctx, heart.x, heart.y, heart.size);

            heart.y -= heart.speedY;
            if (heart.y < -20) {
                heart.y = canvas.height + 20;
                heart.x = Math.random() * canvas.width;
            }
        });

        requestAnimationFrame(draw);
    }

    draw();
}

function loveWallpaper() {
    const desktop = document.querySelector('.desktop');
    desktop.style.background = 'none';

    const wallpaperLayer = document.createElement('div');
    wallpaperLayer.style.position = 'fixed';
    wallpaperLayer.style.top = '0';
    wallpaperLayer.style.left = '0';
    wallpaperLayer.style.width = '100%';
    wallpaperLayer.style.height = '100%';
    wallpaperLayer.style.pointerEvents = 'none';
    wallpaperLayer.style.zIndex = '-1';

    document.body.appendChild(wallpaperLayer);
    
    const canvas = document.createElement('canvas');
    canvas.id = 'liveWallpaperCanvas';
    wallpaperLayer.appendChild(canvas);

    const ctx = canvas.getContext('2d');

    function resizeCanvas() {
        canvas.width = window.innerWidth;
        canvas.height = window.innerHeight;
    }

    window.addEventListener('resize', resizeCanvas);
    resizeCanvas();

    const numHearts = 100;
    const hearts = [];

    for (let i = 0; i < numHearts; i++) {
        hearts.push({
            x: Math.random() * canvas.width,
            y: Math.random() * canvas.height + canvas.height,
            size: Math.random() * 25 + 15,
            speedY: Math.random() * 1 + 0.5,
            color: `rgba(255, 105, 180, 0.8)`
        });
    }

    function drawHeart(ctx, x, y, size) {
        ctx.beginPath();
        ctx.moveTo(x, y);
        ctx.bezierCurveTo(x, y - size * 0.4, x - size * 0.4, y, x, y + size * 0.5);
        ctx.bezierCurveTo(x + size * 0.4, y, x, y - size * 0.4, x, y);
        ctx.fillStyle = 'rgba(255, 105, 180, 0.8)';
        ctx.fill();
        ctx.closePath();
    }

    function draw() {
        ctx.fillStyle = 'rgba(30, 30, 30, 0.95)';
        ctx.fillRect(0, 0, canvas.width, canvas.height);

        hearts.forEach(heart => {
            drawHeart(ctx, heart.x, heart.y, heart.size);

            heart.y -= heart.speedY;
            if (heart.y < -20) {
                heart.y = canvas.height + 20;
                heart.x = Math.random() * canvas.width;
            }
        });

        requestAnimationFrame(draw);
    }

    draw();
}

function starryNightWallpaper() {
    const desktop = document.querySelector('.desktop');
    desktop.style.background = 'none';

    const wallpaperLayer = document.createElement('div');
    wallpaperLayer.style.position = 'fixed';
    wallpaperLayer.style.top = '0';
    wallpaperLayer.style.left = '0';
    wallpaperLayer.style.width = '100%';
    wallpaperLayer.style.height = '100%';
    wallpaperLayer.style.pointerEvents = 'none';
    wallpaperLayer.style.zIndex = '-1';

    document.body.appendChild(wallpaperLayer);
    
    const canvas = document.createElement('canvas');
    canvas.id = 'liveWallpaperCanvas';
    wallpaperLayer.appendChild(canvas);

    const ctx = canvas.getContext('2d');

    function resizeCanvas() {
        canvas.width = window.innerWidth;
        canvas.height = window.innerHeight;
    }

    window.addEventListener('resize', resizeCanvas);
    resizeCanvas();

    const stars = [];
    const numStars = 200;

    for (let i = 0; i < numStars; i++) {
        stars.push({
            x: Math.random() * canvas.width,
            y: Math.random() * canvas.height,
            radius: Math.random() * 2 + 1,
            alpha: Math.random(),
            speed: Math.random() * 0.5 + 0.1
        });
    }

    function draw() {
        ctx.fillStyle = 'rgba(0, 0, 0, 0.1)';
        ctx.fillRect(0, 0, canvas.width, canvas.height);

        stars.forEach(star => {
            ctx.beginPath();
            ctx.arc(star.x, star.y, star.radius, 0, Math.PI * 2);
            ctx.fillStyle = `rgba(255, 255, 255, ${star.alpha})`;
            ctx.fill();
            ctx.closePath();

            star.y += star.speed;
            if (star.y > canvas.height) {
                star.y = 0;
                star.x = Math.random() * canvas.width;
            }

            star.alpha = Math.abs(Math.sin(Date.now() * 0.001 + star.x * 0.01));
        });

        requestAnimationFrame(draw);
    }

    draw();
}

function wallpaperMatrix() {
    const desktop = document.querySelector('.desktop');
    desktop.style.background = 'none';

    const wallpaperLayer = document.createElement('div');
    wallpaperLayer.style.position = 'fixed';
    wallpaperLayer.style.top = '0';
    wallpaperLayer.style.left = '0';
    wallpaperLayer.style.width = '100%';
    wallpaperLayer.style.height = '100%';
    wallpaperLayer.style.pointerEvents = 'none';
    wallpaperLayer.style.zIndex = '-1';

    document.body.appendChild(wallpaperLayer);
    
    const canvas = document.createElement('canvas');
    canvas.id = 'liveWallpaperCanvas';
    wallpaperLayer.appendChild(canvas);

    const ctx = canvas.getContext('2d');

    function resizeCanvas() {
        canvas.width = window.innerWidth;
        canvas.height = window.innerHeight;
        ctx.fillStyle = 'black';
        ctx.fillRect(0, 0, canvas.width, canvas.height);
    }

    window.addEventListener('resize', resizeCanvas);
    resizeCanvas();

    const characters = 'ABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789';
    const fontSize = 16;
    const columns = Math.floor(canvas.width / fontSize);
    const drops = Array(columns).fill(1);

    function draw() {
        ctx.fillStyle = 'rgba(0, 0, 0, 0.05)';
        ctx.fillRect(0, 0, canvas.width, canvas.height);

        ctx.fillStyle = '#0F0';
        ctx.font = fontSize + 'px monospace';

        for (let x = 0; x < drops.length; x++) {
            const text = characters.charAt(Math.floor(Math.random() * characters.length));
            ctx.fillText(text, x * fontSize, drops[x] * fontSize);
            drops[x]++;
            if (drops[x] * fontSize > canvas.height && Math.random() > 0.975) {
                drops[x] = 0;
            }
        }
        requestAnimationFrame(draw);
    }

    draw();
}

function rainWallpaper() {
    const desktop = document.querySelector('.desktop');
    desktop.style.background = 'none';

    const wallpaperLayer = document.createElement('div');
    wallpaperLayer.style.position = 'fixed';
    wallpaperLayer.style.top = '0';
    wallpaperLayer.style.left = '0';
    wallpaperLayer.style.width = '100%';
    wallpaperLayer.style.height = '100%';
    wallpaperLayer.style.pointerEvents = 'none';
    wallpaperLayer.style.zIndex = '-1';

    document.body.appendChild(wallpaperLayer);
    
    const canvas = document.createElement('canvas');
    canvas.id = 'liveWallpaperCanvas';
    wallpaperLayer.appendChild(canvas);

    const ctx = canvas.getContext('2d');

    function resizeCanvas() {
        canvas.width = window.innerWidth;
        canvas.height = window.innerHeight;
    }

    window.addEventListener('resize', resizeCanvas);
    resizeCanvas();

    const drops = [];
    const numDrops = 200;

    for (let i = 0; i < numDrops; i++) {
        drops.push({
            x: Math.random() * canvas.width,
            y: Math.random() * canvas.height,
            length: Math.random() * 20 + 10,
            opacity: Math.random() * 0.5 + 0.5
        });
    }

    function draw() {
        ctx.fillStyle = 'rgba(0, 0, 0, 0.05)';
        ctx.fillRect(0, 0, canvas.width, canvas.height);

        ctx.fillStyle = 'rgba(174, 194, 224, 0.8)';

        drops.forEach(drop => {
            ctx.beginPath();
            ctx.moveTo(drop.x, drop.y);
            ctx.lineTo(drop.x, drop.y + drop.length);
            ctx.lineWidth = 2;
            ctx.strokeStyle = `rgba(174, 194, 224, ${drop.opacity})`;
            ctx.stroke();
            ctx.closePath();

            drop.y += 5;
            if (drop.y > canvas.height) {
                drop.y = 0;
                drop.x = Math.random() * canvas.width;
            }
        });

        requestAnimationFrame(draw);
    }

    draw();
}

function gamingWallpaper() {
    const desktop = document.querySelector('.desktop');
    desktop.style.background = 'none';

    const wallpaperLayer = document.createElement('div');
    wallpaperLayer.style.position = 'fixed';
    wallpaperLayer.style.top = '0';
    wallpaperLayer.style.left = '0';
    wallpaperLayer.style.width = '100%';
    wallpaperLayer.style.height = '100%';
    wallpaperLayer.style.pointerEvents = 'none';
    wallpaperLayer.style.zIndex = '-1';

    document.body.appendChild(wallpaperLayer);
    
    const canvas = document.createElement('canvas');
    canvas.id = 'liveWallpaperCanvas';
    wallpaperLayer.appendChild(canvas);

    const ctx = canvas.getContext('2d');

    function resizeCanvas() {
        canvas.width = window.innerWidth;
        canvas.height = window.innerHeight;
    }

    window.addEventListener('resize', resizeCanvas);
    resizeCanvas();

    const numPixels = 100;
    const pixels = [];

    for (let i = 0; i < numPixels; i++) {
        pixels.push({
            x: Math.random() * canvas.width,
            y: Math.random() * canvas.height,
            size: Math.random() * 10 + 5,
            speedX: Math.random() * 2 - 1,
            speedY: Math.random() * 2 - 1,
            color: `hsl(${Math.random() * 360}, 100%, 50%)`
        });
    }

    function draw() {
        ctx.fillStyle = 'rgba(0, 0, 0, 0.1)';
        ctx.fillRect(0, 0, canvas.width, canvas.height);

        pixels.forEach(pixel => {
            ctx.fillStyle = pixel.color;
            ctx.fillRect(pixel.x, pixel.y, pixel.size, pixel.size);

            pixel.x += pixel.speedX;
            pixel.y += pixel.speedY;

            if (pixel.x < 0 || pixel.x > canvas.width) {
                pixel.speedX *= -1;
            }
            if (pixel.y < 0 || pixel.y > canvas.height) {
                pixel.speedY *= -1;
            }
        });

        requestAnimationFrame(draw);
    }

    draw();
}

function animation_default() {
  const style = document.createElement('style');
  document.head.appendChild(style);

  style.sheet.insertRule(`
	@keyframes animate-in {
	  0% {
		transform: scale(0.5);
		opacity: 0;
	  }
	  100% {
		transform: scale(1);
		opacity: 1;
	  }
	}
  `);

  style.sheet.insertRule(`
	@keyframes animate-out {
	  0% {
		transform: scale(1);
		opacity: 1;
	  }
	  100% {
		transform: scale(0.5);
		opacity: 0;
	  }
	}
  `);
}

function set_animation_default() {
	localStorage.setItem('FMOSsettingAnimationIframe', '1')
	animation_default();
}

function animation_Bounce_and_Rotate_Slide() {
  const style = document.createElement('style');
  document.head.appendChild(style);

  style.sheet.insertRule(`
    @keyframes animate-in {
      0% {
        transform: scale(0.3) rotate(5deg);
        opacity: 0;
        box-shadow: 0 0 10px rgba(0, 0, 0, 0.2);
      }
      50% {
        transform: scale(1.05) rotate(-3deg);
        opacity: 0.7;
        box-shadow: 0 0 15px rgba(0, 0, 0, 0.3);
      }
      100% {
        transform: scale(1) rotate(0deg);
        opacity: 1;
        box-shadow: 0 0 20px rgba(0, 0, 0, 0.4);
      }
    }
  `);

  style.sheet.insertRule(`
    @keyframes animate-out {
      0% {
        transform: scale(1) rotate(0deg);
        opacity: 1;
        box-shadow: 0 0 20px rgba(0, 0, 0, 0.4);
      }
      50% {
        transform: scale(1.05) rotate(3deg);
        opacity: 0.7;
        box-shadow: 0 0 15px rgba(0, 0, 0, 0.3);
      }
      100% {
        transform: scale(0.3) rotate(-5deg);
        opacity: 0;
        box-shadow: 0 0 10px rgba(0, 0, 0, 0.2);
      }
    }
  `);
}

function set_animation_Bounce_and_Rotate_Slide() {
	localStorage.setItem('FMOSsettingAnimationIframe', '2')
	animation_Bounce_and_Rotate_Slide();
}

function animation_Pop_and_Slide() {
  const style = document.createElement('style');
  document.head.appendChild(style);

  style.sheet.insertRule(`
	@keyframes animate-in {
	  0% {
		transform: scale(0.8) translateY(-50px);
		opacity: 0;
		box-shadow: 0 0 15px rgba(0, 0, 0, 0.2);
		border-radius: 10px;
	  }
	  50% {
		transform: scale(1.05) translateY(10px);
		opacity: 0.6;
		box-shadow: 0 0 25px rgba(0, 0, 0, 0.3);
		border-radius: 15px;
	  }
	  100% {
		transform: scale(1) translateY(0);
		opacity: 1;
		box-shadow: 0 10px 30px rgba(0, 0, 0, 0.2);
		border-radius: 20px;
	  }
	}
  `);

  style.sheet.insertRule(`
	@keyframes animate-out {
	  0% {
		transform: scale(1) translateY(0);
		opacity: 1;
		box-shadow: 0 10px 30px rgba(0, 0, 0, 0.2);
		border-radius: 20px;
	  }
	  50% {
		transform: scale(1.05) translateY(10px);
		opacity: 0.6;
		box-shadow: 0 0 25px rgba(0, 0, 0, 0.3);
		border-radius: 15px;
	  }
	  100% {
		transform: scale(0.8) translateY(-50px);
		opacity: 0;
		box-shadow: 0 0 15px rgba(0, 0, 0, 0.2);
		border-radius: 10px;
	  }
	}
  `);
}

function set_animation_Pop_and_Slide() {
	localStorage.setItem('FMOSsettingAnimationIframe', '3')
	animation_Pop_and_Slide();
}

function animation_Smooth_Blur_Transition() {
  const style = document.createElement('style');
  document.head.appendChild(style);

  style.sheet.insertRule(`
	@keyframes animate-in {
	  0% {
		transform: scale(0.6) translateY(-20px);
		opacity: 0;
		filter: blur(5px);
	  }
	  70% {
		transform: scale(1.05) translateY(5px);
		opacity: 0.8;
		filter: blur(2px);
	  }
	  100% {
		transform: scale(1) translateY(0);
		opacity: 1;
		filter: blur(0);
	  }
	}
  `);

  style.sheet.insertRule(`
	@keyframes animate-out {
	  0% {
		transform: scale(1) translateY(0);
		opacity: 1;
		filter: blur(0);
	  }
	  70% {
		transform: scale(1.05) translateY(-5px);
		opacity: 0.8;
		filter: blur(2px);
	  }
	  100% {
		transform: scale(0.6) translateY(20px);
		opacity: 0;
		filter: blur(5px);
	  }
	}
  `);
}

function set_animation_Smooth_Blur_Transition() {
	localStorage.setItem('FMOSsettingAnimationIframe', '4')
	animation_Smooth_Blur_Transition();
}

function animation_Elegant_Fade_and_Slide_Animation() {
  const style = document.createElement('style');
  document.head.appendChild(style);

  style.sheet.insertRule(`
	@keyframes animate-in {
	  0% {
		transform: translateX(-100%) scale(0.8);
		opacity: 0;
	  }
	  100% {
		transform: translateX(0) scale(1);
		opacity: 1;
	  }
	}
  `);

  style.sheet.insertRule(`
	@keyframes animate-out {
	  0% {
		transform: translateX(0) scale(1);
		opacity: 1;
	  }
	  100% {
		transform: translateX(100%) scale(0.8);
		opacity: 0;
	  }
	}
  `);
}

function set_animation_Elegant_Fade_and_Slide_Animation() {
	localStorage.setItem('FMOSsettingAnimationIframe', '5')
	animation_Elegant_Fade_and_Slide_Animation();
}

function animation_Dynamic_Bouncy_Entrance() {
  const style = document.createElement('style');
  document.head.appendChild(style);

  style.sheet.insertRule(`
	@keyframes animate-in {
	  0% {
		transform: scale(0.5) translateY(-50px);
		opacity: 0;
	  }
	  40% {
		transform: scale(1.1) translateY(10px);
		opacity: 1;
	  }
	  70% {
		transform: scale(0.9) translateY(-5px);
		opacity: 1;
	  }
	  100% {
		transform: scale(1) translateY(0);
		opacity: 1;
	  }
	}
  `);

  style.sheet.insertRule(`
	@keyframes animate-out {
	  0% {
		transform: scale(1) translateY(0);
		opacity: 1;
	  }
	  40% {
		transform: scale(0.9) translateY(5px);
		opacity: 1;
	  }
	  100% {
		transform: scale(0.5) translateY(50px);
		opacity: 0;
	  }
	}
  `);
}

function set_animation_Dynamic_Bouncy_Entrance() {
	localStorage.setItem('FMOSsettingAnimationIframe', '6')
	animation_Dynamic_Bouncy_Entrance();
}

function animation_Scale_and_Blur() {
  const style = document.createElement('style');
  document.head.appendChild(style);

  style.sheet.insertRule(`
	@keyframes animate-in {
	  0% {
		transform: translateX(-100%) scale(0.8);
		opacity: 0;
		filter: blur(8px);
	  }
	  100% {
		transform: translateX(0) scale(1);
		opacity: 1;
		filter: blur(0);
	  }
	}
  `);

  style.sheet.insertRule(`
	@keyframes animate-out {
	  0% {
		transform: translateX(0) scale(1);
		opacity: 1;
		filter: blur(0);
	  }
	  100% {
		transform: translateX(100%) scale(0.8);
		opacity: 0;
		filter: blur(8px);
	  }
	}
  `);
}

function set_animation_Scale_and_Blur() {
	localStorage.setItem('FMOSsettingAnimationIframe', '7')
	animation_Scale_and_Blur();
}

function animation_Elastic_Pop_Animation() {
  const style = document.createElement('style');
  document.head.appendChild(style);

  style.sheet.insertRule(`
	@keyframes animate-in {
	  0% {
		transform: scale(0.4) translateY(-30px);
		opacity: 0;
	  }
	  60% {
		transform: scale(1.1) translateY(10px);
		opacity: 1;
	  }
	  100% {
		transform: scale(1) translateY(0);
		opacity: 1;
	  }
	}
  `);

  style.sheet.insertRule(`
	@keyframes animate-out {
	  0% {
		transform: scale(1) translateY(0);
		opacity: 1;
	  }
	  40% {
		transform: scale(1.1) translateY(-10px);
		opacity: 0.8;
	  }
	  100% {
		transform: scale(0.4) translateY(30px);
		opacity: 0;
	  }
	}
  `);
}

function set_animation_Elastic_Pop_Animation() {
	localStorage.setItem('FMOSsettingAnimationIframe', '8')
	animation_Elastic_Pop_Animation();
}

function checkIframeAnimation() {
	valuetheme = localStorage.getItem('FMOSsettingAnimationIframe');
    if (valuetheme === '1') {
		// do nothing
    } else if (valuetheme === '2') {
        animation_Bounce_and_Rotate_Slide();
    } else if (valuetheme === '3') {
        animation_Pop_and_Slide();
	} else if (valuetheme === '4') {
		animation_Smooth_Blur_Transition();
	} else if (valuetheme === '5') {
		animation_Elegant_Fade_and_Slide_Animation();
	} else if (valuetheme === '6') {
		animation_Dynamic_Bouncy_Entrance();
	} else if (valuetheme === '7') {
		animation_Scale_and_Blur();
	} else if (valuetheme === '8') {
		animation_Elastic_Pop_Animation();
    } else {
        showError('Animation error ERROR')
		localStorage.setItem('FMOSsettingAnimationIframe', '1')
    }
}

//-------save-themes-and-wallpapers--------------------------------------------------------------------------------------

function wallpaper_Matrix() {
	localStorage.setItem('FMOSwallpaperlive', 'Matrix');
	wallpaperMatrix();
}

function wallpaper_off() {
	localStorage.setItem('FMOSwallpaperlive', 'false');
}

function wallpaper_Cyberpunk() {
	localStorage.setItem('FMOSwallpaperlive', 'Cyberpunk');
	futuristicCyberpunkWallpaper();
}

function wallpaper_gaming() {
	localStorage.setItem('FMOSwallpaperlive', 'gaming');
	pulsatingNeonWallpaper();
}

function wallpaper_love() {
	localStorage.setItem('FMOSwallpaperlive', 'love');
	loveWallpaper();
}

function wallpaper_starryNight() {
	localStorage.setItem('FMOSwallpaperlive', 'starryNight');
	starryNightWallpaper();
}

function wallpaper_rain() {
	localStorage.setItem('FMOSwallpaperlive', 'Matrix');
	rainWallpaper();
}

let confirmofwallpapertheme = null;

function theme_gaming() {
	applyGamingTheme();
	localStorage.setItem('FMOStheme', 'gaming');
	confirmofwallpapertheme = confirm("Do u want to apply the wallpaper to the theme too?");
	if (confirmofwallpapertheme) {
        wallpaper_gaming();
    } else {
        showError('Wallpaper Was Not Applyed')
    }
}

function theme_love() {
	applyLoveTheme();
	localStorage.setItem('FMOStheme', 'love');
	confirmofwallpapertheme = confirm("Do u want to apply the wallpaper to the theme too?");
	if (confirmofwallpapertheme) {
        wallpaper_love();
    } else {
        showError('Wallpaper Was Not Applyed')
    }
}

function theme_night() {
	applyNightTheme();
	localStorage.setItem('FMOStheme', 'night');
	confirmofwallpapertheme = confirm("Do u want to apply the wallpaper to the theme too?");
	if (confirmofwallpapertheme) {
        wallpaper_starryNight();
    } else {
        showError('Wallpaper Was Not Applyed')
    }
}

function theme_cyberpunk() {
	applyCyberpunkTheme();
	localStorage.setItem('FMOStheme', 'cyberpunk');
	confirmofwallpapertheme = confirm("Do u want to apply the wallpaper to the theme too?");
	if (confirmofwallpapertheme) {
        wallpaper_Cyberpunk();
    } else {
        showError('Wallpaper Was Not Applyed')
    }
}

function theme_default() {
	localStorage.setItem('FMOStheme', 'false');
	askToRestartOS();
}

//-------boot-----------------------------------------------------------------------------------------

let valuewallpaperlive = null;
let valuetheme = null;

function checkFMOSwallpaperlive() {
	valuewallpaperlive = localStorage.getItem('FMOSwallpaperlive');
    if (valuewallpaperlive === 'false') {
		// do nothing
    } else if (valuewallpaperlive === 'gaming') {
        pulsatingNeonWallpaper();
    } else if (valuewallpaperlive === 'Cyberpunk') {
        futuristicCyberpunkWallpaper();
	} else if (valuewallpaperlive === 'love') {
		loveWallpaper();
	} else if (valuewallpaperlive === 'Matrix') {
		wallpaperMatrix();
	} else if (valuewallpaperlive === 'starryNight') {
		starryNightWallpaper();
	} else if (valuewallpaperlive === 'rain') {
		rainWallpaper();
    } else {
        showError('Wallpaper ERROR')
    }
}

function checkTheme() {
	valuetheme = localStorage.getItem('FMOStheme');
    if (valuetheme === 'false') {
		// do nothing
    } else if (valuetheme === 'gaming') {
        applyGamingTheme();
    } else if (valuetheme === 'love') {
        applyLoveTheme();
	} else if (valuetheme === 'retro') {
		applyRetroTheme();
	} else if (valuetheme === 'cyberpunk') {
		applyCyberpunkTheme();
	} else if (valuetheme === 'night') {
		applyNightTheme();
    } else {
        showError('Theme ERROR')
    }
}

//------------------------------------------------------------------------------------------------------//
//------------------------------------------------------------------------------------------------------//
//                                     ---Process-MGR---                                                //
//------------------------------------------------------------------------------------------------------//
//------------------------------------------------------------------------------------------------------//

let updateInterval = null;

function toggleProcessManager() {
    const processManager = document.getElementById('fmosProcessManager');
    if (processManager.style.display === 'none') {
        processManager.style.display = 'block';
        updateProcessManager();
        startUpdateInterval();
    } else {
        processManager.style.display = 'none';
        stopUpdateInterval();
    }
}

function startUpdateInterval() {
    if (!updateInterval) {
        updateInterval = setInterval(updateProcessManager, 2000);
    }
}

function stopUpdateInterval() {
    if (updateInterval) {
        clearInterval(updateInterval);
        updateInterval = null;
    }
}

function updateProcessManager() {
    const processList = document.getElementById('processList');
    const headers = document.querySelector('.process-row.header');
    processList.innerHTML = '';
    processList.appendChild(headers);

    if (openedWindows.length === 0) {
        processList.innerHTML += '<div class="process-row">No apps are running</div>';
        return;
    }

    openedWindows.forEach(window => {
        const row = document.createElement('div');
        row.className = 'process-row';

        const idCell = document.createElement('div');
        idCell.textContent = window.id;
        row.appendChild(idCell);

        const nameCell = document.createElement('div');
        nameCell.textContent = window.type;
        row.appendChild(nameCell);

        const urlCell = document.createElement('div');
        const iframe = document.getElementById(window.id)?.querySelector('#iframe');
        urlCell.textContent = iframe ? iframe.src : 'URL not found';
        row.appendChild(urlCell);

        const actionCell = document.createElement('div');
        const endProcessButton = document.createElement('button');
        endProcessButton.className = 'process-mgr-close-button';
        endProcessButton.textContent = 'End Process';
        endProcessButton.onclick = () => closeiframe(window.id);
        actionCell.appendChild(endProcessButton);
        row.appendChild(actionCell);

        processList.appendChild(row);
    });
}

document.addEventListener('DOMContentLoaded', () => {
    const processManager = document.getElementById('fmosProcessManager');
    const headerElement = document.getElementById('processManagerHeader');
    if (headerElement) {
        processmgrMakeDraggable(headerElement);
    }
});

// Renamed makeDraggable to processmgrMakeDraggable
function processmgrMakeDraggable(element) {
    let offsetX, offsetY;

    element.addEventListener('mousedown', (e) => {
        offsetX = e.clientX - element.parentElement.getBoundingClientRect().left;
        offsetY = e.clientY - element.parentElement.getBoundingClientRect().top;

        function mouseMoveHandler(e) {
            element.parentElement.style.left = `${e.clientX - offsetX}px`;
            element.parentElement.style.top = `${e.clientY - offsetY}px`;
        }

        document.addEventListener('mousemove', mouseMoveHandler);

        document.addEventListener('mouseup', () => {
            document.removeEventListener('mousemove', mouseMoveHandler);
        }, { once: true });
    });
}

//------------------------------------------------------------------------------------------------------//
//------------------------------------------------------------------------------------------------------//
//                                     ---Folder MGR---                                                 //
//------------------------------------------------------------------------------------------------------//
//------------------------------------------------------------------------------------------------------//

let foldermgrfilespath;
let foldermgrfolderfrompathcontent;
let PathToreloadFolderMGR;

function showFolderMGR() {
    document.getElementById('folderMGR').style.display = 'block';
	document.getElementById('pathInput').value = '';
    loadFiles();
}

function folderMGRCreateFile() {
	if (filesystem.hasOwnProperty(foldermgrfilespath)) {
		let foldermgrfilename = prompt('Filename:');
		if (foldermgrfilename &&!foldermgrfiles[foldermgrfilename]&&!foldermgrfilename.endsWith('.folder')) {
			foldermgrfiles[foldermgrfilename] = "";
			filesetData(foldermgrfilespath, JSON.stringify(foldermgrfiles));
			connectdesktops('1');
			loadFiles(PathToreloadFolderMGR);
		} else {
			showError('ERROR (if u created a file with the extention .folder please use the create folder butten)')
		}
	} else {
		showError('Sorry, this path does not exist. Tipp: Sometimes you have to input the path again and click enter. or the path realy does not exist');
	}
}

function folderMGRCreateFolder() {
	if (filesystem.hasOwnProperty(foldermgrfilespath)) {
		let foldermgrfoldername = prompt('Foldername (without extention): ');
		let foldermgrfoldernamefile = foldermgrfoldername + '.folder'
		if (foldermgrfoldernamefile &&!foldermgrfiles[foldermgrfoldernamefile]) {
			let newfolderkey = foldermgrfilespath + (PathToreloadFolderMGR === '/' ? '' : '/') + foldermgrfoldername;
			filesetData(newfolderkey, JSON.stringify(''));
			foldermgrfiles[foldermgrfoldernamefile] = "";
			filesetData(foldermgrfilespath, JSON.stringify(foldermgrfiles));
			connectdesktops('1');
			loadFiles(PathToreloadFolderMGR);
		} else {
			showError('ERROR')
		}
	} else {
		showError('Sorry, this path does not exist. Tipp: Sometimes you have to input the path again and click enter. or the path realy does not exist');
	}
}

function folderMGRRenameFolder() {
	if (filesystem.hasOwnProperty(foldermgrfilespath)) {
		let foldernameold = prompt('Name Of Folder you Want to Rename (without extention) :');
		let oldfolder = foldernameold + '.folder';
		if (foldermgrfiles.hasOwnProperty(oldfolder)) {
			let message = 'New Name of' + oldfolder + ' (without extention) :';
			let foldername = prompt(message, oldfolder);
			let newfolder = foldername + '.folder';
			if (foldername &&!foldermgrfiles.hasOwnProperty(newfolder)) {
				foldermgrfiles[newfolder] = foldermgrfiles[oldfolder];
				delete foldermgrfiles[oldfolder];
				filesetData(foldermgrfilespath, JSON.stringify(foldermgrfiles));
				let newfolderkey = foldermgrfilespath + (PathToreloadFolderMGR === '/' ? '' : '/') + foldername;
				let oldfolderkey = foldermgrfilespath + (PathToreloadFolderMGR === '/' ? '' : '/') + foldernameold;
				let oldfoldercontentjson = filesystem[oldfolderkey];
				let oldfoldercontent = JSON.parse(oldfoldercontentjson) || {};
				filesetData(newfolderkey, JSON.stringify(oldfoldercontent));
				filedeleteData(oldfolderkey);
				connectdesktops('1');
				loadFiles(PathToreloadFolderMGR);
			} else {
				showError('No Name Given Or There is an already ecsisting folder');
			}
		} else {
			showError('This Folder Does Not exist');
		}
	} else {
		showError('Sorry, this path does not exist. Tipp: Sometimes you have to input the path again and click enter. or the path realy does not exist');
	}
}

function folderMGRDeleteFolder() {
	if (filesystem.hasOwnProperty(foldermgrfilespath)) {
		let foldername = prompt('Name Of folder you Want to Delete (without extention) :');
		let folder = foldername + '.folder';
		if (foldername &&foldermgrfiles.hasOwnProperty(folder)) {
			if (confirm('Are you sure you want to delete this Folder?')) {
				if (confirm('This will delete the entire Folder: ' + folder)) {
					delete foldermgrfiles[folder];
					filesetData(foldermgrfilespath, JSON.stringify(foldermgrfiles));
					let folderkeyname = foldermgrfilespath + (PathToreloadFolderMGR === '/' ? '' : '/') + foldername;
					folderdeleteData(folderkeyname);
					connectdesktops('1');
					loadFiles(PathToreloadFolderMGR);
				}
			}
		} else {
			showError('This folder Does Not exist');
		}
	} else {
		showError('Sorry, this path does not exist. Tipp: Sometimes you have to input the path again and click enter. or the path realy does not exist');
	}
}

function folderMGRRenameFile() {
	if (filesystem.hasOwnProperty(foldermgrfilespath)) {
		let oldfile = prompt('Name Of File you Want to Rename:')
		if (foldermgrfiles.hasOwnProperty(oldfile)&&!oldfile.endsWith('.folder')) {
			let message = 'New Name of' + oldfile + ':'
			let newfile = prompt(message, oldfile)
			if (newfile &&!foldermgrfiles[newfile]&&!newfile.endsWith('.folder')) {
				foldermgrfiles[newfile] = foldermgrfiles[oldfile]
				delete foldermgrfiles[oldfile]
				filesetData(foldermgrfilespath, JSON.stringify(foldermgrfiles));
				connectdesktops('1');
				loadFiles(PathToreloadFolderMGR);
			} else {
				showError('ERROR the file already exists or u tried to make it a folder')
			}
		} else {
			showError('This File Does Not exist or u tried to rename a folder')
		}
	} else {
		showError('Sorry, this path does not exist. Tipp: Sometimes you have to input the path again and click enter. or the path realy does not exist');
	}
}

function folderMGRDeleteFile() {
	if (filesystem.hasOwnProperty(foldermgrfilespath)) {
		let file = prompt('Name Of File you Want to Delete:')
		if (file &&foldermgrfiles.hasOwnProperty(file)) {
			if (confirm('Are you sure you want to delete this file?')) {
				if (confirm('This will delete the entire file: ' + file)) {
					delete foldermgrfiles[file]
					filesetData(foldermgrfilespath, JSON.stringify(foldermgrfiles));
					connectdesktops('1');
					loadFiles(PathToreloadFolderMGR);
				}
			}
		} else {
			showError('This File Does Not exist')
		}
	} else {
		showError('Sorry, this path does not exist. Tipp: Sometimes you have to input the path again and click enter. or the path realy does not exist');
	}
}

function closeFolderMGR() {
    document.getElementById('folderMGR').style.display = 'none';
}

function loadFiles(path) {
    const iconsContainer = document.getElementById('iconsContainer');
    iconsContainer.innerHTML = '';

    PathToreloadFolderMGR = path;
    foldermgrfilespath = 'FMOSfolder' + path;
    foldermgrfolderfrompathcontent = filesystem[foldermgrfilespath];
    foldermgrfiles = JSON.parse(foldermgrfolderfrompathcontent) || {};

    for (const filename in foldermgrfiles) {
        const fileOrFolder = document.createElement('div');
        fileOrFolder.className = 'icon';
        fileOrFolder.innerText = filename;
        fileOrFolder.dataset.file = filename;

        fileOrFolder.style.backgroundSize = '100%';
        fileOrFolder.style.backgroundRepeat = 'no-repeat';
        fileOrFolder.style.backgroundPosition = 'center';
        fileOrFolder.onclick = () => openFileContent(filename);
        iconsContainer.appendChild(fileOrFolder);

        fileOrFolder.setAttribute('draggable', 'true');
        fileOrFolder.ondragstart = (event) => {
            event.dataTransfer.setData('text/plain', filename);
            event.dataTransfer.setData('application/json', foldermgrfiles[filename]);
        };
    }

    iconsContainer.ondrop = (event) => {
        event.preventDefault();
        const filename = event.dataTransfer.getData('text/plain');
        const content = event.dataTransfer.getData('application/json');

        foldermgrfiles[filename] = content;
        filesetData(foldermgrfilespath, JSON.stringify(foldermgrfiles));
    };

    iconsContainer.ondragover = (event) => {
        event.preventDefault();
    };
}

document.getElementById('desktop').ondrop = (event) => {
    event.preventDefault();
    const filename = event.dataTransfer.getData('text/plain');
    const content = event.dataTransfer.getData('application/json');
	
	if (filename.endsWith('.folder')) {
		showError('You Cant Move Folders')
		return;
	}
	
    if (files[filename]) {
        const confirmOverwrite = confirm(`the file "${filename}" already exists. do u want to overwrite it?`);
        if (!confirmOverwrite) {
            return;
        }
    }

    files[filename] = content;
    delete foldermgrfiles[filename];
    filesetData(foldermgrfilespath, JSON.stringify(foldermgrfiles));
    loadFiles(PathToreloadFolderMGR);
    renderFiles();
	connectdesktops('2');
};

document.getElementById('desktop').ondragover = (event) => {
    event.preventDefault();
};

function openFileContent(filename) {
	if (filename && filename.endsWith('.folder')) {
        const folderName = filename.slice(0, -'.folder'.length);
		openfmosfolderinfolmgr(folderName);
	} else {
		const msgofopenfilecontent = 'Content of : ' + filename + ': ' + foldermgrfiles[filename]
		showError(msgofopenfilecontent);
	}
}

document.getElementById('pathInput').addEventListener('keyup', (event) => {
    if (event.key === 'Enter') {
        const path = event.target.value.trim();
        loadFiles(path);
    }
});

// Drag functionality for folder manager
function foldermgrDragStart(e) {
    const foldermgr = document.getElementById('folderMGR');
    foldermgr.isDragging = true;
    foldermgr.startX = e.clientX - foldermgr.offsetLeft;
    foldermgr.startY = e.clientY - foldermgr.offsetTop;

    document.addEventListener('mousemove', foldermgrDrag);
    document.addEventListener('mouseup', stopDrag);
}

function foldermgrDrag(e) {
    const foldermgr = document.getElementById('folderMGR');
    if (!foldermgr.isDragging) return;
    foldermgr.style.left = `${e.clientX - foldermgr.startX}px`;
    foldermgr.style.top = `${e.clientY - foldermgr.startY}px`;
}

function stopDrag() {
    const foldermgr = document.getElementById('folderMGR');
    foldermgr.isDragging = false;
    document.removeEventListener('mousemove', foldermgrDrag);
    document.removeEventListener('mouseup', stopDrag);
}

// Funktion, um den Folder Manager draggable zu machen
function foldermgrMakeDraggable() {
    const foldermgr = document.getElementById('folderMGR');
    
    // Drag-Funktionalität für den Header
    const header = document.querySelector('.foldermgr-header');
    header.addEventListener('mousedown', foldermgrDragStart);
}

document.addEventListener('DOMContentLoaded', foldermgrMakeDraggable);

//------------------------------------------------------------------------------------------------------//
//------------------------------------------------------------------------------------------------------//
//                                     ---Boot---                                                       //
//------------------------------------------------------------------------------------------------------//
//------------------------------------------------------------------------------------------------------//
let filesystem = {};
let loadingComplete = false;
let timer;
let db;

const request = indexedDB.open("FMOSsystem", 1);

request.onupgradeneeded = function(event) {
    db = event.target.result;
    if (!db.objectStoreNames.contains("FMOSfiles")) {
        db.createObjectStore("FMOSfiles", { keyPath: "key" });
    }
};

request.onsuccess = function(event) {
    db = event.target.result;
    loadDataFromIndexedDB(db);
};

function loadDataFromIndexedDB(db) {
    const transaction = db.transaction(["FMOSfiles"], "readwrite");
    const objectStore = transaction.objectStore("FMOSfiles");
    
    const request = objectStore.getAll();

    request.onsuccess = function(event) {
        const results = event.target.result;
        results.forEach(item => {
            filesystem[item.key] = item.value;
        });
        
        console.log("Filesystem Booted");
        loadingComplete = true;
		if (filesystem.hasOwnProperty(desktoppathdirfull)) {
			files = JSON.parse(filesystem[desktoppathdirfull]);
			console.log('desktop loaded')
			renderFiles();
		} else {
			renderFiles();
		}
		if (!filesystem.hasOwnProperty('FMOSfolder/')) {
			let tempfiles = {
				"docs.folder": "sys",
				"sys.folder": "sys",
				"desktop.folder": "sys",
				"boot.folder": "sys",
				"programms.folder": "sys"
			};
			filesetData('FMOSfolder/', JSON.stringify(tempfiles));
		}

		if (!filesystem.hasOwnProperty('FMOSfolder/sys')) {
			let tempfiles = {
				"programms.folder": "sys"
			};
			filesetData('FMOSfolder/sys', JSON.stringify(tempfiles));
			CreateFile('', 'sys.folder', 'sys')
		}

		if (!filesystem.hasOwnProperty('FMOSfolder/boot')) {
			let tempfiles = {
				"info.txt": "nothing"
			};
			filesetData('FMOSfolder/boot', JSON.stringify(tempfiles));
			CreateFile('', 'boot.folder', 'sys')
		}

		if (!filesystem.hasOwnProperty('FMOSfolder/desktop')) {
			filesetData('FMOSfolder/desktop', JSON.stringify(files));
			CreateFile('', 'desktop.folder', 'sys')
		}

		if (!filesystem.hasOwnProperty('FMOSfolder/docs')) {
			let tempfiles = {
				"TOS.fsys": "app('https://fabischau1.github.io/FMOS/Bootscreen/TOS.html')"
			};
			filesetData('FMOSfolder/docs', JSON.stringify(tempfiles));
			CreateFile('', 'docs.folder', 'sys')
		}

		if (!filesystem.hasOwnProperty('FMOSfolder/sys/programms')) {
			filesetData('FMOSfolder/sys/programms', JSON.stringify(files));
			CreateFile('sys', 'programms.folder', 'sys')
		}

		if (!filesystem.hasOwnProperty('FMOSfolder/programms')) {
			let tempfiles = {
				"info.txt": "Place to store programms"
			};
			filesetData('FMOSfolder/programms', JSON.stringify(tempfiles));
			CreateFile('', 'programms.folder', 'sys')
		}
        removeIframe();
    };

    request.onerror = function(event) {
        showError("Err004: Filesystem Load Error: ", event.target.error, ' Please Restart FMOS');
    };
}
//-------boot-animation------------------------------------------------------------------------------------------

function checkAndShowFullScreenIframe() {
    const isFullScreenAllowed = localStorage.getItem('showFullScreenIframe');
    if (isFullScreenAllowed === 'true') {
        showFullScreenIframe();
    } else if (isFullScreenAllowed === 'boot2') {
        showboot2();
    } else {
        showboot3();
    }
}

function showboot3() {
    const url = 'https://fabischau1.github.io/FMOS/Bootscreen/boot13/boot1.html';
    const iframe = createIframe(url);
    document.body.appendChild(iframe);
    startIframeTimer(iframe);
}

function showboot2() {
    const url = 'https://fabischau1.github.io/FMOS/Bootscreen/boot13/boot2.html';
    const iframe = createIframe(url);
    document.body.appendChild(iframe);
    startIframeTimer(iframe);
}

function showFullScreenIframe() {
    const url = 'https://fabischau1.github.io/FMOS/Bootscreen/FMOSboot';
    const iframe = createIframe(url);
    document.body.appendChild(iframe);
    startIframeTimer(iframe);
}

function createIframe(url) {
    const iframe = document.createElement('iframe');
    iframe.src = url;
    iframe.style.position = 'fixed';
    iframe.style.top = '0';
    iframe.style.left = '0';
    iframe.style.width = '100%';
    iframe.style.height = '100%';
    iframe.style.border = 'none';
    iframe.style.zIndex = '10000';
    return iframe;
}

function startIframeTimer(iframe) {
    timer = setTimeout(() => {
        if (loadingComplete) {
            removeIframe(iframe);
        }
    }, 5000);
}

function removeIframe(iframe) {
    if (iframe) {
        document.body.removeChild(iframe);
    }
}

if (loadingComplete) {
    const iframe = document.getElementById('bootIframe');
    removeIframe(iframe);
}

checkAndShowFullScreenIframe();

function filesetData(key, value) {
    return new Promise((resolve, reject) => {
        if (typeof key !== 'string' || key.trim() === '') {
            showError(`Err005: keyerror: ${key}`);
            return reject(`Error: ${key}`);
        }

        if (typeof value === 'undefined') {
            showError("Err006: Folder value undefined.");
            return reject("Ungültiger Wert.");
        }

        if (!db) {
            showError("Err007: Cannot save files the file system did not load.");
            return reject("Datenbank nicht initialisiert.");
        }

        filesystem[key] = value;

        const transaction = db.transaction(["FMOSfiles"], "readwrite");
        const objectStore = transaction.objectStore("FMOSfiles");

        const dataToStore = { key: key, value: value };

        const putRequest = objectStore.put(dataToStore);

        putRequest.onsuccess = function() {
            resolve();
        };

        putRequest.onerror = function(event) {
            console.error("Error:", event.target.error.name);
            showError("Err008:", event.target.error.message);
            reject(event.target.error);
        };

        transaction.oncomplete = () => {
        };

        transaction.onerror = (event) => {
            showError("Err009:", event.target.error.message);
            reject(event.target.error);
        };
    });
}

function filedeleteData(key) {
    try {
        if (!db) {
            throw new Error("Database not initialized. Please initialize IndexedDB first.");
        }

        const transaction = db.transaction(["FMOSfiles"], "readwrite");
        const objectStore = transaction.objectStore("FMOSfiles");

        const deleteRequest = objectStore.delete(key);

        deleteRequest.onsuccess = function() {
            delete filesystem[key];
            showError(`'${key}' was deleted.`);
        };

        deleteRequest.onerror = function(event) {
            console.error("Error deleting data:", event.target.error);
        };

        transaction.oncomplete = function() {
            // Transaction completed successfully
        };

        transaction.onerror = function(event) {
            console.error("Delete transaction failed:", event.target.error.message);
        };
    } catch (error) {
        console.error("Error in deleteData call:", error.message);
    }
}

function filesclearAllData() {
	alert("WARNING")
	alert("THIS WILL DELETE ALL PERMANENTLY SAVED FILES")
	const userConfirmed = confirm("Do You Realy Want To Delete all Files From FMOS?");
    
    if (userConfirmed) {
		try {
			if (!db) {
				throw new Error("Database does not function.");
			}

			const transaction = db.transaction(["FMOSfiles"], "readwrite");
			const objectStore = transaction.objectStore("FMOSfiles");

			const clearRequest = objectStore.clear();

			clearRequest.onsuccess = function() {
				console.log("all data erased.");
				filesystem = {};
				showError("all data erased.");
			};

			clearRequest.onerror = function(event) {
				console.error("error:", event.target.error);
			};

			transaction.oncomplete = function() {
				console.log("all data erased.");
			};

			transaction.onerror = function(event) {
				console.error("error:", event.target.error.message);
			};
		} catch (error) {
			console.error("error:", error.message);
		}
	} else {
        console.log("Aktion abgebrochen.");
		showError('Action Canceled.');
    }
}

function folderdeleteData(prefix) {
    try {
        if (!db) {
            throw new Error("Database not initialized. Please initialize IndexedDB first.");
        }

        const transaction = db.transaction(["FMOSfiles"], "readwrite");
        const objectStore = transaction.objectStore("FMOSfiles");

        // Open a cursor to iterate over all records in the object store
        const cursorRequest = objectStore.openCursor();

        cursorRequest.onsuccess = function(event) {
            const cursor = event.target.result;

            if (cursor) {
                const key = cursor.key;

                // Check if the key starts with the given prefix
                if (key.startsWith(prefix)) {
                    // Delete the record with the current cursor's key
                    const deleteRequest = cursor.delete();

                    deleteRequest.onsuccess = function() {
                        delete filesystem[key];
                    };

                    deleteRequest.onerror = function(event) {
                        console.error("Error deleting data:", event.target.error);
                    };
                }

                // Move to the next record
                cursor.continue();
            }
        };

        cursorRequest.onerror = function(event) {
            console.error("Cursor request failed:", event.target.error);
        };

        transaction.oncomplete = function() {
            console.log("Transaction completed successfully.");
        };

        transaction.onerror = function(event) {
            console.error("Delete transaction failed:", event.target.error.message);
        };
    } catch (error) {
        console.error("Error in deleteData call:", error.message);
    }
}

function movefolder(path1, path2) {
    if (!filesystem.hasOwnProperty(path1)) {
        showError(`Error: Source folder '${path1}' does not exist.`);
        return;
    }
	if (!filesystem.hasOwnProperty(path2)) {
        showError(`Error: Source folder '${path2}' does not exist.`);
        return;
    }

    const sourceData = JSON.parse(filesystem[path1]);
    const folderName = path1.substring(path1.lastIndexOf('/') + 1);
    const newFolderPath = path2 + (path2 === 'FMOSfolder/' ? '' : '/') + folderName;
	const folderNamefile = folderName + '.folder'
	if (path2 === 'FMOSfolder/') {
		CreateFile('', folderNamefile, 'folder')
	} else {
		let newPath = path2.startsWith('FMOSfolder/') ? path2.replace('FMOSfolder/', '') : path2;
		CreateFile(newPath, folderNamefile, 'folder')
	}
	
	if (!filesystem.hasOwnProperty(newFolderPath)) {
		filesetData(newFolderPath, JSON.stringify(sourceData));
	} else {
		showError('Error: folder with that name already exists')
	}
	
	delete filesystem[path1]
	
	for (let key in filesystem) {
        if (key.startsWith(path1)) {
            // Neuen Schlüssel erstellen, indem path1 entfernt wird
            const newKey = newFolderPath + key.substring(path1.length);
			console.log(newKey)
            // Daten an den neuen Schlüssel verschieben
            filesetData(newKey, filesystem[key]);
        }
    }
	
    folderdeleteData(path1);

    console.log(`Folder '${path1}' moved to '${path2}' successfully.`);
}

function openFullscreen() {
  const elem = document.documentElement;
  if (elem.requestFullscreen) {
    elem.requestFullscreen();
  } else if (elem.mozRequestFullScreen) { // Firefox
    elem.mozRequestFullScreen();
  } else if (elem.webkitRequestFullscreen) { // Chrome, Safari and Opera
    elem.webkitRequestFullscreen();
  } else if (elem.msRequestFullscreen) { // IE/Edge
    elem.msRequestFullscreen();
  }
}

window.onload = function() {
  openFullscreen();
};

if (!localStorage.getItem('settingbootsk')) {
    localStorage.setItem('settingbootsk', 'settingbootsk');
}

if (!localStorage.getItem('settingsettingwinold')) {
    localStorage.setItem('settingsettingwinold', 'False');
}

if (!localStorage.getItem('showFullScreenIframe')) {
    localStorage.setItem('showFullScreenIframe', 'false');
}

if (!localStorage.getItem('FMOSwallpaperlive')) {
    localStorage.setItem('FMOSwallpaperlive', 'false');
}

if (!localStorage.getItem('FMOSfolder/')) {
    localStorage.setItem('FMOSfolder/', '');
}

if (!localStorage.getItem('FMOStheme')) {
    localStorage.setItem('FMOStheme', 'false');
}

if (localStorage.getItem('FMOSinfo') === 'FMOS13') {
	//do nothing
} else {
	showError('INFO: Your Responsible for any JS code u run')
	localStorage.setItem('FMOSinfo', 'FMOS13')
}

if (!localStorage.getItem('FMOSsettingAnimationIframe')) {
    localStorage.setItem('FMOSsettingAnimationIframe', '1');
}

if (!localStorage.getItem('settinglogin')) {
    localStorage.setItem('settinglogin', 'False');
}

if (!localStorage.getItem('settingadmin')) {
    localStorage.setItem('settingadmin', 'True');
}

		loadbackground();
		checkTheme();
		checkIframeAnimation();
		checkFMOSwallpaperlive();
		waitbeforeBootLogin();
		checkandshowtos();



    </script>
</body>
</html>
